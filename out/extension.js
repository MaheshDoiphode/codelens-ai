(()=>{var e={172:function(e,t,n){"use strict";var s,r=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,r)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(s=function(e){return s=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},s(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=s(e),o=0;o<n.length;o++)"default"!==n[o]&&r(t,e,n[o]);return i(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.ResourceItem=t.SessionItem=void 0;const a=o(n(1398)),c=o(n(6928)),l=n(6185);class u extends a.TreeItem{session;constructor(e,t=a.TreeItemCollapsibleState.Collapsed){super(e.name,t),this.session=e,this.id=e.id;const n=e.storage.hasLastRemovedFiles();this.contextValue=n?"sessionWithUndo":"session",this.iconPath=new a.ThemeIcon("folder-library"),this.tooltip=`Session: ${e.name}`,this.description=`(${e.storage.files.length} items)`}}t.SessionItem=u;class f extends a.TreeItem{entry;constructor(e,t){const n=a.Uri.parse(e.uriString);let s="";const r=n.path,i=n.toString().lastIndexOf("!/");if(-1!==i){const e=n.toString().substring(i+1);s=c.basename(e.startsWith("/")?e.substring(1):e)}else s=c.basename(r);s||"file"===n.scheme||(s=n.toString().substring(n.scheme.length+1),s.startsWith("//")&&(s=s.substring(2))),s||(s=e.uriString),super(s,t),this.entry=e,this.id=`${e.sessionId}::${e.uriString}`,this.resourceUri=n,e.isDirectory||(this.command={command:"vscode.open",title:"Open Resource",arguments:[n]},this.collapsibleState=a.TreeItemCollapsibleState.None),this.tooltip=`${e.isDirectory?"Directory (Git Diff applies to tracked files within)":"Resource (Git Diff applies if tracked)"}:\n${(0,l.getDisplayUri)(e.uriString,"tooltip")}`,this.description=(0,l.getDisplayUri)(e.uriString,"treeDescription"),this.contextValue=e.isDirectory?"resourceDirectory":"resourceFile",this.iconPath=e.isDirectory?a.ThemeIcon.Folder:a.ThemeIcon.File}get sessionId(){return this.entry.sessionId}get uriString(){return this.entry.uriString}get isDirectory(){return this.entry.isDirectory}}t.ResourceItem=f},1144:e=>{e.exports={stringify:function(e,{EOL:t="\n",finalEOL:n=!0,replacer:s=null,spaces:r}={}){const i=n?t:"";return JSON.stringify(e,s,r).replace(/\n/g,t)+i},stripBom:function(e){return Buffer.isBuffer(e)&&(e=e.toString("utf8")),e.replace(/^\uFEFF/,"")}}},1236:(e,t)=>{"use strict";t.fromCallback=function(e){return Object.defineProperty((function(...t){if("function"!=typeof t[t.length-1])return new Promise(((n,s)=>{t.push(((e,t)=>null!=e?s(e):n(t))),e.apply(this,t)}));e.apply(this,t)}),"name",{value:e.name})},t.fromPromise=function(e){return Object.defineProperty((function(...t){const n=t[t.length-1];if("function"!=typeof n)return e.apply(this,t);t.pop(),e.apply(this,t).then((e=>n(null,e)),n)}),"name",{value:e.name})}},1283:e=>{"use strict";e.exports=function(e){if(null===e||"object"!=typeof e)return e;if(e instanceof Object)var n={__proto__:t(e)};else n=Object.create(null);return Object.getOwnPropertyNames(e).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))})),n};var t=Object.getPrototypeOf||function(e){return e.__proto__}},1398:e=>{"use strict";e.exports=require("vscode")},1522:(e,t,n)=>{"use strict";const s=n(1236).fromPromise,r=n(6928),i=n(8737),o=n(3798),{pathExists:a}=n(9288),{areIdentical:c}=n(6462);e.exports={createLink:s((async function(e,t){let n,s;try{n=await i.lstat(t)}catch{}try{s=await i.lstat(e)}catch(e){throw e.message=e.message.replace("lstat","ensureLink"),e}if(n&&c(s,n))return;const l=r.dirname(t);await a(l)||await o.mkdirs(l),await i.link(e,t)})),createLinkSync:function(e,t){let n;try{n=i.lstatSync(t)}catch{}try{const t=i.lstatSync(e);if(n&&c(t,n))return}catch(e){throw e.message=e.message.replace("lstat","ensureLink"),e}const s=r.dirname(t);return i.existsSync(s)||o.mkdirsSync(s),i.linkSync(e,t)}}},1605:(e,t,n)=>{"use strict";e.exports={...n(8737),...n(4423),...n(2591),...n(6288),...n(3376),...n(3798),...n(2455),...n(7024),...n(9288),...n(5422)}},1674:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AST=void 0;const s=n(3843),r=n(4116),i=new Set(["!","?","+","*","@"]),o=e=>i.has(e),a="(?!\\.)",c=new Set(["[","."]),l=new Set(["..","."]),u=new Set("().*{}+?[]^$\\!"),f="[^/]",d=f+"*?",h=f+"+?";class p{type;#e;#t;#n=!1;#s=[];#r;#i;#o;#a=!1;#c;#l;#u=!1;constructor(e,t,n={}){this.type=e,e&&(this.#t=!0),this.#r=t,this.#e=this.#r?this.#r.#e:this,this.#c=this.#e===this?n:this.#e.#c,this.#o=this.#e===this?[]:this.#e.#o,"!"!==e||this.#e.#a||this.#o.push(this),this.#i=this.#r?this.#r.#s.length:0}get hasMagic(){if(void 0!==this.#t)return this.#t;for(const e of this.#s)if("string"!=typeof e&&(e.type||e.hasMagic))return this.#t=!0;return this.#t}toString(){return void 0!==this.#l?this.#l:this.type?this.#l=this.type+"("+this.#s.map((e=>String(e))).join("|")+")":this.#l=this.#s.map((e=>String(e))).join("")}#f(){if(this!==this.#e)throw new Error("should only call on root");if(this.#a)return this;let e;for(this.toString(),this.#a=!0;e=this.#o.pop();){if("!"!==e.type)continue;let t=e,n=t.#r;for(;n;){for(let s=t.#i+1;!n.type&&s<n.#s.length;s++)for(const t of e.#s){if("string"==typeof t)throw new Error("string part in extglob AST??");t.copyIn(n.#s[s])}t=n,n=t.#r}}return this}push(...e){for(const t of e)if(""!==t){if("string"!=typeof t&&!(t instanceof p&&t.#r===this))throw new Error("invalid part: "+t);this.#s.push(t)}}toJSON(){const e=null===this.type?this.#s.slice().map((e=>"string"==typeof e?e:e.toJSON())):[this.type,...this.#s.map((e=>e.toJSON()))];return this.isStart()&&!this.type&&e.unshift([]),this.isEnd()&&(this===this.#e||this.#e.#a&&"!"===this.#r?.type)&&e.push({}),e}isStart(){if(this.#e===this)return!0;if(!this.#r?.isStart())return!1;if(0===this.#i)return!0;const e=this.#r;for(let t=0;t<this.#i;t++){const n=e.#s[t];if(!(n instanceof p&&"!"===n.type))return!1}return!0}isEnd(){if(this.#e===this)return!0;if("!"===this.#r?.type)return!0;if(!this.#r?.isEnd())return!1;if(!this.type)return this.#r?.isEnd();const e=this.#r?this.#r.#s.length:0;return this.#i===e-1}copyIn(e){"string"==typeof e?this.push(e):this.push(e.clone(this))}clone(e){const t=new p(this.type,e);for(const e of this.#s)t.copyIn(e);return t}static#d(e,t,n,s){let r=!1,i=!1,a=-1,c=!1;if(null===t.type){let l=n,u="";for(;l<e.length;){const n=e.charAt(l++);if(r||"\\"===n)r=!r,u+=n;else if(i)l===a+1?"^"!==n&&"!"!==n||(c=!0):"]"!==n||l===a+2&&c||(i=!1),u+=n;else if("["!==n)if(s.noext||!o(n)||"("!==e.charAt(l))u+=n;else{t.push(u),u="";const r=new p(n,t);l=p.#d(e,r,l,s),t.push(r)}else i=!0,a=l,c=!1,u+=n}return t.push(u),l}let l=n+1,u=new p(null,t);const f=[];let d="";for(;l<e.length;){const n=e.charAt(l++);if(r||"\\"===n)r=!r,d+=n;else if(i)l===a+1?"^"!==n&&"!"!==n||(c=!0):"]"!==n||l===a+2&&c||(i=!1),d+=n;else if("["!==n)if(o(n)&&"("===e.charAt(l)){u.push(d),d="";const t=new p(n,u);u.push(t),l=p.#d(e,t,l,s)}else if("|"!==n){if(")"===n)return""===d&&0===t.#s.length&&(t.#u=!0),u.push(d),d="",t.push(...f,u),l;d+=n}else u.push(d),d="",f.push(u),u=new p(null,t);else i=!0,a=l,c=!1,d+=n}return t.type=null,t.#t=void 0,t.#s=[e.substring(n-1)],l}static fromGlob(e,t={}){const n=new p(null,void 0,t);return p.#d(e,n,0,t),n}toMMPattern(){if(this!==this.#e)return this.#e.toMMPattern();const e=this.toString(),[t,n,s,r]=this.toRegExpSource();if(!(s||this.#t||this.#c.nocase&&!this.#c.nocaseMagicOnly&&e.toUpperCase()!==e.toLowerCase()))return n;const i=(this.#c.nocase?"i":"")+(r?"u":"");return Object.assign(new RegExp(`^${t}$`,i),{_src:t,_glob:e})}get options(){return this.#c}toRegExpSource(e){const t=e??!!this.#c.dot;if(this.#e===this&&this.#f(),!this.type){const n=this.isStart()&&this.isEnd(),s=this.#s.map((t=>{const[s,r,i,o]="string"==typeof t?p.#h(t,this.#t,n):t.toRegExpSource(e);return this.#t=this.#t||i,this.#n=this.#n||o,s})).join("");let i="";if(this.isStart()&&"string"==typeof this.#s[0]&&(1!==this.#s.length||!l.has(this.#s[0]))){const n=c,r=t&&n.has(s.charAt(0))||s.startsWith("\\.")&&n.has(s.charAt(2))||s.startsWith("\\.\\.")&&n.has(s.charAt(4)),o=!t&&!e&&n.has(s.charAt(0));i=r?"(?!(?:^|/)\\.\\.?(?:$|/))":o?a:""}let o="";return this.isEnd()&&this.#e.#a&&"!"===this.#r?.type&&(o="(?:$|\\/)"),[i+s+o,(0,r.unescape)(s),this.#t=!!this.#t,this.#n]}const n="*"===this.type||"+"===this.type,s="!"===this.type?"(?:(?!(?:":"(?:";let i=this.#p(t);if(this.isStart()&&this.isEnd()&&!i&&"!"!==this.type){const e=this.toString();return this.#s=[e],this.type=null,this.#t=void 0,[e,(0,r.unescape)(this.toString()),!1,!1]}let o=!n||e||t?"":this.#p(!0);o===i&&(o=""),o&&(i=`(?:${i})(?:${o})*?`);let u="";return u="!"===this.type&&this.#u?(this.isStart()&&!t?a:"")+h:s+i+("!"===this.type?"))"+(!this.isStart()||t||e?"":a)+d+")":"@"===this.type?")":"?"===this.type?")?":"+"===this.type&&o?")":"*"===this.type&&o?")?":`)${this.type}`),[u,(0,r.unescape)(i),this.#t=!!this.#t,this.#n]}#p(e){return this.#s.map((t=>{if("string"==typeof t)throw new Error("string type in extglob ast??");const[n,s,r,i]=t.toRegExpSource(e);return this.#n=this.#n||i,n})).filter((e=>!(this.isStart()&&this.isEnd()&&!e))).join("|")}static#h(e,t,n=!1){let i=!1,o="",a=!1;for(let r=0;r<e.length;r++){const c=e.charAt(r);if(i)i=!1,o+=(u.has(c)?"\\":"")+c;else if("\\"!==c){if("["===c){const[n,i,c,l]=(0,s.parseClass)(e,r);if(c){o+=n,a=a||i,r+=c-1,t=t||l;continue}}"*"!==c?"?"!==c?o+=c.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"):(o+=f,t=!0):(o+=n&&"*"===e?h:d,t=!0)}else r===e.length-1?o+="\\\\":i=!0}return[o,(0,r.unescape)(e),!!t,a]}}t.AST=p},1995:(e,t,n)=>{var s=n(2203).Stream;e.exports=function(e){return{ReadStream:function t(n,r){if(!(this instanceof t))return new t(n,r);s.call(this);var i=this;this.path=n,this.fd=null,this.readable=!0,this.paused=!1,this.flags="r",this.mode=438,this.bufferSize=65536,r=r||{};for(var o=Object.keys(r),a=0,c=o.length;a<c;a++){var l=o[a];this[l]=r[l]}if(this.encoding&&this.setEncoding(this.encoding),void 0!==this.start){if("number"!=typeof this.start)throw TypeError("start must be a Number");if(void 0===this.end)this.end=1/0;else if("number"!=typeof this.end)throw TypeError("end must be a Number");if(this.start>this.end)throw new Error("start must be <= end");this.pos=this.start}null===this.fd?e.open(this.path,this.flags,this.mode,(function(e,t){if(e)return i.emit("error",e),void(i.readable=!1);i.fd=t,i.emit("open",t),i._read()})):process.nextTick((function(){i._read()}))},WriteStream:function t(n,r){if(!(this instanceof t))return new t(n,r);s.call(this),this.path=n,this.fd=null,this.writable=!0,this.flags="w",this.encoding="binary",this.mode=438,this.bytesWritten=0,r=r||{};for(var i=Object.keys(r),o=0,a=i.length;o<a;o++){var c=i[o];this[c]=r[c]}if(void 0!==this.start){if("number"!=typeof this.start)throw TypeError("start must be a Number");if(this.start<0)throw new Error("start must be >= zero");this.pos=this.start}this.busy=!1,this._queue=[],null===this.fd&&(this._open=e.open,this._queue.push([this._open,this.path,this.flags,this.mode,void 0]),this.flush())}}}},2188:(e,t,n)=>{"use strict";const{stringify:s}=n(1144),{outputFileSync:r}=n(7024);e.exports=function(e,t,n){const i=s(t,n);r(e,i,n)}},2203:e=>{"use strict";e.exports=require("stream")},2363:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.escape=void 0,t.escape=(e,{windowsPathsNoEscape:t=!1}={})=>t?e.replace(/[?*()[\]]/g,"[$&]"):e.replace(/[?*()[\]\\]/g,"\\$&")},2455:(e,t,n)=>{"use strict";const s=n(1236).fromPromise;e.exports={move:s(n(3314)),moveSync:n(6244)}},2591:(e,t,n)=>{"use strict";const s=n(1236).fromPromise,r=n(8737),i=n(6928),o=n(3798),a=n(5422),c=s((async function(e){let t;try{t=await r.readdir(e)}catch{return o.mkdirs(e)}return Promise.all(t.map((t=>a.remove(i.join(e,t)))))}));function l(e){let t;try{t=r.readdirSync(e)}catch{return o.mkdirsSync(e)}t.forEach((t=>{t=i.join(e,t),a.removeSync(t)}))}e.exports={emptyDirSync:l,emptydirSync:l,emptyDir:c,emptydir:c}},2613:e=>{"use strict";e.exports=require("assert")},2909:(e,t,n)=>{let s;try{s=n(3735)}catch(e){s=n(9896)}const r=n(1236),{stringify:i,stripBom:o}=n(1144),a={readFile:r.fromPromise((async function(e,t={}){"string"==typeof t&&(t={encoding:t});const n=t.fs||s,i=!("throws"in t)||t.throws;let a,c=await r.fromCallback(n.readFile)(e,t);c=o(c);try{a=JSON.parse(c,t?t.reviver:null)}catch(t){if(i)throw t.message=`${e}: ${t.message}`,t;return null}return a})),readFileSync:function(e,t={}){"string"==typeof t&&(t={encoding:t});const n=t.fs||s,r=!("throws"in t)||t.throws;try{let s=n.readFileSync(e,t);return s=o(s),JSON.parse(s,t.reviver)}catch(t){if(r)throw t.message=`${e}: ${t.message}`,t;return null}},writeFile:r.fromPromise((async function(e,t,n={}){const o=n.fs||s,a=i(t,n);await r.fromCallback(o.writeFile)(e,a,n)})),writeFileSync:function(e,t,n={}){const r=n.fs||s,o=i(t,n);return r.writeFileSync(e,o,n)}};e.exports=a},2934:(e,t,n)=>{"use strict";const s=n(2909);e.exports={readJson:s.readFile,readJsonSync:s.readFileSync,writeJson:s.writeFile,writeJsonSync:s.writeFileSync}},3314:(e,t,n)=>{"use strict";const s=n(8737),r=n(6928),{copy:i}=n(4423),{remove:o}=n(5422),{mkdirp:a}=n(3798),{pathExists:c}=n(9288),l=n(6462);e.exports=async function(e,t,n={}){const u=n.overwrite||n.clobber||!1,{srcStat:f,isChangingCase:d=!1}=await l.checkPaths(e,t,"move",n);await l.checkParentPaths(e,f,t,"move");const h=r.dirname(t);return r.parse(h).root!==h&&await a(h),async function(e,t,n,r){if(!r)if(n)await o(t);else if(await c(t))throw new Error("dest already exists.");try{await s.rename(e,t)}catch(s){if("EXDEV"!==s.code)throw s;await async function(e,t,n){const s={overwrite:n,errorOnExist:!0,preserveTimestamps:!0};return await i(e,t,s),o(e)}(e,t,n)}}(e,t,u,d)}},3376:(e,t,n)=>{"use strict";const s=n(1236).fromPromise,r=n(2934);r.outputJson=s(n(6426)),r.outputJsonSync=n(2188),r.outputJSON=r.outputJson,r.outputJSONSync=r.outputJsonSync,r.writeJSON=r.writeJson,r.writeJSONSync=r.writeJsonSync,r.readJSON=r.readJson,r.readJSONSync=r.readJsonSync,e.exports=r},3628:function(e,t,n){"use strict";var s,r=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,r)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(s=function(e){return s=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},s(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=s(e),o=0;o<n.length;o++)"default"!==n[o]&&r(t,e,n[o]);return i(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.generateDiffCommon=async function(e,t,n,s,r){if(r)if(0!==e.length)try{const{diffOutput:i,skippedFiles:o,errorMessages:c}=await u(e,t,r);let l="",f=i;if(c.length>0)if(l=(s?`Diff for ${t}`:`Generated diff for ${t}`)+" with errors.",f=`${i}\n\n--- ERRORS ENCOUNTERED ---\n${c.join("\n")}`.trim(),s)await a.env.clipboard.writeText(f);else{const e=await a.workspace.openTextDocument({content:f,language:"diff"});await a.window.showTextDocument(e,{preview:!1})}else if(""===i.trim())l=`No changes found compared to HEAD for ${t}.`;else{const e=s?`Diff (vs HEAD) for ${t}`:`Generated diff (vs HEAD) for ${t}`;if(l=s?`${e} copied.`:`${e}.`,s)await a.env.clipboard.writeText(i);else{const e=await a.workspace.openTextDocument({content:i,language:"diff"});await a.window.showTextDocument(e,{preview:!1})}}if(o.length>0){const e=o.every((e=>e.includes("(untracked")))?" (untracked)":" (untracked or not in a repo)";l?l+=` Skipped ${o.length} item(s)${e}.`:l=`Skipped ${o.length} item(s)${e}. No diff generated.`}l?n(l):0===o.length&&0===c.length&&""===i.trim()&&e.length>0&&n(`No diff generated or items skipped for ${t}.`)}catch(e){console.error(`[CodeLensAI:GenerateDiffCommon] Unexpected Error for scope "${t}":`,e),a.window.showErrorMessage(`CodeLens AI: Failed to generate/copy diff for ${t}: ${e.message}`)}else n(`No file system items found in ${t} to perform Git Diff on.`);else a.window.showErrorMessage("CodeLens AI: Git integration is not available.")},t.calculateDiffForEntries=u;const a=o(n(1398)),c=o(n(6928)),l=n(6185);async function u(e,t,n){if(!n)throw new Error("CodeLens AI: Git API is not available.");const s=new Map,r=[],i=[];let o=0;console.log(`[CodeLensAI:DiffCalc] Processing ${e.length} file system items for scope ${t}`);for(const i of e){let e;try{if(e=a.Uri.parse(i.uriString,!0),"file"!==e.scheme){r.push(`${(0,l.getDisplayUri)(i.uriString)} (non-file)`);continue}}catch(e){console.warn(`[CodeLensAI:DiffCalc][${t}] Skipping invalid URI: ${i.uriString}`,e),r.push(`${i.uriString} (invalid)`);continue}const c=n.getRepository(e);if(!c){if(i.isDirectory||r.push(`${(0,l.getDisplayUri)(i.uriString)} (untracked or no repo)`),!c&&!i.isDirectory)continue;!c&&i.isDirectory}if(c){o++;const e=c.rootUri.toString();s.has(e)||s.set(e,{repo:c,entries:[]}),s.get(e).entries.push(i)}else i.isDirectory&&o++}0===o&&e.length>0&&console.log(`[CodeLensAI:DiffCalc][${t}] No Git-tracked file system items found.`);let u="",f=0;return await a.window.withProgress({location:a.ProgressLocation.Notification,title:`CodeLens AI: Calculating Git diff (vs HEAD) for ${t}...`,cancellable:!1},(async e=>{let n=0;const r=s.size;for(const[o,d]of s.entries()){n++;const o=c.basename(d.repo.rootUri.fsPath);e.report({message:`Processing repo ${n}/${r}: ${o}`,increment:1/r*100});const h=new Set;let p=!1;for(const e of d.entries){const t=a.Uri.parse(e.uriString),n=c.relative(d.repo.rootUri.fsPath,t.fsPath).replace(/\\/g,"/");if(e.isDirectory&&("."===n||""===n)){p=!0;break}e.isDirectory,h.add(n)}let g="",m=!1;try{let e=p?["."]:Array.from(h).filter((e=>"."!==e));if(0===e.length)continue;if(p){const e=await d.repo.diffWithHEAD();if(0===e.length);else{let n="";for(const s of e)try{const e=s.renameUri||s.uri,t=c.relative(d.repo.rootUri.fsPath,e.fsPath).replace(/\\/g,"/"),r=await d.repo.diffWithHEAD(t);r&&""!==r.trim()&&(r.startsWith("diff --git")?n+=r+"\n\n":n+=`diff --git a/${t} b/${t}\n${r}\n\n`,f++)}catch(e){const n=(s.renameUri||s.uri).toString();console.error(`[CodeLensAI:DiffCalc][${t}] Error getting diff for changed file ${(0,l.getDisplayUri)(n)} in repo ${o}:`,e),i.push(`--- Error diffing changed file: ${(0,l.getDisplayUri)(n)} ---\n${e.message}\n${e.stderr||""}\n`)}g=n.trim()}}else{let n="";for(const s of e)try{const e=await d.repo.diffWithHEAD(s);e&&""!==e.trim()&&(e.startsWith("diff --git")?n+=e+"\n":n+=`diff --git a/${s} b/${s}\n${e}\n`,f++)}catch(e){console.error(`[CodeLensAI:DiffCalc][${t}] Error diffing path ${s} in repo ${o}:`,e),i.push(`--- Error diffing path: ${s} ---\n${e.message}\n${e.stderr||""}\n`)}g=n.trim()}g&&""!==g.trim()&&(!m&&(s.size>1||t.startsWith("session"))&&(u+=`--- Diff for repository: ${o} ---\n\n`,m=!0),u+=g+"\n\n")}catch(e){console.error(`[CodeLensAI:DiffCalc][${t}] Error running git diff for repo ${o}:`,e),!m&&(s.size>1||t.startsWith("session"))&&(u+=`--- Diff for repository: ${o} ---\n\n`);let n=`--- Error diffing in repository: ${o} ---\nError: ${e.message||"Unknown Git error"}\n`;e.stderr&&(n+=`Stderr:\n${e.stderr}\n`),e.gitErrorCode&&(n+=`GitErrorCode: ${e.gitErrorCode}\n`),n+="\n",i.push(n)}}})),console.log(`[CodeLensAI:DiffCalc][${t}] Finished. Diff length: ${u.length}, Skipped: ${r.length}, Diffed Files Count: ${f}, Errors: ${i.length}`),{diffOutput:u.trim(),skippedFiles:r,diffedFilesCount:f,errorMessages:i}}},3735:(e,t,n)=>{var s,r,i=n(9896),o=n(9106),a=n(1995),c=n(1283),l=n(9023);function u(e,t){Object.defineProperty(e,s,{get:function(){return t}})}"function"==typeof Symbol&&"function"==typeof Symbol.for?(s=Symbol.for("graceful-fs.queue"),r=Symbol.for("graceful-fs.previous")):(s="___graceful-fs.queue",r="___graceful-fs.previous");var f,d=function(){};if(l.debuglog?d=l.debuglog("gfs4"):/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&(d=function(){var e=l.format.apply(l,arguments);e="GFS4: "+e.split(/\n/).join("\nGFS4: "),console.error(e)}),!i[s]){var h=global[s]||[];u(i,h),i.close=function(e){function t(t,n){return e.call(i,t,(function(e){e||m(),"function"==typeof n&&n.apply(this,arguments)}))}return Object.defineProperty(t,r,{value:e}),t}(i.close),i.closeSync=function(e){function t(t){e.apply(i,arguments),m()}return Object.defineProperty(t,r,{value:e}),t}(i.closeSync),/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&process.on("exit",(function(){d(i[s]),n(2613).equal(i[s].length,0)}))}function p(e){o(e),e.gracefulify=p,e.createReadStream=function(t,n){return new e.ReadStream(t,n)},e.createWriteStream=function(t,n){return new e.WriteStream(t,n)};var t=e.readFile;e.readFile=function(e,n,s){return"function"==typeof n&&(s=n,n=null),function e(n,s,r,i){return t(n,s,(function(t){!t||"EMFILE"!==t.code&&"ENFILE"!==t.code?"function"==typeof r&&r.apply(this,arguments):g([e,[n,s,r],t,i||Date.now(),Date.now()])}))}(e,n,s)};var n=e.writeFile;e.writeFile=function(e,t,s,r){return"function"==typeof s&&(r=s,s=null),function e(t,s,r,i,o){return n(t,s,r,(function(n){!n||"EMFILE"!==n.code&&"ENFILE"!==n.code?"function"==typeof i&&i.apply(this,arguments):g([e,[t,s,r,i],n,o||Date.now(),Date.now()])}))}(e,t,s,r)};var s=e.appendFile;s&&(e.appendFile=function(e,t,n,r){return"function"==typeof n&&(r=n,n=null),function e(t,n,r,i,o){return s(t,n,r,(function(s){!s||"EMFILE"!==s.code&&"ENFILE"!==s.code?"function"==typeof i&&i.apply(this,arguments):g([e,[t,n,r,i],s,o||Date.now(),Date.now()])}))}(e,t,n,r)});var r=e.copyFile;r&&(e.copyFile=function(e,t,n,s){return"function"==typeof n&&(s=n,n=0),function e(t,n,s,i,o){return r(t,n,s,(function(r){!r||"EMFILE"!==r.code&&"ENFILE"!==r.code?"function"==typeof i&&i.apply(this,arguments):g([e,[t,n,s,i],r,o||Date.now(),Date.now()])}))}(e,t,n,s)});var i=e.readdir;e.readdir=function(e,t,n){"function"==typeof t&&(n=t,t=null);var s=c.test(process.version)?function(e,t,n,s){return i(e,r(e,t,n,s))}:function(e,t,n,s){return i(e,t,r(e,t,n,s))};return s(e,t,n);function r(e,t,n,r){return function(i,o){!i||"EMFILE"!==i.code&&"ENFILE"!==i.code?(o&&o.sort&&o.sort(),"function"==typeof n&&n.call(this,i,o)):g([s,[e,t,n],i,r||Date.now(),Date.now()])}}};var c=/^v[0-5]\./;if("v0.8"===process.version.substr(0,4)){var l=a(e);m=l.ReadStream,y=l.WriteStream}var u=e.ReadStream;u&&(m.prototype=Object.create(u.prototype),m.prototype.open=function(){var e=this;S(e.path,e.flags,e.mode,(function(t,n){t?(e.autoClose&&e.destroy(),e.emit("error",t)):(e.fd=n,e.emit("open",n),e.read())}))});var f=e.WriteStream;f&&(y.prototype=Object.create(f.prototype),y.prototype.open=function(){var e=this;S(e.path,e.flags,e.mode,(function(t,n){t?(e.destroy(),e.emit("error",t)):(e.fd=n,e.emit("open",n))}))}),Object.defineProperty(e,"ReadStream",{get:function(){return m},set:function(e){m=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"WriteStream",{get:function(){return y},set:function(e){y=e},enumerable:!0,configurable:!0});var d=m;Object.defineProperty(e,"FileReadStream",{get:function(){return d},set:function(e){d=e},enumerable:!0,configurable:!0});var h=y;function m(e,t){return this instanceof m?(u.apply(this,arguments),this):m.apply(Object.create(m.prototype),arguments)}function y(e,t){return this instanceof y?(f.apply(this,arguments),this):y.apply(Object.create(y.prototype),arguments)}Object.defineProperty(e,"FileWriteStream",{get:function(){return h},set:function(e){h=e},enumerable:!0,configurable:!0});var w=e.open;function S(e,t,n,s){return"function"==typeof n&&(s=n,n=null),function e(t,n,s,r,i){return w(t,n,s,(function(o,a){!o||"EMFILE"!==o.code&&"ENFILE"!==o.code?"function"==typeof r&&r.apply(this,arguments):g([e,[t,n,s,r],o,i||Date.now(),Date.now()])}))}(e,t,n,s)}return e.open=S,e}function g(e){d("ENQUEUE",e[0].name,e[1]),i[s].push(e),y()}function m(){for(var e=Date.now(),t=0;t<i[s].length;++t)i[s][t].length>2&&(i[s][t][3]=e,i[s][t][4]=e);y()}function y(){if(clearTimeout(f),f=void 0,0!==i[s].length){var e=i[s].shift(),t=e[0],n=e[1],r=e[2],o=e[3],a=e[4];if(void 0===o)d("RETRY",t.name,n),t.apply(null,n);else if(Date.now()-o>=6e4){d("TIMEOUT",t.name,n);var c=n.pop();"function"==typeof c&&c.call(null,r)}else{var l=Date.now()-a,u=Math.max(a-o,1);l>=Math.min(1.2*u,100)?(d("RETRY",t.name,n),t.apply(null,n.concat([o]))):i[s].push(e)}void 0===f&&(f=setTimeout(y,0))}}global[s]||u(global,i[s]),e.exports=p(c(i)),process.env.TEST_GRACEFUL_FS_GLOBAL_PATCH&&!i.__patched&&(e.exports=p(i),i.__patched=!0)},3798:(e,t,n)=>{"use strict";const s=n(1236).fromPromise,{makeDir:r,makeDirSync:i}=n(8916),o=s(r);e.exports={mkdirs:o,mkdirsSync:i,mkdirp:o,mkdirpSync:i,ensureDir:o,ensureDirSync:i}},3838:(e,t,n)=>{"use strict";const s=n(6928),r=n(8737),{pathExists:i}=n(9288),o=n(1236).fromPromise;e.exports={symlinkPaths:o((async function(e,t){if(s.isAbsolute(e)){try{await r.lstat(e)}catch(e){throw e.message=e.message.replace("lstat","ensureSymlink"),e}return{toCwd:e,toDst:e}}const n=s.dirname(t),o=s.join(n,e);if(await i(o))return{toCwd:o,toDst:e};try{await r.lstat(e)}catch(e){throw e.message=e.message.replace("lstat","ensureSymlink"),e}return{toCwd:e,toDst:s.relative(n,e)}})),symlinkPathsSync:function(e,t){if(s.isAbsolute(e)){if(!r.existsSync(e))throw new Error("absolute srcpath does not exist");return{toCwd:e,toDst:e}}const n=s.dirname(t),i=s.join(n,e);if(r.existsSync(i))return{toCwd:i,toDst:e};if(!r.existsSync(e))throw new Error("relative srcpath does not exist");return{toCwd:e,toDst:s.relative(n,e)}}}},3843:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseClass=void 0;const n={"[:alnum:]":["\\p{L}\\p{Nl}\\p{Nd}",!0],"[:alpha:]":["\\p{L}\\p{Nl}",!0],"[:ascii:]":["\\x00-\\x7f",!1],"[:blank:]":["\\p{Zs}\\t",!0],"[:cntrl:]":["\\p{Cc}",!0],"[:digit:]":["\\p{Nd}",!0],"[:graph:]":["\\p{Z}\\p{C}",!0,!0],"[:lower:]":["\\p{Ll}",!0],"[:print:]":["\\p{C}",!0],"[:punct:]":["\\p{P}",!0],"[:space:]":["\\p{Z}\\t\\r\\n\\v\\f",!0],"[:upper:]":["\\p{Lu}",!0],"[:word:]":["\\p{L}\\p{Nl}\\p{Nd}\\p{Pc}",!0],"[:xdigit:]":["A-Fa-f0-9",!1]},s=e=>e.replace(/[[\]\\-]/g,"\\$&"),r=e=>e.join("");t.parseClass=(e,t)=>{const i=t;if("["!==e.charAt(i))throw new Error("not in a brace expression");const o=[],a=[];let c=i+1,l=!1,u=!1,f=!1,d=!1,h=i,p="";e:for(;c<e.length;){const t=e.charAt(c);if("!"!==t&&"^"!==t||c!==i+1){if("]"===t&&l&&!f){h=c+1;break}if(l=!0,"\\"!==t||f){if("["===t&&!f)for(const[t,[s,r,l]]of Object.entries(n))if(e.startsWith(t,c)){if(p)return["$.",!1,e.length-i,!0];c+=t.length,l?a.push(s):o.push(s),u=u||r;continue e}f=!1,p?(t>p?o.push(s(p)+"-"+s(t)):t===p&&o.push(s(t)),p="",c++):e.startsWith("-]",c+1)?(o.push(s(t+"-")),c+=2):e.startsWith("-",c+1)?(p=t,c+=2):(o.push(s(t)),c++)}else f=!0,c++}else d=!0,c++}if(h<c)return["",!1,0,!1];if(!o.length&&!a.length)return["$.",!1,e.length-i,!0];if(0===a.length&&1===o.length&&/^\\?.$/.test(o[0])&&!d){return[(g=2===o[0].length?o[0].slice(-1):o[0],g.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")),!1,h-i,!1]}var g;const m="["+(d?"^":"")+r(o)+"]",y="["+(d?"":"^")+r(a)+"]";return[o.length&&a.length?"("+m+"|"+y+")":o.length?m:y,u,h-i,!0]}},3876:(e,t,n)=>{"use strict";const s=n(3735),r=n(6928),i=n(3798).mkdirsSync,o=n(7211).utimesMillisSync,a=n(6462);function c(e,t,n,i){const o=(i.dereference?s.statSync:s.lstatSync)(t);if(o.isDirectory())return function(e,t,n,r,i){return t?f(n,r,i):function(e,t,n,r){return s.mkdirSync(n),f(t,n,r),u(n,e)}(e.mode,n,r,i)}(o,e,t,n,i);if(o.isFile()||o.isCharacterDevice()||o.isBlockDevice())return function(e,t,n,r,i){return t?function(e,t,n,r){if(r.overwrite)return s.unlinkSync(n),l(e,t,n,r);if(r.errorOnExist)throw new Error(`'${n}' already exists`)}(e,n,r,i):l(e,n,r,i)}(o,e,t,n,i);if(o.isSymbolicLink())return function(e,t,n,i){let o=s.readlinkSync(t);if(i.dereference&&(o=r.resolve(process.cwd(),o)),e){let e;try{e=s.readlinkSync(n)}catch(e){if("EINVAL"===e.code||"UNKNOWN"===e.code)return s.symlinkSync(o,n);throw e}if(i.dereference&&(e=r.resolve(process.cwd(),e)),a.isSrcSubdir(o,e))throw new Error(`Cannot copy '${o}' to a subdirectory of itself, '${e}'.`);if(a.isSrcSubdir(e,o))throw new Error(`Cannot overwrite '${e}' with '${o}'.`);return function(e,t){return s.unlinkSync(t),s.symlinkSync(e,t)}(o,n)}return s.symlinkSync(o,n)}(e,t,n,i);if(o.isSocket())throw new Error(`Cannot copy a socket file: ${t}`);if(o.isFIFO())throw new Error(`Cannot copy a FIFO pipe: ${t}`);throw new Error(`Unknown file: ${t}`)}function l(e,t,n,r){return s.copyFileSync(t,n),r.preserveTimestamps&&function(e,t,n){(function(e){return!(128&e)})(e)&&function(e,t){u(e,128|t)}(n,e),function(e,t){const n=s.statSync(e);o(t,n.atime,n.mtime)}(t,n)}(e.mode,t,n),u(n,e.mode)}function u(e,t){return s.chmodSync(e,t)}function f(e,t,n){const r=s.opendirSync(e);try{let s;for(;null!==(s=r.readSync());)d(s.name,e,t,n)}finally{r.closeSync()}}function d(e,t,n,s){const i=r.join(t,e),o=r.join(n,e);if(s.filter&&!s.filter(i,o))return;const{destStat:l}=a.checkPathsSync(i,o,"copy",s);return c(l,i,o,s)}e.exports=function(e,t,n){"function"==typeof n&&(n={filter:n}),(n=n||{}).clobber=!("clobber"in n)||!!n.clobber,n.overwrite="overwrite"in n?!!n.overwrite:n.clobber,n.preserveTimestamps&&"ia32"===process.arch&&process.emitWarning("Using the preserveTimestamps option in 32-bit node is not recommended;\n\n\tsee https://github.com/jprichardson/node-fs-extra/issues/269","Warning","fs-extra-WARN0002");const{srcStat:o,destStat:l}=a.checkPathsSync(e,t,"copy",n);if(a.checkParentPathsSync(e,o,t,"copy"),n.filter&&!n.filter(e,t))return;const u=r.dirname(t);return s.existsSync(u)||i(u),c(l,e,t,n)}},3993:function(e,t,n){"use strict";var s,r=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,r)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(s=function(e){return s=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},s(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=s(e),o=0;o<n.length;o++)"default"!==n[o]&&r(t,e,n[o]);return i(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.SessionManager=void 0;const a=o(n(1398)),c=n(6976);class l{context;sessions=new Map;static STORAGE_KEY="codeLensAiSessions_v3";constructor(e){this.context=e}createSession(e){const t=e||`Session ${this.sessions.size+1}`,n=new c.Session(t);return this.sessions.set(n.id,n),this.persistSessions(),n}getSession(e){return this.sessions.get(e)}getAllSessions(){return Array.from(this.sessions.values()).sort(((e,t)=>e.name.localeCompare(t.name)))}removeSession(e){const t=this.sessions.get(e);if(t){t.dispose();const n=this.sessions.delete(e);return n&&this.persistSessions(),n}return!1}renameSession(e,t){const n=this.sessions.get(e);return!!n&&(n.name=t,this.persistSessions(),!0)}persistSessions(){try{const e=this.getAllSessions().map((e=>({id:e.id,name:e.name,files:e.storage.files.map((e=>({uri:e.uriString,isDirectory:e.isDirectory,parentUri:e.parentUriString})))})));this.context.workspaceState.update(l.STORAGE_KEY,e)}catch(e){console.error("[CodeLensAI:Persist] Error saving session data:",e),a.window.showErrorMessage("CodeLens AI: Error saving session data.")}}loadSessions(){let e;this.sessions.clear();try{e=this.context.workspaceState.get(l.STORAGE_KEY),e||(e=[]),e.forEach((e=>{if(!e||"string"!=typeof e.id||"string"!=typeof e.name||!Array.isArray(e.files))return void console.warn("[CodeLensAI:Load] Skipping invalid session metadata entry:",e);const t=new c.Session(e.name,e.id),n=e.files.map((n=>{if(!n||"string"!=typeof n.uri||"boolean"!=typeof n.isDirectory)return console.warn(`[CodeLensAI:Load] Skipping invalid persisted file entry in session ${e.id}:`,n),null;try{return a.Uri.parse(n.uri),n.parentUri&&a.Uri.parse(n.parentUri),{uriString:n.uri,isDirectory:n.isDirectory,parentUriString:n.parentUri,content:null,sessionId:t.id}}catch(t){return console.warn(`[CodeLensAI:Load] Skipping entry with invalid URI in session ${e.id}:`,n.uri,t),null}})).filter((e=>null!==e));t.storage.restoreFiles(n),this.sessions.set(t.id,t)}))}catch(e){console.error("[CodeLensAI:Load] Error loading session data:",e),this.sessions.clear(),a.window.showErrorMessage("CodeLens AI: Error loading session data. Sessions may be reset.")}0===this.sessions.size&&this.createSession("Default Session")}dispose(){this.getAllSessions().forEach((e=>e.dispose())),this.sessions.clear()}}t.SessionManager=l},4083:function(e,t,n){"use strict";var s,r=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,r)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(s=function(e){return s=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},s(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=s(e),o=0;o<n.length;o++)"default"!==n[o]&&r(t,e,n[o]);return i(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.CodeLensAiProvider=void 0;const a=o(n(1398)),c=o(n(6928)),l=n(172),u=n(6185);t.CodeLensAiProvider=class{sessionManager;_onDidChangeTreeData=new a.EventEmitter;onDidChangeTreeData=this._onDidChangeTreeData.event;dropMimeTypes=["text/uri-list","application/vnd.code.tree.codeLensAiView"];dragMimeTypes=["application/vnd.code.tree.codeLensAiView"];customMimeType="application/vnd.code.tree.codeLensAiView";constructor(e){this.sessionManager=e}getTreeItem(e){return e}getParent(e){if(e instanceof l.ResourceItem){const t=this.sessionManager.getSession(e.sessionId);if(!t)return;if(e.entry.parentUriString){const n=t.storage.findEntry(e.entry.parentUriString);if(n)return new l.ResourceItem(n,n.isDirectory?a.TreeItemCollapsibleState.Collapsed:a.TreeItemCollapsibleState.None)}return new l.SessionItem(t,t.storage.files.length>0?a.TreeItemCollapsibleState.Collapsed:a.TreeItemCollapsibleState.None)}l.SessionItem}getChildren(e){if(!e)return Promise.resolve(this.sessionManager.getAllSessions().map((e=>new l.SessionItem(e,e.storage.files.length>0?a.TreeItemCollapsibleState.Collapsed:a.TreeItemCollapsibleState.None))));if(e instanceof l.SessionItem){const t=this.sessionManager.getSession(e.session.id);if(!t)return[];const n=t.storage.files.filter((e=>!e.parentUriString));return Promise.resolve(n.map((e=>new l.ResourceItem(e,e.isDirectory?a.TreeItemCollapsibleState.Collapsed:a.TreeItemCollapsibleState.None))))}if(e instanceof l.ResourceItem&&e.isDirectory){const t=this.sessionManager.getSession(e.sessionId);if(!t)return[];const n=t.storage.files.filter((t=>t.parentUriString===e.uriString));return Promise.resolve(n.map((e=>new l.ResourceItem(e,e.isDirectory?a.TreeItemCollapsibleState.Collapsed:a.TreeItemCollapsibleState.None))))}return Promise.resolve([])}refresh(e){this._onDidChangeTreeData.fire(e)}findTreeItem(e,t){const n=this.sessionManager.getSession(t);if(!n)return;const s=n.storage.findEntry(e);if(s){const e=s.isDirectory?a.TreeItemCollapsibleState.Collapsed:a.TreeItemCollapsibleState.None;return new l.ResourceItem(s,e)}return n.id!==t||e?void 0:new l.SessionItem(n,n.storage.files.length>0?a.TreeItemCollapsibleState.Collapsed:a.TreeItemCollapsibleState.None)}handleDrag(e,t,n){const s=e.filter((e=>e instanceof l.ResourceItem));if(s.length>0){const e=s.map((e=>`${e.sessionId}::${e.uriString}`));t.set(this.customMimeType,new a.DataTransferItem(e))}}async handleDrop(e,t,n){const s=t.get(this.customMimeType),r=t.get("text/uri-list");if(!n.isCancellationRequested)if(s){const t=s.value;if(!Array.isArray(t)||0===t.length)return;const n=t[0].split("::");if(n.length<2)return void console.warn("[CodeLensAI:handleDrop] Invalid dragged item ID format.");const r=n[0],i=t.map((e=>e.substring(e.indexOf("::")+2))).filter(Boolean),o=this.sessionManager.getSession(r);if(!o)return void console.error(`[CodeLensAI:handleDrop] Session not found for internal drop: ${r}`);let c,f,d=!1;if(e instanceof l.SessionItem){if(e.session.id!==r)return void a.window.showErrorMessage("CodeLens AI: Cannot move items between sessions yet.");d=!0,f=void 0}else{if(!(e instanceof l.ResourceItem))return;if(e.sessionId!==r)return void a.window.showErrorMessage("CodeLens AI: Cannot move items between sessions yet.");c=e.uriString,f=e.entry.parentUriString}const h=o.storage.findEntry(i[0]);if(!h)return;const p=h.parentUriString;if(!d&&p!==f)return void a.window.showWarningMessage("CodeLens AI: Cannot move items between different directory levels yet.");o.storage.reorderItems(i,c,d)?(this.sessionManager.persistSessions(),await(0,u.updateCodeBlockDocument)(o),this.refresh()):this.refresh()}else if(r){let t;if(e instanceof l.SessionItem)t=e.session;else if(e instanceof l.ResourceItem)t=this.sessionManager.getSession(e.sessionId);else{const e=this.sessionManager.getAllSessions();if(t=e[0],t&&e.length>1)a.window.showInformationMessage(`CodeLens AI: Added resources to the first session: "${t.name}"`);else if(!t)return void a.window.showErrorMessage("CodeLens AI: Cannot add resources: No sessions exist.")}if(!t)return void a.window.showErrorMessage("CodeLens AI: Could not determine target session for drop.");const n=(await r.asString()).split("\n").map((e=>e.trim())).filter(Boolean);if(0===n.length)return;let s=!1,i=0;const o=[];await a.window.withProgress({location:a.ProgressLocation.Notification,title:`CodeLens AI: Adding to session "${t.name}"...`,cancellable:!0},(async(e,r)=>{r.onCancellationRequested((()=>{}));for(let l=0;l<n.length&&!r.isCancellationRequested;l++){const r=n[l];let f;try{f=a.Uri.parse(r,!0);const d="file"===f.scheme?f.fsPath:r;if("file"===f.scheme&&(0,u.isPathExcluded)(d)){o.push(c.basename(d)),i++;continue}e.report({message:`(${l+1}/${n.length}) Adding ${(0,u.getDisplayUri)(r,"treeDescription")}`,increment:1/n.length*100}),await t.storage.addResource(f)?s=!0:"file"!==f.scheme||(0,u.isPathExcluded)(d)}catch(e){const t=f?.toString()??r;a.window.showErrorMessage(`CodeLens AI: Error processing ${(0,u.getDisplayUri)(t)}: ${e.message}`),console.error(`[CodeLensAI:handleDrop] Error processing URI ${t}:`,e),i++}}})),s&&(this.sessionManager.persistSessions(),await(0,u.updateCodeBlockDocument)(t));let f="";s&&o.length>0?f=`Added items. Skipped ${o.length} due to exclusion rules: ${o.slice(0,3).join(", ")}${o.length>3?"...":""}`:s&&i>0?f=`Added items. ${i} other item(s) were skipped (duplicates, errors).`:!s&&o.length>0?f=`No new items added. Skipped ${o.length} due to exclusion rules: ${o.slice(0,3).join(", ")}${o.length>3?"...":""}`:!s&&i>0&&(f=`No new items added. ${i} item(s) were skipped (duplicates, errors).`),f&&a.window.showInformationMessage(f),this.refresh()}}}},4116:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unescape=void 0,t.unescape=(e,{windowsPathsNoEscape:t=!1}={})=>t?e.replace(/\[([^\/\\])\]/g,"$1"):e.replace(/((?!\\).|^)\[([^\/\\])\]/g,"$1$2").replace(/\\([^\/])/g,"$1")},4265:function(e,t,n){"use strict";var s,r=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,r)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(s=function(e){return s=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},s(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=s(e),o=0;o<n.length;o++)"default"!==n[o]&&r(t,e,n[o]);return i(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.activate=async function(e){console.log("Activating CodeLens AI..."),S=e;try{const e=a.extensions.getExtension("vscode.git");e?(e.isActive||await e.activate(),w=e.exports.getAPI(1),w?console.log("CodeLens AI: Successfully obtained Git API."):(console.error("CodeLens AI: Failed to get Git API from vscode.git extension."),a.window.showWarningMessage("CodeLens AI: Could not initialize Git features. Git API unavailable."))):(console.warn("CodeLens AI: vscode.git extension not found."),a.window.showWarningMessage("CodeLens AI: vscode.git extension not installed or disabled. Git features unavailable."))}catch(e){console.error("CodeLens AI: Failed to get/activate Git API:",e),a.window.showWarningMessage("CodeLens AI: Could not initialize Git features due to an error.")}g=new u.SessionManager(e),g.loadSessions(),b=e.workspaceState.get(v),b&&!g.getSession(b)&&(b=void 0),await a.commands.executeCommand("setContext","codelensai.hasLastSession",!!b),m=new d.CodeLensAiProvider(g),y=a.window.createTreeView("codeLensAiView",{treeDataProvider:m,dragAndDropController:m,canSelectMany:!0}),e.subscriptions.push(y),function(e){const t=(t,n)=>{e.subscriptions.push(a.commands.registerCommand(t,n))};t("codelensai.addSession",(async()=>{const e=await a.window.showInputBox({prompt:"Enter new session name",value:`Session ${g.getAllSessions().length+1}`});if(e?.trim()){const t=g.createSession(e.trim());m.refresh(),await y.reveal(new f.SessionItem(t),{select:!0,focus:!0,expand:!0})}})),t("codelensai.removeSession",(async e=>{const t=e?.session??await(0,h.selectSession)("Select session to remove",g);t&&"Yes"===await a.window.showWarningMessage(`Remove session "${t.name}" and close its associated document (if open)?`,{modal:!0},"Yes")&&(await t.closeAssociatedDocument(!0),g.removeSession(t.id)&&m.refresh())})),t("codelensai.renameSession",(async e=>{const t=e?.session??await(0,h.selectSession)("Select session to rename",g);if(!t)return;const n=await a.window.showInputBox({prompt:`Enter new name for "${t.name}"`,value:t.name});n?.trim()&&n.trim()!==t.name&&g.renameSession(t.id,n.trim())&&m.refresh()})),t("codelensai.clearSession",(async e=>{const t=e?.session??await(0,h.selectSession)("Select session to clear",g);if(!t)return;if(0===t.storage.files.length)return void a.window.showInformationMessage(`Session "${t.name}" is already empty.`);const n=t.storage.clearFiles();g.persistSessions(),m.refresh(),await(0,h.updateCodeBlockDocument)(t),a.window.showInformationMessage(`Cleared ${n} items from session "${t.name}".`)})),t("codelensai.generateCodeBlock",(async e=>{const t=e?.session??await(0,h.selectSession)("Select session to generate code block for",g);if(!t)return;if(0===t.storage.files.length)return void a.window.showInformationMessage(`Session "${t.name}" is empty.`);const n=await(0,h.showCodeBlockDocument)(t);n&&await a.window.showTextDocument(n,{preview:!1,preserveFocus:!1})})),t("codelensai.copyToClipboard",(async e=>{const t=e?.session??await(0,h.selectSession)("Select session to copy content from",g);if(!t)return;if(0===t.storage.resourcesOnly.length)return void a.window.showInformationMessage(`Session "${t.name}" contains no file/resource content to copy.`);let n="";n=t.associatedDocument&&!t.associatedDocument.isClosed?t.associatedDocument.getText():await(0,h.generateMarkdownContent)(t),n&&!n.startsWith("\x3c!-- No file/resource content")?(await a.env.clipboard.writeText(n),a.window.showInformationMessage(`Session "${t.name}" Code Block content copied!`)):a.window.showWarningMessage("No code block content generated or found to copy.")})),t("codelensai.generateDirectoryCodeBlock",(async e=>{if(!(e instanceof f.ResourceItem&&e.isDirectory))return;const t=g.getSession(e.sessionId);if(!t)return;const n=c.basename(e.resourceUri?.fsPath||"directory"),s=(0,h.getDescendantEntries)(t,e.uriString).filter((e=>!e.isDirectory));if(0===s.length)return void a.window.showInformationMessage(`Directory "${n}" contains no file content within the session.`);const r=await(0,h.generateMarkdownContentForEntries)(s,`Content for Directory: ${n}`),i=await a.workspace.openTextDocument({content:r,language:"markdown"});await a.window.showTextDocument(i,{preview:!1})})),t("codelensai.copyDirectoryContentToClipboard",(async e=>{if(!(e instanceof f.ResourceItem&&e.isDirectory))return;const t=g.getSession(e.sessionId);if(!t)return;const n=c.basename(e.resourceUri?.fsPath||"directory"),s=(0,h.getDescendantEntries)(t,e.uriString).filter((e=>!e.isDirectory));if(0===s.length)return void a.window.showInformationMessage(`Directory "${n}" contains no file content to copy.`);const r=await(0,h.generateMarkdownContentForEntries)(s,`Content for Directory: ${n}`);await a.env.clipboard.writeText(r),a.window.showInformationMessage(`Content for directory "${n}" copied!`)})),t("codelensai.removeItem",(async e=>{if(!(e instanceof f.ResourceItem))return;const t=g.getSession(e.sessionId);t&&t.storage.removeEntry(e.uriString)?(g.persistSessions(),await(0,h.updateCodeBlockDocument)(t),m.refresh(),a.window.showInformationMessage(`Removed "${(0,h.getDisplayUri)(e.uriString,"treeDescription")}". You can undo this by clicking 'Undo Last Removal' in the tree view.`)):m.refresh()})),t("codelensai.refreshView",(()=>m.refresh())),t("codelensai.undoLastRemoval",(async e=>{const t=e?.session??await(0,h.selectSession)("Select session to undo last removal for",g);if(!t)return;if(!t.storage.hasLastRemovedFiles())return void a.window.showInformationMessage(`No recent removals to undo for session "${t.name}".`);const n=t.storage.undoLastRemoval();if(n&&n.length>0){g.persistSessions(),await(0,h.updateCodeBlockDocument)(t),m.refresh(),a.window.showInformationMessage(`Successfully restored ${n.length} item(s) to session "${t.name}".`);try{if(n.length>0){const e=m.findTreeItem(n[0].uriString,t.id);e&&await y.reveal(e,{select:!0,focus:!1,expand:!0})}}catch(e){}}else a.window.showWarningMessage(`Failed to undo last removal for session "${t.name}".`)})),t("codelensai.addActiveEditorToSession",(async e=>{const t=e?.session??await(0,h.selectSession)("Select session to add active editor to",g);t&&await async function(e){const t=a.window.activeTextEditor;if(!t)return void a.window.showInformationMessage("No active editor found.");const{uri:n}=t.document,s=n.toString();if(t.document===e.associatedDocument)return void a.window.showInformationMessage("Cannot add the session's own generated document to itself.");if(e.storage.findEntry(s))return void a.window.showInformationMessage(`"${(0,h.getDisplayUri)(s,"treeDescription")}" is already in session "${e.name}".`);const r={uriString:s,isDirectory:!1,content:null,sessionId:e.id};e.storage.addItem(r)?(g.persistSessions(),await(0,h.updateCodeBlockDocument)(e),m.refresh(),a.window.showInformationMessage(`Added "${(0,h.getDisplayUri)(s,"treeDescription")}" to session "${e.name}".`)):a.window.showWarningMessage(`Failed to add "${(0,h.getDisplayUri)(s)}". It might already exist.`)}(t)})),t("codelensai.addAllOpenEditorsToSession",(async e=>{const t=e?.session??await(0,h.selectSession)("Select session to add all open editors to",g);t&&await async function(e){const t=new Set,n=e.associatedDocument?.uri.toString();if(a.window.tabGroups.all.forEach((e=>{e.tabs.forEach((e=>{const s=e.input?.uri;if(s instanceof a.Uri){const e=s.toString();e!==n&&t.add(e)}}))})),0===t.size)return void a.window.showInformationMessage("No other unique open editors found to add.");let s=0,r=0;if(t.forEach((t=>{if(e.storage.findEntry(t))r++;else{const n={uriString:t,isDirectory:!1,content:null,sessionId:e.id};e.storage.addItem(n)?s++:r++}})),s>0){g.persistSessions(),await(0,h.updateCodeBlockDocument)(e),m.refresh();let t=`Added ${s} editor(s) to "${e.name}".`;r>0&&(t+=` Skipped ${r} (already present or session document).`),a.window.showInformationMessage(t)}else r>0?a.window.showInformationMessage(`All open editors were already present in session "${e.name}" or represent the session document.`):a.window.showInformationMessage("No new editors were added.")}(t)})),t("codelensai.addFolderToSession",(async(e,t)=>{const n=await(0,h.selectSession)("Select session to add folder(s) to",g);if(!n)return;const s=Array.isArray(t)&&t.length>0?t:e?[e]:[];if(0===s.length)return void a.window.showInformationMessage("No folder selected.");const r=new Map;for(const e of s)"file"===e.scheme&&r.set(e.fsPath,e);const i=Array.from(r.values());if(0===i.length)return void a.window.showInformationMessage("Only local folders can be added.");let o=0,u=0;await a.window.withProgress({location:a.ProgressLocation.Notification,title:`CodeLens AI: Adding folder(s) to session "${n.name}"...`,cancellable:!0},(async(e,t)=>{for(let s=0;s<i.length&&!t.isCancellationRequested;s++){const t=i[s];try{if(!(await l.lstat(t.fsPath)).isDirectory())continue}catch{continue}o++;const r=c.basename(t.fsPath);e.report({message:`(${s+1}/${i.length}) ${r}`});try{await n.storage.addResource(t)&&u++}catch(e){console.error("[CodeLensAI:addFolderToSession] Error adding folder",t.fsPath,e)}}})),u>0?(g.persistSessions(),await(0,h.updateCodeBlockDocument)(n),m.refresh(),a.window.showInformationMessage(`Added ${u}/${o} folder(s) to session "${n.name}".`),b=n.id,S.workspaceState.update(v,b),await a.commands.executeCommand("setContext","codelensai.hasLastSession",!0)):a.window.showInformationMessage("No new folders were added. They may already exist or were skipped.")})),t("codelensai.addSelectionToSession",(async(e,t)=>{let n;const s=g.getAllSessions();if(n=1===s.length?s[0]:await(0,h.selectSession)("Select session to add selection to",g),!n)return;const r=Array.isArray(t)&&t.length>0?t:e?[e]:[];if(0===r.length)return void a.window.showInformationMessage("No items selected.");const i=new Map;for(const e of r)"file"===e.scheme&&i.set(e.fsPath,e);const o=Array.from(i.values());if(0===o.length)return void a.window.showInformationMessage("Only local file system items can be added.");let l=0,u=0,f=0;await a.window.withProgress({location:a.ProgressLocation.Notification,title:`CodeLens AI: Adding selection to session "${n.name}"...`,cancellable:!0},(async(e,t)=>{for(let s=0;s<o.length&&!t.isCancellationRequested;s++){const t=o[s],r=c.basename(t.fsPath);e.report({message:`(${s+1}/${o.length}) ${r}`}),l++;try{await n.storage.addResource(t)?u++:f++}catch(e){console.error("[CodeLensAI:addSelectionToSession] Error adding",t.toString(),e)}}})),u>0&&(g.persistSessions(),await(0,h.updateCodeBlockDocument)(n),m.refresh(),b=n.id,S.workspaceState.update(v,b),await a.commands.executeCommand("setContext","codelensai.hasLastSession",!0));const d=[];d.push(`Added ${u}/${l} item(s)`),f>0&&d.push(`Skipped ${f}`),a.window.showInformationMessage(`${d.join(". ")} to session "${n.name}".`)})),t("codelensai.addSelectionToLastSession",(async(e,t)=>{let n=b?g.getSession(b):void 0;if(n||(n=await(0,h.selectSession)("Select session to add selection to",g)),!n)return;const s=Array.isArray(t)&&t.length>0?t:e?[e]:[];if(0===s.length)return void a.window.showInformationMessage("No items selected.");const r=new Map;for(const e of s)"file"===e.scheme&&r.set(e.fsPath,e);const i=Array.from(r.values());if(0===i.length)return void a.window.showInformationMessage("Only local file system items can be added.");let o=0,l=0,u=0;await a.window.withProgress({location:a.ProgressLocation.Notification,title:`CodeLens AI: Adding selection to session "${n.name}"...`,cancellable:!0},(async(e,t)=>{for(let s=0;s<i.length&&!t.isCancellationRequested;s++){const t=i[s],r=c.basename(t.fsPath);e.report({message:`(${s+1}/${i.length}) ${r}`}),o++;try{await n.storage.addResource(t)?l++:u++}catch(e){console.error("[CodeLensAI:addSelectionToLastSession] Error adding",t.toString(),e)}}})),l>0&&(g.persistSessions(),await(0,h.updateCodeBlockDocument)(n),m.refresh(),b=n.id,S.workspaceState.update(v,b),await a.commands.executeCommand("setContext","codelensai.hasLastSession",!0));const f=[];f.push(`Added ${l}/${o} item(s)`),u>0&&f.push(`Skipped ${u}`),a.window.showInformationMessage(`${f.join(". ")} to session "${n.name}".`)})),t("codelensai.copyDirectoryStructure",(async e=>{let t,n,s=[],r="";if(e instanceof f.SessionItem)t=e.session,s=t.storage.files.filter((e=>!e.parentUriString)),n=void 0,r=`session "${t.name}"`;else{if(!(e instanceof f.ResourceItem&&e.isDirectory))return e instanceof f.ResourceItem&&!e.isDirectory?void a.window.showInformationMessage("Cannot copy structure of a single file."):void a.window.showWarningMessage("Please right-click on a Session or Directory item to copy its structure.");if(t=g.getSession(e.sessionId),!t)return;s=t.storage.files.filter((t=>t.parentUriString===e.uriString)),n=e.uriString,r=`directory "${c.basename(e.resourceUri?.fsPath||"directory")}"`}if(!t)return void a.window.showErrorMessage("CodeLens AI: Could not find the session for the selected item.");const i=n?t.storage.findEntry(n):null;if(!i&&n)return void a.window.showErrorMessage("CodeLens AI: Could not find the starting directory entry.");const o=a.workspace.getConfiguration("codelensai").get("excludeFromTree")||{},l=e=>(0,h.isPathExcludedFromTree)(e,o);try{let e="";i?(e+=`${c.basename(a.Uri.parse(i.uriString).fsPath||i.uriString)}\n`,e+=(0,h.buildStructureStringRecursive)(s,t,"  ",1,i.uriString,l)):e+=(0,h.buildStructureStringRecursive)(s,t,"",0,void 0,l),""===e.trim()&&i?e=`${c.basename(a.Uri.parse(i.uriString).fsPath||i.uriString)}\n(Directory is empty or all contents excluded)`:""===e.trim()&&(e="(Session is empty or all contents excluded)"),await a.env.clipboard.writeText(e.trimEnd()),a.window.showInformationMessage(`Directory structure for ${r} copied to clipboard!`)}catch(e){console.error(`[CodeLensAI:CopyStructure] Error building structure for ${r}:`,e),a.window.showErrorMessage(`CodeLens AI: Failed to copy structure: ${e.message}`)}}));const n=async(e,t)=>{if(!w)return void a.window.showErrorMessage("CodeLens AI: Git integration is not available.");let n,s=[],r="";if(e instanceof f.SessionItem)n=e.session,s=[...n.storage.files],r=`session "${n.name}"`;else if(e instanceof f.ResourceItem){if(n=g.getSession(e.sessionId),!n)return;const t=c.basename(e.resourceUri?.fsPath||e.uriString);e.isDirectory?(s=(0,h.getDescendantEntries)(n,e.uriString),r=`directory "${t}"`):(s=[e.entry],r=`file "${t}"`)}else{if(n=await(0,h.selectSession)(`Select session to ${t?"copy":"generate"} Git diff for`,g),!n)return;s=[...n.storage.files],r=`session "${n.name}"`}if(!n)return void a.window.showErrorMessage("CodeLens AI: Could not determine session for Git Diff.");if(0===s.length)return void a.window.showInformationMessage(`No items found in ${r} to diff.`);const i=s.filter((e=>{try{return"file"===a.Uri.parse(e.uriString).scheme}catch{return!1}}));0!==i.length?await(0,p.generateDiffCommon)(i,r,(e=>a.window.showInformationMessage(e)),t,w):a.window.showInformationMessage(`No file system items found in ${r} to diff with Git.`)};t("codelensai.generateDiffDocument",(e=>n(e,!1))),t("codelensai.copyDiffToClipboard",(e=>n(e,!0))),t("codelensai.generateDirectoryDiffDocument",(e=>n(e,!1))),t("codelensai.copyDirectoryDiffToClipboard",(e=>n(e,!0))),t("codelensai.generateFileDiffDocument",(e=>n(e,!1))),t("codelensai.copyFileDiffToClipboard",(e=>n(e,!0))),t("codelensai.expandAllSubdirectories",(async e=>{const t=e?.session??await(0,h.selectSession)("Select session to expand all subdirectories for",g);if(!t)return;const n=t.storage.files.filter((e=>e.isDirectory));if(0!==n.length)try{for(const e of n){const n=m.findTreeItem(e.uriString,t.id);n&&await y.reveal(n,{expand:3})}a.window.showInformationMessage(`Expanded all directories in session "${t.name}".`)}catch(e){a.window.showWarningMessage(`Some directories could not be expanded in session "${t.name}".`)}else a.window.showInformationMessage(`No directories found in session "${t.name}".`)}))}(e),e.subscriptions.push({dispose:()=>g.dispose()}),console.log("CodeLens AI activated.")},t.deactivate=function(){console.log("Deactivating CodeLens AI..."),w=void 0};const a=o(n(1398)),c=o(n(6928)),l=o(n(1605)),u=n(3993),f=n(172),d=n(4083),h=n(6185),p=n(3628);let g,m,y,w,S;const v="codelensai.lastSessionId";let b},4423:(e,t,n)=>{"use strict";const s=n(1236).fromPromise;e.exports={copy:s(n(4994)),copySync:n(3876)}},4994:(e,t,n)=>{"use strict";const s=n(8737),r=n(6928),{mkdirs:i}=n(3798),{pathExists:o}=n(9288),{utimesMillis:a}=n(7211),c=n(6462);async function l(e,t,n){return!n.filter||n.filter(e,t)}async function u(e,t,n,i){const o=i.dereference?s.stat:s.lstat,a=await o(t);if(a.isDirectory())return async function(e,t,n,i,o){t||await s.mkdir(i);const a=[];for await(const e of await s.opendir(n)){const t=r.join(n,e.name),s=r.join(i,e.name);a.push(l(t,s,o).then((e=>{if(e)return c.checkPaths(t,s,"copy",o).then((({destStat:e})=>u(e,t,s,o)))})))}await Promise.all(a),t||await s.chmod(i,e.mode)}(a,e,t,n,i);if(a.isFile()||a.isCharacterDevice()||a.isBlockDevice())return async function(e,t,n,r,i){if(!t)return f(e,n,r,i);if(i.overwrite)return await s.unlink(r),f(e,n,r,i);if(i.errorOnExist)throw new Error(`'${r}' already exists`)}(a,e,t,n,i);if(a.isSymbolicLink())return async function(e,t,n,i){let o=await s.readlink(t);if(i.dereference&&(o=r.resolve(process.cwd(),o)),!e)return s.symlink(o,n);let a=null;try{a=await s.readlink(n)}catch(e){if("EINVAL"===e.code||"UNKNOWN"===e.code)return s.symlink(o,n);throw e}if(i.dereference&&(a=r.resolve(process.cwd(),a)),c.isSrcSubdir(o,a))throw new Error(`Cannot copy '${o}' to a subdirectory of itself, '${a}'.`);if(c.isSrcSubdir(a,o))throw new Error(`Cannot overwrite '${a}' with '${o}'.`);return await s.unlink(n),s.symlink(o,n)}(e,t,n,i);if(a.isSocket())throw new Error(`Cannot copy a socket file: ${t}`);if(a.isFIFO())throw new Error(`Cannot copy a FIFO pipe: ${t}`);throw new Error(`Unknown file: ${t}`)}async function f(e,t,n,r){if(await s.copyFile(t,n),r.preserveTimestamps){128&e.mode||await function(e,t){return s.chmod(e,128|t)}(n,e.mode);const r=await s.stat(t);await a(n,r.atime,r.mtime)}return s.chmod(n,e.mode)}e.exports=async function(e,t,n={}){"function"==typeof n&&(n={filter:n}),n.clobber=!("clobber"in n)||!!n.clobber,n.overwrite="overwrite"in n?!!n.overwrite:n.clobber,n.preserveTimestamps&&"ia32"===process.arch&&process.emitWarning("Using the preserveTimestamps option in 32-bit node is not recommended;\n\n\tsee https://github.com/jprichardson/node-fs-extra/issues/269","Warning","fs-extra-WARN0001");const{srcStat:s,destStat:a}=await c.checkPaths(e,t,"copy",n);if(await c.checkParentPaths(e,s,t,"copy"),!await l(e,t,n))return;const f=r.dirname(t);await o(f)||await i(f),await u(a,e,t,n)}},5291:(e,t,n)=>{"use strict";const s=n(1236).fromPromise,r=n(6928),i=n(8737),{mkdirs:o,mkdirsSync:a}=n(3798),{symlinkPaths:c,symlinkPathsSync:l}=n(3838),{symlinkType:u,symlinkTypeSync:f}=n(7064),{pathExists:d}=n(9288),{areIdentical:h}=n(6462);e.exports={createSymlink:s((async function(e,t,n){let s;try{s=await i.lstat(t)}catch{}if(s&&s.isSymbolicLink()){const[n,s]=await Promise.all([i.stat(e),i.stat(t)]);if(h(n,s))return}const a=await c(e,t);e=a.toDst;const l=await u(a.toCwd,n),f=r.dirname(t);return await d(f)||await o(f),i.symlink(e,t,l)})),createSymlinkSync:function(e,t,n){let s;try{s=i.lstatSync(t)}catch{}if(s&&s.isSymbolicLink()){const n=i.statSync(e),s=i.statSync(t);if(h(n,s))return}const o=l(e,t);e=o.toDst,n=f(o.toCwd,n);const c=r.dirname(t);return i.existsSync(c)||a(c),i.symlinkSync(e,t,n)}}},5422:(e,t,n)=>{"use strict";const s=n(3735),r=n(1236).fromCallback;e.exports={remove:r((function(e,t){s.rm(e,{recursive:!0,force:!0},t)})),removeSync:function(e){s.rmSync(e,{recursive:!0,force:!0})}}},6185:function(e,t,n){"use strict";var s,r=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,r)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(s=function(e){return s=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},s(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=s(e),o=0;o<n.length;o++)"default"!==n[o]&&r(t,e,n[o]);return i(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.isPathExcluded=function(e){const t=a.workspace.getConfiguration("codelensai").get("exclude");if(!t||0===Object.keys(t).length)return!1;const n=e.replace(/\\/g,"/"),s=a.workspace.workspaceFolders,r={dot:!0,nocase:"win32"===process.platform};for(const e in t)if(!0===t[e]){const t=e.replace(/\\/g,"/");if((0,l.minimatch)(n,t,r))return!0;if(s)for(const e of s){const s=e.uri.fsPath.replace(/\\/g,"/");if(n.startsWith(s+"/")){const e=n.substring(s.length+1);if((0,l.minimatch)(e,t,r))return!0}}if(!t.includes("/")&&(0,l.minimatch)(c.basename(n),t,r))return!0}return!1},t.isPathExcludedFromTree=function(e,t){if(!t||0===Object.keys(t).length)return!1;const n=e.replace(/\\/g,"/"),s={dot:!0,nocase:"win32"===process.platform};for(const e in t)if(!0===t[e]){const t=e.replace(/\\/g,"/");if((0,l.minimatch)(n,t,s))return!0}return!1},t.selectSession=async function(e,t){const n=t.getAllSessions();if(0===n.length)return void a.window.showErrorMessage("CodeLens AI: No sessions available.");if(1===n.length)return n[0];const s=n.map((e=>({label:e.name,description:`(${e.storage.files.length} items)`,session:e}))),r=await a.window.showQuickPick(s,{placeHolder:e,canPickMany:!1});return r?.session},t.generateMarkdownContentForEntries=u,t.generateMarkdownContent=f,t.showCodeBlockDocument=async function(e){const t=await f(e);if(e.associatedDocument&&!e.associatedDocument.isClosed){const n=e.associatedDocument;try{const e=new a.WorkspaceEdit;if(e.replace(n.uri,new a.Range(0,0,n.lineCount,0),t),!await a.workspace.applyEdit(e))throw new Error("ApplyEdit failed to update document");return n}catch(s){return console.error(`[CodeLensAI:ShowDoc] Error updating associated doc ${n.uri}:`,s),await e.closeAssociatedDocument(!1),d(e,t)}}return d(e,t)},t.createNewAssociatedDocument=d,t.updateCodeBlockDocument=async function(e){if(e.associatedDocument&&!e.associatedDocument.isClosed){const t=e.associatedDocument,n=await f(e);try{const s=new a.WorkspaceEdit;s.replace(t.uri,new a.Range(0,0,t.lineCount,0),n),await a.workspace.applyEdit(s)||(console.warn(`[CodeLensAI:UpdateDoc] ApplyEdit failed silently for ${t.uri}. Detaching link.`),e.closeAssociatedDocument(!1))}catch(n){console.error(`[CodeLensAI:UpdateDoc] Error applying edit to ${t.uri}:`,n),e.closeAssociatedDocument(!1),a.window.showErrorMessage("CodeLens AI: Error updating the associated code block document.")}}},t.getDisplayUri=h,t.getDisplayPath=p,t.getDescendantEntries=function(e,t){const n=e.storage.findEntry(t);if(!n)return[];if(!n.isDirectory)return[n];const s=[n],r=[t],i=new Set([t]);for(;r.length>0;){const t=r.shift();for(const n of e.storage.files)n.parentUriString!==t||i.has(n.uriString)||(s.push(n),i.add(n.uriString),n.isDirectory&&r.push(n.uriString))}return s},t.buildStructureStringRecursive=function e(t,n,s,r,i,o){let l="";const u=[...t].sort(((e,t)=>{if(e.isDirectory!==t.isDirectory)return e.isDirectory?-1:1;const n=c.basename(a.Uri.parse(e.uriString).path),s=c.basename(a.Uri.parse(t.uriString).path);return n.localeCompare(s)}));return u.forEach(((t,f)=>{const d=f===u.length-1,h=d?"└── ":"├── ",g=a.Uri.parse(t.uriString),m=c.basename(g.path);let y="";try{if(i){const e=a.Uri.parse(i);if("file"===g.scheme&&"file"===e.scheme)y=c.relative(e.fsPath,g.fsPath).replace(/\\/g,"/");else{const t=e.path.split("/").filter(Boolean),n=g.path.split("/").filter(Boolean);let s=0;for(;s<t.length&&s<n.length&&t[s]===n[s];)s++;y=n.slice(s).join("/")}}else y=p(g.fsPath||g.path,!1);""===y&&t.uriString!==i&&(y=m)}catch(e){y=m}if(!o(y)&&(l+=`${s}${h}${m}\n`,t.isDirectory)){const a=n.storage.files.filter((e=>e.parentUriString===t.uriString));l+=e(a,n,s+(d?"    ":"│   "),r+1,i,o)}})),l};const a=o(n(1398)),c=o(n(6928)),l=n(8722);async function u(e,t){let n=t?`\x3c!-- ${t} --\x3e\n\n`:"";const s=e.filter((e=>!e.isDirectory));if(0===s.length)return t?`\x3c!-- ${t} --\x3e\n\x3c!-- No file/resource content found for the given entries. --\x3e\n`:"\x3c!-- No file/resource content found for the given entries. --\x3e\n";for(const e of s){let t=e.content;if(null===t)try{const n=a.Uri.parse(e.uriString);t=(await a.workspace.openTextDocument(n)).getText()}catch(n){console.error(`[CodeLensAI:MarkdownGenEntries] Error reading URI ${e.uriString}:`,n);const s=h(e.uriString);t="FileNotFound"===n?.code||"EntryNotFound"===n?.code||n?.message?.includes("cannot open")||n?.message?.includes("Unable to resolve")?`--- Error: Resource not found or inaccessible (${s}) ---`:`--- Error reading content for ${s}: ${n.message} ---`}const s=h(e.uriString,"markdownHeader"),r=a.Uri.parse(e.uriString).path,i=r.includes("!/")?r.substring(r.lastIndexOf("!/")+1):r,o=c.extname(i);o&&o.substring(1),n+=`<file path="${s}">\n${t??"--- Content Unavailable ---\n"}\n</file>\n\n`}return n.trimEnd()}async function f(e){return u(e.storage.files,`Content for Session: ${e.name}`)}async function d(e,t){try{const n=await a.workspace.openTextDocument({content:t,language:"markdown"});return e.setAssociatedDocument(n),n}catch(t){return console.error("[CodeLensAI:ShowDoc] Failed to create associated document:",t),a.window.showErrorMessage(`CodeLens AI: Failed to create associated document: ${t.message}`),void e.closeAssociatedDocument(!1)}}function h(e,t="markdownHeader"){try{const n=a.Uri.parse(e),s=n.scheme,r=(n.path,n.toString().lastIndexOf("!/"));if("jar"!==s&&"zip"!==s&&"file"!==s||-1===r){if("file"===s)return p(n.fsPath,"treeDescription"===t);{let e=n.fsPath||n.path;n.authority&&e.startsWith("/"+n.authority)&&(e=e.substring(n.authority.length+1)),e.startsWith("/")&&(e=e.substring(1));const r=n.authority?`//${n.authority}/`:"",i=`${s}:`,o=`${i}${r}${e}`;return"treeDescription"===t&&o.length>45?o.substring(0,i.length+4)+"..."+o.substring(o.length-(45-i.length-7)):o}}{const e=n.toString();let i=e.substring(0,r),o=e.substring(r+1),l="archive",u=s;try{const e=a.Uri.parse(i);l=c.basename(e.fsPath||e.path),u=e.scheme}catch{l=c.basename(i)}const f=(o.startsWith("/")?o.substring(1):o).replace(/\\/g,"/"),d=`${l}!/${f}`,h="file"!==u&&u!==s?`${u}:`:"";if("treeDescription"===t){return`${h}${l.length>15?l.substring(0,6)+"..."+l.slice(-6):l}!/${f.length>25?"/.../"+f.slice(-22):f}`}return`${h}${d}`}}catch(n){return"treeDescription"===t&&e.length>40?e.substring(0,15)+"..."+e.substring(e.length-22):e}}function p(e,t=!1){const n=a.workspace.workspaceFolders;let s;if(n){const r=[...n].sort(((e,t)=>t.uri.fsPath.length-e.uri.fsPath.length));for(const i of r){const r=i.uri.fsPath,o=c.relative(r,e);if(!o.startsWith("..")&&!c.isAbsolute(o)){s=""===o?c.basename(r):o,s=s.replace(/\\/g,"/"),t&&""!==o&&n.length>1&&(s=`${c.basename(i.name)}/${s}`);break}}}if(s){if(t&&s.length>40){const e=s.split("/");return e.length>2?e[0]+"/.../"+e[e.length-1]:s}return s}{const n=c.sep,s=e.split(n).filter(Boolean),r=s.length;return t&&r>3?`...${n}${s.slice(-2).join(n)}`:!t&&r>5?`...${n}${s.slice(-3).join(n)}`:e}}},6244:(e,t,n)=>{"use strict";const s=n(3735),r=n(6928),i=n(4423).copySync,o=n(5422).removeSync,a=n(3798).mkdirpSync,c=n(6462);function l(e,t,n){try{s.renameSync(e,t)}catch(s){if("EXDEV"!==s.code)throw s;return function(e,t,n){return i(e,t,{overwrite:n,errorOnExist:!0,preserveTimestamps:!0}),o(e)}(e,t,n)}}e.exports=function(e,t,n){const i=(n=n||{}).overwrite||n.clobber||!1,{srcStat:u,isChangingCase:f=!1}=c.checkPathsSync(e,t,"move",n);return c.checkParentPathsSync(e,u,t,"move"),function(e){const t=r.dirname(e);return r.parse(t).root===t}(t)||a(r.dirname(t)),function(e,t,n,r){if(r)return l(e,t,n);if(n)return o(t),l(e,t,n);if(s.existsSync(t))throw new Error("dest already exists.");return l(e,t,n)}(e,t,i,f)}},6288:(e,t,n)=>{"use strict";const{createFile:s,createFileSync:r}=n(9616),{createLink:i,createLinkSync:o}=n(1522),{createSymlink:a,createSymlinkSync:c}=n(5291);e.exports={createFile:s,createFileSync:r,ensureFile:s,ensureFileSync:r,createLink:i,createLinkSync:o,ensureLink:i,ensureLinkSync:o,createSymlink:a,createSymlinkSync:c,ensureSymlink:a,ensureSymlinkSync:c}},6426:(e,t,n)=>{"use strict";const{stringify:s}=n(1144),{outputFile:r}=n(7024);e.exports=async function(e,t,n={}){const i=s(t,n);await r(e,i,n)}},6462:(e,t,n)=>{"use strict";const s=n(8737),r=n(6928),i=n(1236).fromPromise;function o(e,t){return t.ino&&t.dev&&t.ino===e.ino&&t.dev===e.dev}function a(e,t){const n=r.resolve(e).split(r.sep).filter((e=>e)),s=r.resolve(t).split(r.sep).filter((e=>e));return n.every(((e,t)=>s[t]===e))}function c(e,t,n){return`Cannot ${n} '${e}' to a subdirectory of itself, '${t}'.`}e.exports={checkPaths:i((async function(e,t,n,i){const{srcStat:l,destStat:u}=await function(e,t,n){const r=n.dereference?e=>s.stat(e,{bigint:!0}):e=>s.lstat(e,{bigint:!0});return Promise.all([r(e),r(t).catch((e=>{if("ENOENT"===e.code)return null;throw e}))]).then((([e,t])=>({srcStat:e,destStat:t})))}(e,t,i);if(u){if(o(l,u)){const s=r.basename(e),i=r.basename(t);if("move"===n&&s!==i&&s.toLowerCase()===i.toLowerCase())return{srcStat:l,destStat:u,isChangingCase:!0};throw new Error("Source and destination must not be the same.")}if(l.isDirectory()&&!u.isDirectory())throw new Error(`Cannot overwrite non-directory '${t}' with directory '${e}'.`);if(!l.isDirectory()&&u.isDirectory())throw new Error(`Cannot overwrite directory '${t}' with non-directory '${e}'.`)}if(l.isDirectory()&&a(e,t))throw new Error(c(e,t,n));return{srcStat:l,destStat:u}})),checkPathsSync:function(e,t,n,i){const{srcStat:l,destStat:u}=function(e,t,n){let r;const i=n.dereference?e=>s.statSync(e,{bigint:!0}):e=>s.lstatSync(e,{bigint:!0}),o=i(e);try{r=i(t)}catch(e){if("ENOENT"===e.code)return{srcStat:o,destStat:null};throw e}return{srcStat:o,destStat:r}}(e,t,i);if(u){if(o(l,u)){const s=r.basename(e),i=r.basename(t);if("move"===n&&s!==i&&s.toLowerCase()===i.toLowerCase())return{srcStat:l,destStat:u,isChangingCase:!0};throw new Error("Source and destination must not be the same.")}if(l.isDirectory()&&!u.isDirectory())throw new Error(`Cannot overwrite non-directory '${t}' with directory '${e}'.`);if(!l.isDirectory()&&u.isDirectory())throw new Error(`Cannot overwrite directory '${t}' with non-directory '${e}'.`)}if(l.isDirectory()&&a(e,t))throw new Error(c(e,t,n));return{srcStat:l,destStat:u}},checkParentPaths:i((async function e(t,n,i,a){const l=r.resolve(r.dirname(t)),u=r.resolve(r.dirname(i));if(u===l||u===r.parse(u).root)return;let f;try{f=await s.stat(u,{bigint:!0})}catch(e){if("ENOENT"===e.code)return;throw e}if(o(n,f))throw new Error(c(t,i,a));return e(t,n,u,a)})),checkParentPathsSync:function e(t,n,i,a){const l=r.resolve(r.dirname(t)),u=r.resolve(r.dirname(i));if(u===l||u===r.parse(u).root)return;let f;try{f=s.statSync(u,{bigint:!0})}catch(e){if("ENOENT"===e.code)return;throw e}if(o(n,f))throw new Error(c(t,i,a));return e(t,n,u,a)},isSrcSubdir:a,areIdentical:o}},6899:(e,t,n)=>{"use strict";n.r(t),n.d(t,{NIL:()=>$,parse:()=>w,stringify:()=>d,v1:()=>y,v3:()=>v,v4:()=>E,v5:()=>D,validate:()=>l,version:()=>I});const s=require("crypto");var r=n.n(s);const i=new Uint8Array(256);let o=i.length;function a(){return o>i.length-16&&(r().randomFillSync(i),o=0),i.slice(o,o+=16)}const c=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,l=function(e){return"string"==typeof e&&c.test(e)},u=[];for(let e=0;e<256;++e)u.push((e+256).toString(16).slice(1));function f(e,t=0){return u[e[t+0]]+u[e[t+1]]+u[e[t+2]]+u[e[t+3]]+"-"+u[e[t+4]]+u[e[t+5]]+"-"+u[e[t+6]]+u[e[t+7]]+"-"+u[e[t+8]]+u[e[t+9]]+"-"+u[e[t+10]]+u[e[t+11]]+u[e[t+12]]+u[e[t+13]]+u[e[t+14]]+u[e[t+15]]}const d=function(e,t=0){const n=f(e,t);if(!l(n))throw TypeError("Stringified UUID is invalid");return n};let h,p,g=0,m=0;const y=function(e,t,n){let s=t&&n||0;const r=t||new Array(16);let i=(e=e||{}).node||h,o=void 0!==e.clockseq?e.clockseq:p;if(null==i||null==o){const t=e.random||(e.rng||a)();null==i&&(i=h=[1|t[0],t[1],t[2],t[3],t[4],t[5]]),null==o&&(o=p=16383&(t[6]<<8|t[7]))}let c=void 0!==e.msecs?e.msecs:Date.now(),l=void 0!==e.nsecs?e.nsecs:m+1;const u=c-g+(l-m)/1e4;if(u<0&&void 0===e.clockseq&&(o=o+1&16383),(u<0||c>g)&&void 0===e.nsecs&&(l=0),l>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");g=c,m=l,p=o,c+=122192928e5;const d=(1e4*(268435455&c)+l)%4294967296;r[s++]=d>>>24&255,r[s++]=d>>>16&255,r[s++]=d>>>8&255,r[s++]=255&d;const y=c/4294967296*1e4&268435455;r[s++]=y>>>8&255,r[s++]=255&y,r[s++]=y>>>24&15|16,r[s++]=y>>>16&255,r[s++]=o>>>8|128,r[s++]=255&o;for(let e=0;e<6;++e)r[s+e]=i[e];return t||f(r)},w=function(e){if(!l(e))throw TypeError("Invalid UUID");let t;const n=new Uint8Array(16);return n[0]=(t=parseInt(e.slice(0,8),16))>>>24,n[1]=t>>>16&255,n[2]=t>>>8&255,n[3]=255&t,n[4]=(t=parseInt(e.slice(9,13),16))>>>8,n[5]=255&t,n[6]=(t=parseInt(e.slice(14,18),16))>>>8,n[7]=255&t,n[8]=(t=parseInt(e.slice(19,23),16))>>>8,n[9]=255&t,n[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,n[11]=t/4294967296&255,n[12]=t>>>24&255,n[13]=t>>>16&255,n[14]=t>>>8&255,n[15]=255&t,n};function S(e,t,n){function s(e,s,r,i){var o;if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));const t=[];for(let n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t}(e)),"string"==typeof s&&(s=w(s)),16!==(null===(o=s)||void 0===o?void 0:o.length))throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let a=new Uint8Array(16+e.length);if(a.set(s),a.set(e,s.length),a=n(a),a[6]=15&a[6]|t,a[8]=63&a[8]|128,r){i=i||0;for(let e=0;e<16;++e)r[i+e]=a[e];return r}return f(a)}try{s.name=e}catch(e){}return s.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",s.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",s}const v=S("v3",48,(function(e){return Array.isArray(e)?e=Buffer.from(e):"string"==typeof e&&(e=Buffer.from(e,"utf8")),r().createHash("md5").update(e).digest()})),b={randomUUID:r().randomUUID},E=function(e,t,n){if(b.randomUUID&&!t&&!e)return b.randomUUID();const s=(e=e||{}).random||(e.rng||a)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=s[e];return t}return f(s)},D=S("v5",80,(function(e){return Array.isArray(e)?e=Buffer.from(e):"string"==typeof e&&(e=Buffer.from(e,"utf8")),r().createHash("sha1").update(e).digest()})),$="00000000-0000-0000-0000-000000000000",I=function(e){if(!l(e))throw TypeError("Invalid UUID");return parseInt(e.slice(14,15),16)}},6928:e=>{"use strict";e.exports=require("path")},6976:function(e,t,n){"use strict";var s,r=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,r)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(s=function(e){return s=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},s(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=s(e),o=0;o<n.length;o++)"default"!==n[o]&&r(t,e,n[o]);return i(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.Session=t.SessionResourceStorage=void 0;const a=o(n(1398)),c=o(n(6928)),l=o(n(1605)),u=n(6899),f=n(6185);class d{_files=[];sessionId;lastRemovedFiles=[];constructor(e){this.sessionId=e}get files(){return this._files}get resourcesOnly(){return this._files.filter((e=>!e.isDirectory)).map((e=>({uriString:e.uriString,content:e.content})))}findEntry(e){return this._files.find((t=>t.uriString===e))}addItem(e){return!this._files.some((t=>t.uriString===e.uriString))&&(this._files.push(e),!0)}async addResource(e,t){const n=e.toString(),s=t?.toString();if(this._files.some((e=>e.uriString===n)))return!1;if("file"===e.scheme&&(0,f.isPathExcluded)(e.fsPath))return!1;let r=!1,i=null,o=!1;try{if("file"!==e.scheme||e.path.includes("!/"))r=!1,o=!1;else{const t=await l.stat(e.fsPath);if(r=t.isDirectory(),o=r,!r)try{t.size<1048576?i=await l.readFile(e.fsPath,"utf8"):(console.warn(`[CodeLensAI:Storage:addResource] File too large for initial read, load on demand: ${e.fsPath}`),i=null)}catch(t){console.warn(`[CodeLensAI:Storage:addResource] Failed initial read ${e.fsPath}: ${t.message}`),i=null}}}catch(e){return"ENOENT"===e.code?(console.warn(`[CodeLensAI:Storage:addResource] Resource not found: ${n}`),a.window.showWarningMessage(`Item not found: ${(0,f.getDisplayUri)(n)}`)):(console.error(`[CodeLensAI:Storage:addResource] Error processing URI ${n}:`,e),a.window.showErrorMessage(`Error adding ${(0,f.getDisplayUri)(n)}: ${e.message}`)),!1}const u={uriString:n,isDirectory:r,content:i,parentUriString:s,sessionId:this.sessionId};if(this._files.push(u),o&&"file"===e.scheme)try{const t=await l.readdir(e.fsPath,{withFileTypes:!0}),n=[];for(const s of t){const t=c.join(e.fsPath,s.name),r=a.Uri.file(t);(0,f.isPathExcluded)(t)||n.push(this.addResource(r,e))}await Promise.all(n)}catch(t){console.error(`[CodeLensAI:Storage:addResource] Error reading directory ${e.fsPath}:`,t)}return!0}removeEntry(e){const t=this._files.length;if(!this.findEntry(e))return!1;const n=new Set,s=[e];for(;s.length>0;){const e=s.shift();n.has(e)||(n.add(e),this._files.forEach((t=>{t.parentUriString===e&&s.push(t.uriString)})))}return this.lastRemovedFiles=this._files.filter((e=>n.has(e.uriString))),this._files=this._files.filter((e=>!n.has(e.uriString))),this._files.length<t}clearFiles(){const e=this._files.length;return this.lastRemovedFiles=[...this._files],this._files=[],e}restoreFiles(e){this._files=e}reorderItems(e,t,n=!1){const s=[];for(const t of e){const e=this.findEntry(t);if(!e)return console.error(`[CodeLensAI:Storage:reorder] Dragged entry not found: ${t}`),!1;s.push(e)}if(0===s.length)return!1;const r=s[0].parentUriString;if(!s.every((e=>e.parentUriString===r)))return a.window.showWarningMessage("CodeLens AI: Cannot move items between different containers yet."),!1;s.map((e=>this._files.findIndex((t=>t.uriString===e.uriString)))).sort(((e,t)=>t-e)).forEach((e=>{e>-1&&this._files.splice(e,1)}));let i=-1;if(n)i=this._files.findIndex((e=>void 0===e.parentUriString)),-1===i&&(i=this._files.length),s.forEach((e=>e.parentUriString=void 0));else if(t){const e=this._files.findIndex((e=>e.uriString===t));if(-1===e)return console.error(`[CodeLensAI:Storage:reorder] Target URI not found after removal: ${t}`),this._files.push(...s),!1;const n=this._files[e];i=e,s.forEach((e=>e.parentUriString=n.parentUriString))}else{const e=r;let t=-1;for(let n=this._files.length-1;n>=0;n--)if(this._files[n].parentUriString===e){t=n;break}i=t+1}return this._files.splice(i,0,...s),!0}hasLastRemovedFiles(){return this.lastRemovedFiles.length>0}undoLastRemoval(){if(this.hasLastRemovedFiles()){const e=this.lastRemovedFiles;return this._files=[...this._files,...e],this.lastRemovedFiles=[],e}}}t.SessionResourceStorage=d,t.Session=class{id;name;storage;associatedDocument=null;docCloseListener=null;constructor(e,t=(0,u.v4)()){this.id=t,this.name=e,this.storage=new d(this.id)}dispose(){this.closeAssociatedDocument(!1),this.storage.clearFiles()}setAssociatedDocument(e){this.docCloseListener?.dispose(),this.associatedDocument=e,this.docCloseListener=a.workspace.onDidCloseTextDocument((e=>{e===this.associatedDocument&&(this.associatedDocument=null,this.docCloseListener?.dispose(),this.docCloseListener=null)}))}async closeAssociatedDocument(e=!0){const t=this.associatedDocument;if(this.associatedDocument=null,this.docCloseListener?.dispose(),this.docCloseListener=null,e&&t)for(const e of a.window.visibleTextEditors)if(e.document===t)try{await a.window.showTextDocument(t,{viewColumn:e.viewColumn,preserveFocus:!1}),await a.commands.executeCommand("workbench.action.closeActiveEditor");break}catch(e){console.error(`[CodeLensAI:Session ${this.id}] Error closing editor:`,e)}}}},7024:(e,t,n)=>{"use strict";const s=n(1236).fromPromise,r=n(8737),i=n(6928),o=n(3798),a=n(9288).pathExists;e.exports={outputFile:s((async function(e,t,n="utf-8"){const s=i.dirname(e);return await a(s)||await o.mkdirs(s),r.writeFile(e,t,n)})),outputFileSync:function(e,...t){const n=i.dirname(e);r.existsSync(n)||o.mkdirsSync(n),r.writeFileSync(e,...t)}}},7064:(e,t,n)=>{"use strict";const s=n(8737),r=n(1236).fromPromise;e.exports={symlinkType:r((async function(e,t){if(t)return t;let n;try{n=await s.lstat(e)}catch{return"file"}return n&&n.isDirectory()?"dir":"file"})),symlinkTypeSync:function(e,t){if(t)return t;let n;try{n=s.lstatSync(e)}catch{return"file"}return n&&n.isDirectory()?"dir":"file"}}},7111:(e,t,n)=>{"use strict";const s=n(6928);e.exports.checkPath=function(e){if("win32"===process.platform&&/[<>:"|?*]/.test(e.replace(s.parse(e).root,""))){const t=new Error(`Path contains invalid characters: ${e}`);throw t.code="EINVAL",t}}},7211:(e,t,n)=>{"use strict";const s=n(8737),r=n(1236).fromPromise;e.exports={utimesMillis:r((async function(e,t,n){const r=await s.open(e,"r+");let i=null;try{await s.futimes(r,t,n)}finally{try{await s.close(r)}catch(e){i=e}}if(i)throw i})),utimesMillisSync:function(e,t,n){const r=s.openSync(e,"r+");return s.futimesSync(r,t,n),s.closeSync(r)}}},8505:e=>{"use strict";function t(e,t,r){e instanceof RegExp&&(e=n(e,r)),t instanceof RegExp&&(t=n(t,r));var i=s(e,t,r);return i&&{start:i[0],end:i[1],pre:r.slice(0,i[0]),body:r.slice(i[0]+e.length,i[1]),post:r.slice(i[1]+t.length)}}function n(e,t){var n=t.match(e);return n?n[0]:null}function s(e,t,n){var s,r,i,o,a,c=n.indexOf(e),l=n.indexOf(t,c+1),u=c;if(c>=0&&l>0){if(e===t)return[c,l];for(s=[],i=n.length;u>=0&&!a;)u==c?(s.push(u),c=n.indexOf(e,u+1)):1==s.length?a=[s.pop(),l]:((r=s.pop())<i&&(i=r,o=l),l=n.indexOf(t,u+1)),u=c<l&&c>=0?c:l;s.length&&(a=[i,o])}return a}e.exports=t,t.range=s},8722:function(e,t,n){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.unescape=t.escape=t.AST=t.Minimatch=t.match=t.makeRe=t.braceExpand=t.defaults=t.filter=t.GLOBSTAR=t.sep=t.minimatch=void 0;const r=s(n(8928)),i=n(9274),o=n(1674),a=n(2363),c=n(4116);t.minimatch=(e,t,n={})=>((0,i.assertValidPattern)(t),!(!n.nocomment&&"#"===t.charAt(0))&&new M(t,n).match(e));const l=/^\*+([^+@!?\*\[\(]*)$/,u=e=>t=>!t.startsWith(".")&&t.endsWith(e),f=e=>t=>t.endsWith(e),d=e=>(e=e.toLowerCase(),t=>!t.startsWith(".")&&t.toLowerCase().endsWith(e)),h=e=>(e=e.toLowerCase(),t=>t.toLowerCase().endsWith(e)),p=/^\*+\.\*+$/,g=e=>!e.startsWith(".")&&e.includes("."),m=e=>"."!==e&&".."!==e&&e.includes("."),y=/^\.\*+$/,w=e=>"."!==e&&".."!==e&&e.startsWith("."),S=/^\*+$/,v=e=>0!==e.length&&!e.startsWith("."),b=e=>0!==e.length&&"."!==e&&".."!==e,E=/^\?+([^+@!?\*\[\(]*)?$/,D=([e,t=""])=>{const n=P([e]);return t?(t=t.toLowerCase(),e=>n(e)&&e.toLowerCase().endsWith(t)):n},$=([e,t=""])=>{const n=O([e]);return t?(t=t.toLowerCase(),e=>n(e)&&e.toLowerCase().endsWith(t)):n},I=([e,t=""])=>{const n=O([e]);return t?e=>n(e)&&e.endsWith(t):n},C=([e,t=""])=>{const n=P([e]);return t?e=>n(e)&&e.endsWith(t):n},P=([e])=>{const t=e.length;return e=>e.length===t&&!e.startsWith(".")},O=([e])=>{const t=e.length;return e=>e.length===t&&"."!==e&&".."!==e},x="object"==typeof process&&process?"object"==typeof process.env&&process.env&&process.env.__MINIMATCH_TESTING_PLATFORM__||process.platform:"posix";t.sep="win32"===x?"\\":"/",t.minimatch.sep=t.sep,t.GLOBSTAR=Symbol("globstar **"),t.minimatch.GLOBSTAR=t.GLOBSTAR,t.filter=(e,n={})=>s=>(0,t.minimatch)(s,e,n),t.minimatch.filter=t.filter;const A=(e,t={})=>Object.assign({},e,t);t.defaults=e=>{if(!e||"object"!=typeof e||!Object.keys(e).length)return t.minimatch;const n=t.minimatch;return Object.assign(((t,s,r={})=>n(t,s,A(e,r))),{Minimatch:class extends n.Minimatch{constructor(t,n={}){super(t,A(e,n))}static defaults(t){return n.defaults(A(e,t)).Minimatch}},AST:class extends n.AST{constructor(t,n,s={}){super(t,n,A(e,s))}static fromGlob(t,s={}){return n.AST.fromGlob(t,A(e,s))}},unescape:(t,s={})=>n.unescape(t,A(e,s)),escape:(t,s={})=>n.escape(t,A(e,s)),filter:(t,s={})=>n.filter(t,A(e,s)),defaults:t=>n.defaults(A(e,t)),makeRe:(t,s={})=>n.makeRe(t,A(e,s)),braceExpand:(t,s={})=>n.braceExpand(t,A(e,s)),match:(t,s,r={})=>n.match(t,s,A(e,r)),sep:n.sep,GLOBSTAR:t.GLOBSTAR})},t.minimatch.defaults=t.defaults,t.braceExpand=(e,t={})=>((0,i.assertValidPattern)(e),t.nobrace||!/\{(?:(?!\{).)*\}/.test(e)?[e]:(0,r.default)(e)),t.minimatch.braceExpand=t.braceExpand,t.makeRe=(e,t={})=>new M(e,t).makeRe(),t.minimatch.makeRe=t.makeRe,t.match=(e,t,n={})=>{const s=new M(t,n);return e=e.filter((e=>s.match(e))),s.options.nonull&&!e.length&&e.push(t),e},t.minimatch.match=t.match;const k=/[?*]|[+@!]\(.*?\)|\[|\]/;class M{options;set;pattern;windowsPathsNoEscape;nonegate;negate;comment;empty;preserveMultipleSlashes;partial;globSet;globParts;nocase;isWindows;platform;windowsNoMagicRoot;regexp;constructor(e,t={}){(0,i.assertValidPattern)(e),t=t||{},this.options=t,this.pattern=e,this.platform=t.platform||x,this.isWindows="win32"===this.platform,this.windowsPathsNoEscape=!!t.windowsPathsNoEscape||!1===t.allowWindowsEscape,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.preserveMultipleSlashes=!!t.preserveMultipleSlashes,this.regexp=null,this.negate=!1,this.nonegate=!!t.nonegate,this.comment=!1,this.empty=!1,this.partial=!!t.partial,this.nocase=!!this.options.nocase,this.windowsNoMagicRoot=void 0!==t.windowsNoMagicRoot?t.windowsNoMagicRoot:!(!this.isWindows||!this.nocase),this.globSet=[],this.globParts=[],this.set=[],this.make()}hasMagic(){if(this.options.magicalBraces&&this.set.length>1)return!0;for(const e of this.set)for(const t of e)if("string"!=typeof t)return!0;return!1}debug(...e){}make(){const e=this.pattern,t=this.options;if(!t.nocomment&&"#"===e.charAt(0))return void(this.comment=!0);if(!e)return void(this.empty=!0);this.parseNegate(),this.globSet=[...new Set(this.braceExpand())],t.debug&&(this.debug=(...e)=>console.error(...e)),this.debug(this.pattern,this.globSet);const n=this.globSet.map((e=>this.slashSplit(e)));this.globParts=this.preprocess(n),this.debug(this.pattern,this.globParts);let s=this.globParts.map(((e,t,n)=>{if(this.isWindows&&this.windowsNoMagicRoot){const t=!(""!==e[0]||""!==e[1]||"?"!==e[2]&&k.test(e[2])||k.test(e[3])),n=/^[a-z]:/i.test(e[0]);if(t)return[...e.slice(0,4),...e.slice(4).map((e=>this.parse(e)))];if(n)return[e[0],...e.slice(1).map((e=>this.parse(e)))]}return e.map((e=>this.parse(e)))}));if(this.debug(this.pattern,s),this.set=s.filter((e=>-1===e.indexOf(!1))),this.isWindows)for(let e=0;e<this.set.length;e++){const t=this.set[e];""===t[0]&&""===t[1]&&"?"===this.globParts[e][2]&&"string"==typeof t[3]&&/^[a-z]:$/i.test(t[3])&&(t[2]="?")}this.debug(this.pattern,this.set)}preprocess(e){if(this.options.noglobstar)for(let t=0;t<e.length;t++)for(let n=0;n<e[t].length;n++)"**"===e[t][n]&&(e[t][n]="*");const{optimizationLevel:t=1}=this.options;return t>=2?(e=this.firstPhasePreProcess(e),e=this.secondPhasePreProcess(e)):e=t>=1?this.levelOneOptimize(e):this.adjascentGlobstarOptimize(e),e}adjascentGlobstarOptimize(e){return e.map((e=>{let t=-1;for(;-1!==(t=e.indexOf("**",t+1));){let n=t;for(;"**"===e[n+1];)n++;n!==t&&e.splice(t,n-t)}return e}))}levelOneOptimize(e){return e.map((e=>0===(e=e.reduce(((e,t)=>{const n=e[e.length-1];return"**"===t&&"**"===n?e:".."===t&&n&&".."!==n&&"."!==n&&"**"!==n?(e.pop(),e):(e.push(t),e)}),[])).length?[""]:e))}levelTwoFileOptimize(e){Array.isArray(e)||(e=this.slashSplit(e));let t=!1;do{if(t=!1,!this.preserveMultipleSlashes){for(let n=1;n<e.length-1;n++){const s=e[n];1===n&&""===s&&""===e[0]||"."!==s&&""!==s||(t=!0,e.splice(n,1),n--)}"."!==e[0]||2!==e.length||"."!==e[1]&&""!==e[1]||(t=!0,e.pop())}let n=0;for(;-1!==(n=e.indexOf("..",n+1));){const s=e[n-1];s&&"."!==s&&".."!==s&&"**"!==s&&(t=!0,e.splice(n-1,2),n-=2)}}while(t);return 0===e.length?[""]:e}firstPhasePreProcess(e){let t=!1;do{t=!1;for(let n of e){let s=-1;for(;-1!==(s=n.indexOf("**",s+1));){let r=s;for(;"**"===n[r+1];)r++;r>s&&n.splice(s+1,r-s);let i=n[s+1];const o=n[s+2],a=n[s+3];if(".."!==i)continue;if(!o||"."===o||".."===o||!a||"."===a||".."===a)continue;t=!0,n.splice(s,1);const c=n.slice(0);c[s]="**",e.push(c),s--}if(!this.preserveMultipleSlashes){for(let e=1;e<n.length-1;e++){const s=n[e];1===e&&""===s&&""===n[0]||"."!==s&&""!==s||(t=!0,n.splice(e,1),e--)}"."!==n[0]||2!==n.length||"."!==n[1]&&""!==n[1]||(t=!0,n.pop())}let r=0;for(;-1!==(r=n.indexOf("..",r+1));){const e=n[r-1];if(e&&"."!==e&&".."!==e&&"**"!==e){t=!0;const e=1===r&&"**"===n[r+1]?["."]:[];n.splice(r-1,2,...e),0===n.length&&n.push(""),r-=2}}}}while(t);return e}secondPhasePreProcess(e){for(let t=0;t<e.length-1;t++)for(let n=t+1;n<e.length;n++){const s=this.partsMatch(e[t],e[n],!this.preserveMultipleSlashes);if(s){e[t]=[],e[n]=s;break}}return e.filter((e=>e.length))}partsMatch(e,t,n=!1){let s=0,r=0,i=[],o="";for(;s<e.length&&r<t.length;)if(e[s]===t[r])i.push("b"===o?t[r]:e[s]),s++,r++;else if(n&&"**"===e[s]&&t[r]===e[s+1])i.push(e[s]),s++;else if(n&&"**"===t[r]&&e[s]===t[r+1])i.push(t[r]),r++;else if("*"!==e[s]||!t[r]||!this.options.dot&&t[r].startsWith(".")||"**"===t[r]){if("*"!==t[r]||!e[s]||!this.options.dot&&e[s].startsWith(".")||"**"===e[s])return!1;if("a"===o)return!1;o="b",i.push(t[r]),s++,r++}else{if("b"===o)return!1;o="a",i.push(e[s]),s++,r++}return e.length===t.length&&i}parseNegate(){if(this.nonegate)return;const e=this.pattern;let t=!1,n=0;for(let s=0;s<e.length&&"!"===e.charAt(s);s++)t=!t,n++;n&&(this.pattern=e.slice(n)),this.negate=t}matchOne(e,n,s=!1){const r=this.options;if(this.isWindows){const t="string"==typeof e[0]&&/^[a-z]:$/i.test(e[0]),s=!t&&""===e[0]&&""===e[1]&&"?"===e[2]&&/^[a-z]:$/i.test(e[3]),r="string"==typeof n[0]&&/^[a-z]:$/i.test(n[0]),i=s?3:t?0:void 0,o=!r&&""===n[0]&&""===n[1]&&"?"===n[2]&&"string"==typeof n[3]&&/^[a-z]:$/i.test(n[3])?3:r?0:void 0;if("number"==typeof i&&"number"==typeof o){const[t,s]=[e[i],n[o]];t.toLowerCase()===s.toLowerCase()&&(n[o]=t,o>i?n=n.slice(o):i>o&&(e=e.slice(i)))}}const{optimizationLevel:i=1}=this.options;i>=2&&(e=this.levelTwoFileOptimize(e)),this.debug("matchOne",this,{file:e,pattern:n}),this.debug("matchOne",e.length,n.length);for(var o=0,a=0,c=e.length,l=n.length;o<c&&a<l;o++,a++){this.debug("matchOne loop");var u=n[a],f=e[o];if(this.debug(n,u,f),!1===u)return!1;if(u===t.GLOBSTAR){this.debug("GLOBSTAR",[n,u,f]);var d=o,h=a+1;if(h===l){for(this.debug("** at the end");o<c;o++)if("."===e[o]||".."===e[o]||!r.dot&&"."===e[o].charAt(0))return!1;return!0}for(;d<c;){var p=e[d];if(this.debug("\nglobstar while",e,d,n,h,p),this.matchOne(e.slice(d),n.slice(h),s))return this.debug("globstar found match!",d,c,p),!0;if("."===p||".."===p||!r.dot&&"."===p.charAt(0)){this.debug("dot detected!",e,d,n,h);break}this.debug("globstar swallow a segment, and continue"),d++}return!(!s||(this.debug("\n>>> no match, partial?",e,d,n,h),d!==c))}let i;if("string"==typeof u?(i=f===u,this.debug("string match",u,f,i)):(i=u.test(f),this.debug("pattern match",u,f,i)),!i)return!1}if(o===c&&a===l)return!0;if(o===c)return s;if(a===l)return o===c-1&&""===e[o];throw new Error("wtf?")}braceExpand(){return(0,t.braceExpand)(this.pattern,this.options)}parse(e){(0,i.assertValidPattern)(e);const n=this.options;if("**"===e)return t.GLOBSTAR;if(""===e)return"";let s,r=null;(s=e.match(S))?r=n.dot?b:v:(s=e.match(l))?r=(n.nocase?n.dot?h:d:n.dot?f:u)(s[1]):(s=e.match(E))?r=(n.nocase?n.dot?$:D:n.dot?I:C)(s):(s=e.match(p))?r=n.dot?m:g:(s=e.match(y))&&(r=w);const a=o.AST.fromGlob(e,this.options).toMMPattern();return r&&"object"==typeof a&&Reflect.defineProperty(a,"test",{value:r}),a}makeRe(){if(this.regexp||!1===this.regexp)return this.regexp;const e=this.set;if(!e.length)return this.regexp=!1,this.regexp;const n=this.options,s=n.noglobstar?"[^/]*?":n.dot?"(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?":"(?:(?!(?:\\/|^)\\.).)*?",r=new Set(n.nocase?["i"]:[]);let i=e.map((e=>{const n=e.map((e=>{if(e instanceof RegExp)for(const t of e.flags.split(""))r.add(t);return"string"==typeof e?e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"):e===t.GLOBSTAR?t.GLOBSTAR:e._src}));return n.forEach(((e,r)=>{const i=n[r+1],o=n[r-1];e===t.GLOBSTAR&&o!==t.GLOBSTAR&&(void 0===o?void 0!==i&&i!==t.GLOBSTAR?n[r+1]="(?:\\/|"+s+"\\/)?"+i:n[r]=s:void 0===i?n[r-1]=o+"(?:\\/|"+s+")?":i!==t.GLOBSTAR&&(n[r-1]=o+"(?:\\/|\\/"+s+"\\/)"+i,n[r+1]=t.GLOBSTAR))})),n.filter((e=>e!==t.GLOBSTAR)).join("/")})).join("|");const[o,a]=e.length>1?["(?:",")"]:["",""];i="^"+o+i+a+"$",this.negate&&(i="^(?!"+i+").+$");try{this.regexp=new RegExp(i,[...r].join(""))}catch(e){this.regexp=!1}return this.regexp}slashSplit(e){return this.preserveMultipleSlashes?e.split("/"):this.isWindows&&/^\/\/[^\/]+/.test(e)?["",...e.split(/\/+/)]:e.split(/\/+/)}match(e,t=this.partial){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return""===e;if("/"===e&&t)return!0;const n=this.options;this.isWindows&&(e=e.split("\\").join("/"));const s=this.slashSplit(e);this.debug(this.pattern,"split",s);const r=this.set;this.debug(this.pattern,"set",r);let i=s[s.length-1];if(!i)for(let e=s.length-2;!i&&e>=0;e--)i=s[e];for(let e=0;e<r.length;e++){const o=r[e];let a=s;if(n.matchBase&&1===o.length&&(a=[i]),this.matchOne(a,o,t))return!!n.flipNegate||!this.negate}return!n.flipNegate&&this.negate}static defaults(e){return t.minimatch.defaults(e).Minimatch}}t.Minimatch=M;var L=n(1674);Object.defineProperty(t,"AST",{enumerable:!0,get:function(){return L.AST}});var _=n(2363);Object.defineProperty(t,"escape",{enumerable:!0,get:function(){return _.escape}});var T=n(4116);Object.defineProperty(t,"unescape",{enumerable:!0,get:function(){return T.unescape}}),t.minimatch.AST=o.AST,t.minimatch.Minimatch=M,t.minimatch.escape=a.escape,t.minimatch.unescape=c.unescape},8737:(e,t,n)=>{"use strict";const s=n(1236).fromCallback,r=n(3735),i=["access","appendFile","chmod","chown","close","copyFile","cp","fchmod","fchown","fdatasync","fstat","fsync","ftruncate","futimes","glob","lchmod","lchown","lutimes","link","lstat","mkdir","mkdtemp","open","opendir","readdir","readFile","readlink","realpath","rename","rm","rmdir","stat","statfs","symlink","truncate","unlink","utimes","writeFile"].filter((e=>"function"==typeof r[e]));Object.assign(t,r),i.forEach((e=>{t[e]=s(r[e])})),t.exists=function(e,t){return"function"==typeof t?r.exists(e,t):new Promise((t=>r.exists(e,t)))},t.read=function(e,t,n,s,i,o){return"function"==typeof o?r.read(e,t,n,s,i,o):new Promise(((o,a)=>{r.read(e,t,n,s,i,((e,t,n)=>{if(e)return a(e);o({bytesRead:t,buffer:n})}))}))},t.write=function(e,t,...n){return"function"==typeof n[n.length-1]?r.write(e,t,...n):new Promise(((s,i)=>{r.write(e,t,...n,((e,t,n)=>{if(e)return i(e);s({bytesWritten:t,buffer:n})}))}))},t.readv=function(e,t,...n){return"function"==typeof n[n.length-1]?r.readv(e,t,...n):new Promise(((s,i)=>{r.readv(e,t,...n,((e,t,n)=>{if(e)return i(e);s({bytesRead:t,buffers:n})}))}))},t.writev=function(e,t,...n){return"function"==typeof n[n.length-1]?r.writev(e,t,...n):new Promise(((s,i)=>{r.writev(e,t,...n,((e,t,n)=>{if(e)return i(e);s({bytesWritten:t,buffers:n})}))}))},"function"==typeof r.realpath.native?t.realpath.native=s(r.realpath.native):process.emitWarning("fs.realpath.native is not a function. Is fs being monkey-patched?","Warning","fs-extra-WARN0003")},8916:(e,t,n)=>{"use strict";const s=n(8737),{checkPath:r}=n(7111),i=e=>"number"==typeof e?e:{mode:511,...e}.mode;e.exports.makeDir=async(e,t)=>(r(e),s.mkdir(e,{mode:i(t),recursive:!0})),e.exports.makeDirSync=(e,t)=>(r(e),s.mkdirSync(e,{mode:i(t),recursive:!0}))},8928:(e,t,n)=>{var s=n(8505);e.exports=function(e){return e?("{}"===e.substr(0,2)&&(e="\\{\\}"+e.substr(2)),m(function(e){return e.split("\\\\").join(r).split("\\{").join(i).split("\\}").join(o).split("\\,").join(a).split("\\.").join(c)}(e),!0).map(u)):[]};var r="\0SLASH"+Math.random()+"\0",i="\0OPEN"+Math.random()+"\0",o="\0CLOSE"+Math.random()+"\0",a="\0COMMA"+Math.random()+"\0",c="\0PERIOD"+Math.random()+"\0";function l(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function u(e){return e.split(r).join("\\").split(i).join("{").split(o).join("}").split(a).join(",").split(c).join(".")}function f(e){if(!e)return[""];var t=[],n=s("{","}",e);if(!n)return e.split(",");var r=n.pre,i=n.body,o=n.post,a=r.split(",");a[a.length-1]+="{"+i+"}";var c=f(o);return o.length&&(a[a.length-1]+=c.shift(),a.push.apply(a,c)),t.push.apply(t,a),t}function d(e){return"{"+e+"}"}function h(e){return/^-?0\d/.test(e)}function p(e,t){return e<=t}function g(e,t){return e>=t}function m(e,t){var n=[],r=s("{","}",e);if(!r)return[e];var i=r.pre,a=r.post.length?m(r.post,!1):[""];if(/\$$/.test(r.pre))for(var c=0;c<a.length;c++){var u=i+"{"+r.body+"}"+a[c];n.push(u)}else{var y,w,S=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(r.body),v=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(r.body),b=S||v,E=r.body.indexOf(",")>=0;if(!b&&!E)return r.post.match(/,.*\}/)?m(e=r.pre+"{"+r.body+o+r.post):[e];if(b)y=r.body.split(/\.\./);else if(1===(y=f(r.body)).length&&1===(y=m(y[0],!1).map(d)).length)return a.map((function(e){return r.pre+y[0]+e}));if(b){var D=l(y[0]),$=l(y[1]),I=Math.max(y[0].length,y[1].length),C=3==y.length?Math.abs(l(y[2])):1,P=p;$<D&&(C*=-1,P=g);var O=y.some(h);w=[];for(var x=D;P(x,$);x+=C){var A;if(v)"\\"===(A=String.fromCharCode(x))&&(A="");else if(A=String(x),O){var k=I-A.length;if(k>0){var M=new Array(k+1).join("0");A=x<0?"-"+M+A.slice(1):M+A}}w.push(A)}}else{w=[];for(var L=0;L<y.length;L++)w.push.apply(w,m(y[L],!1))}for(L=0;L<w.length;L++)for(c=0;c<a.length;c++)u=i+w[L]+a[c],(!t||b||u)&&n.push(u)}return n}},9023:e=>{"use strict";e.exports=require("util")},9106:(e,t,n)=>{var s=n(9140),r=process.cwd,i=null,o=process.env.GRACEFUL_FS_PLATFORM||process.platform;process.cwd=function(){return i||(i=r.call(process)),i};try{process.cwd()}catch(e){}if("function"==typeof process.chdir){var a=process.chdir;process.chdir=function(e){i=null,a.call(process,e)},Object.setPrototypeOf&&Object.setPrototypeOf(process.chdir,a)}e.exports=function(e){function t(t){return t?function(n,s,r){return t.call(e,n,s,(function(e){l(e)&&(e=null),r&&r.apply(this,arguments)}))}:t}function n(t){return t?function(n,s){try{return t.call(e,n,s)}catch(e){if(!l(e))throw e}}:t}function r(t){return t?function(n,s,r,i){return t.call(e,n,s,r,(function(e){l(e)&&(e=null),i&&i.apply(this,arguments)}))}:t}function i(t){return t?function(n,s,r){try{return t.call(e,n,s,r)}catch(e){if(!l(e))throw e}}:t}function a(t){return t?function(n,s,r){function i(e,t){t&&(t.uid<0&&(t.uid+=4294967296),t.gid<0&&(t.gid+=4294967296)),r&&r.apply(this,arguments)}return"function"==typeof s&&(r=s,s=null),s?t.call(e,n,s,i):t.call(e,n,i)}:t}function c(t){return t?function(n,s){var r=s?t.call(e,n,s):t.call(e,n);return r&&(r.uid<0&&(r.uid+=4294967296),r.gid<0&&(r.gid+=4294967296)),r}:t}function l(e){return!e||"ENOSYS"===e.code||!(process.getuid&&0===process.getuid()||"EINVAL"!==e.code&&"EPERM"!==e.code)}var u;s.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./)&&function(e){e.lchmod=function(t,n,r){e.open(t,s.O_WRONLY|s.O_SYMLINK,n,(function(t,s){t?r&&r(t):e.fchmod(s,n,(function(t){e.close(s,(function(e){r&&r(t||e)}))}))}))},e.lchmodSync=function(t,n){var r,i=e.openSync(t,s.O_WRONLY|s.O_SYMLINK,n),o=!0;try{r=e.fchmodSync(i,n),o=!1}finally{if(o)try{e.closeSync(i)}catch(e){}else e.closeSync(i)}return r}}(e),e.lutimes||function(e){s.hasOwnProperty("O_SYMLINK")&&e.futimes?(e.lutimes=function(t,n,r,i){e.open(t,s.O_SYMLINK,(function(t,s){t?i&&i(t):e.futimes(s,n,r,(function(t){e.close(s,(function(e){i&&i(t||e)}))}))}))},e.lutimesSync=function(t,n,r){var i,o=e.openSync(t,s.O_SYMLINK),a=!0;try{i=e.futimesSync(o,n,r),a=!1}finally{if(a)try{e.closeSync(o)}catch(e){}else e.closeSync(o)}return i}):e.futimes&&(e.lutimes=function(e,t,n,s){s&&process.nextTick(s)},e.lutimesSync=function(){})}(e),e.chown=r(e.chown),e.fchown=r(e.fchown),e.lchown=r(e.lchown),e.chmod=t(e.chmod),e.fchmod=t(e.fchmod),e.lchmod=t(e.lchmod),e.chownSync=i(e.chownSync),e.fchownSync=i(e.fchownSync),e.lchownSync=i(e.lchownSync),e.chmodSync=n(e.chmodSync),e.fchmodSync=n(e.fchmodSync),e.lchmodSync=n(e.lchmodSync),e.stat=a(e.stat),e.fstat=a(e.fstat),e.lstat=a(e.lstat),e.statSync=c(e.statSync),e.fstatSync=c(e.fstatSync),e.lstatSync=c(e.lstatSync),e.chmod&&!e.lchmod&&(e.lchmod=function(e,t,n){n&&process.nextTick(n)},e.lchmodSync=function(){}),e.chown&&!e.lchown&&(e.lchown=function(e,t,n,s){s&&process.nextTick(s)},e.lchownSync=function(){}),"win32"===o&&(e.rename="function"!=typeof e.rename?e.rename:function(t){function n(n,s,r){var i=Date.now(),o=0;t(n,s,(function a(c){if(c&&("EACCES"===c.code||"EPERM"===c.code||"EBUSY"===c.code)&&Date.now()-i<6e4)return setTimeout((function(){e.stat(s,(function(e,i){e&&"ENOENT"===e.code?t(n,s,a):r(c)}))}),o),void(o<100&&(o+=10));r&&r(c)}))}return Object.setPrototypeOf&&Object.setPrototypeOf(n,t),n}(e.rename)),e.read="function"!=typeof e.read?e.read:function(t){function n(n,s,r,i,o,a){var c;if(a&&"function"==typeof a){var l=0;c=function(u,f,d){if(u&&"EAGAIN"===u.code&&l<10)return l++,t.call(e,n,s,r,i,o,c);a.apply(this,arguments)}}return t.call(e,n,s,r,i,o,c)}return Object.setPrototypeOf&&Object.setPrototypeOf(n,t),n}(e.read),e.readSync="function"!=typeof e.readSync?e.readSync:(u=e.readSync,function(t,n,s,r,i){for(var o=0;;)try{return u.call(e,t,n,s,r,i)}catch(e){if("EAGAIN"===e.code&&o<10){o++;continue}throw e}})}},9140:e=>{"use strict";e.exports=require("constants")},9274:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertValidPattern=void 0,t.assertValidPattern=e=>{if("string"!=typeof e)throw new TypeError("invalid pattern");if(e.length>65536)throw new TypeError("pattern is too long")}},9288:(e,t,n)=>{"use strict";const s=n(1236).fromPromise,r=n(8737);e.exports={pathExists:s((function(e){return r.access(e).then((()=>!0)).catch((()=>!1))})),pathExistsSync:r.existsSync}},9616:(e,t,n)=>{"use strict";const s=n(1236).fromPromise,r=n(6928),i=n(8737),o=n(3798);e.exports={createFile:s((async function(e){let t;try{t=await i.stat(e)}catch{}if(t&&t.isFile())return;const n=r.dirname(e);let s=null;try{s=await i.stat(n)}catch(t){if("ENOENT"===t.code)return await o.mkdirs(n),void await i.writeFile(e,"");throw t}s.isDirectory()?await i.writeFile(e,""):await i.readdir(n)})),createFileSync:function(e){let t;try{t=i.statSync(e)}catch{}if(t&&t.isFile())return;const n=r.dirname(e);try{i.statSync(n).isDirectory()||i.readdirSync(n)}catch(e){if(!e||"ENOENT"!==e.code)throw e;o.mkdirsSync(n)}i.writeFileSync(e,"")}}},9896:e=>{"use strict";e.exports=require("fs")}},t={};function n(s){var r=t[s];if(void 0!==r)return r.exports;var i=t[s]={exports:{}};return e[s].call(i.exports,i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s=n(4265);module.exports=s})();