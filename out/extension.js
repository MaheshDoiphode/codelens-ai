(()=>{var e={172:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),o=0;o<n.length;o++)"default"!==n[o]&&i(t,e,n[o]);return s(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.ResourceItem=t.SessionItem=void 0;const a=o(n(1398)),c=o(n(6928)),l=n(6185);class u extends a.TreeItem{session;constructor(e,t=a.TreeItemCollapsibleState.Collapsed){super(e.name,t),this.session=e,this.id=e.id;const n=e.storage.hasLastRemovedFiles();this.contextValue=n?"sessionWithUndo":"session",this.iconPath=new a.ThemeIcon("folder-library"),this.tooltip=`Session: ${e.name}`,this.description=`(${e.storage.files.length} items)`}}t.SessionItem=u;class f extends a.TreeItem{entry;constructor(e,t){const n=a.Uri.parse(e.uriString);let r="";const i=n.path,s=n.toString().lastIndexOf("!/");if(-1!==s){const e=n.toString().substring(s+1);r=c.basename(e.startsWith("/")?e.substring(1):e)}else r=c.basename(i);r||"file"===n.scheme||(r=n.toString().substring(n.scheme.length+1),r.startsWith("//")&&(r=r.substring(2))),r||(r=e.uriString),super(r,t),this.entry=e,this.id=`${e.sessionId}::${e.uriString}`,this.resourceUri=n,e.isDirectory||(this.command={command:"vscode.open",title:"Open Resource",arguments:[n]},this.collapsibleState=a.TreeItemCollapsibleState.None),this.tooltip=`${e.isDirectory?"Directory (Git Diff applies to tracked files within)":"Resource (Git Diff applies if tracked)"}:\n${(0,l.getDisplayUri)(e.uriString,"tooltip")}`,this.description=(0,l.getDisplayUri)(e.uriString,"treeDescription"),this.contextValue=e.isDirectory?"resourceDirectory":"resourceFile",this.iconPath=e.isDirectory?a.ThemeIcon.Folder:a.ThemeIcon.File}get sessionId(){return this.entry.sessionId}get uriString(){return this.entry.uriString}get isDirectory(){return this.entry.isDirectory}}t.ResourceItem=f},1144:e=>{e.exports={stringify:function(e,{EOL:t="\n",finalEOL:n=!0,replacer:r=null,spaces:i}={}){const s=n?t:"";return JSON.stringify(e,r,i).replace(/\n/g,t)+s},stripBom:function(e){return Buffer.isBuffer(e)&&(e=e.toString("utf8")),e.replace(/^\uFEFF/,"")}}},1236:(e,t)=>{"use strict";t.fromCallback=function(e){return Object.defineProperty((function(...t){if("function"!=typeof t[t.length-1])return new Promise(((n,r)=>{t.push(((e,t)=>null!=e?r(e):n(t))),e.apply(this,t)}));e.apply(this,t)}),"name",{value:e.name})},t.fromPromise=function(e){return Object.defineProperty((function(...t){const n=t[t.length-1];if("function"!=typeof n)return e.apply(this,t);t.pop(),e.apply(this,t).then((e=>n(null,e)),n)}),"name",{value:e.name})}},1283:e=>{"use strict";e.exports=function(e){if(null===e||"object"!=typeof e)return e;if(e instanceof Object)var n={__proto__:t(e)};else n=Object.create(null);return Object.getOwnPropertyNames(e).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))})),n};var t=Object.getPrototypeOf||function(e){return e.__proto__}},1398:e=>{"use strict";e.exports=require("vscode")},1522:(e,t,n)=>{"use strict";const r=n(1236).fromPromise,i=n(6928),s=n(8737),o=n(3798),{pathExists:a}=n(9288),{areIdentical:c}=n(6462);e.exports={createLink:r((async function(e,t){let n,r;try{n=await s.lstat(t)}catch{}try{r=await s.lstat(e)}catch(e){throw e.message=e.message.replace("lstat","ensureLink"),e}if(n&&c(r,n))return;const l=i.dirname(t);await a(l)||await o.mkdirs(l),await s.link(e,t)})),createLinkSync:function(e,t){let n;try{n=s.lstatSync(t)}catch{}try{const t=s.lstatSync(e);if(n&&c(t,n))return}catch(e){throw e.message=e.message.replace("lstat","ensureLink"),e}const r=i.dirname(t);return s.existsSync(r)||o.mkdirsSync(r),s.linkSync(e,t)}}},1605:(e,t,n)=>{"use strict";e.exports={...n(8737),...n(4423),...n(2591),...n(6288),...n(3376),...n(3798),...n(2455),...n(7024),...n(9288),...n(5422)}},1674:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AST=void 0;const r=n(3843),i=n(4116),s=new Set(["!","?","+","*","@"]),o=e=>s.has(e),a="(?!\\.)",c=new Set(["[","."]),l=new Set(["..","."]),u=new Set("().*{}+?[]^$\\!"),f="[^/]",d=f+"*?",h=f+"+?";class p{type;#e;#t;#n=!1;#r=[];#i;#s;#o;#a=!1;#c;#l;#u=!1;constructor(e,t,n={}){this.type=e,e&&(this.#t=!0),this.#i=t,this.#e=this.#i?this.#i.#e:this,this.#c=this.#e===this?n:this.#e.#c,this.#o=this.#e===this?[]:this.#e.#o,"!"!==e||this.#e.#a||this.#o.push(this),this.#s=this.#i?this.#i.#r.length:0}get hasMagic(){if(void 0!==this.#t)return this.#t;for(const e of this.#r)if("string"!=typeof e&&(e.type||e.hasMagic))return this.#t=!0;return this.#t}toString(){return void 0!==this.#l?this.#l:this.type?this.#l=this.type+"("+this.#r.map((e=>String(e))).join("|")+")":this.#l=this.#r.map((e=>String(e))).join("")}#f(){if(this!==this.#e)throw new Error("should only call on root");if(this.#a)return this;let e;for(this.toString(),this.#a=!0;e=this.#o.pop();){if("!"!==e.type)continue;let t=e,n=t.#i;for(;n;){for(let r=t.#s+1;!n.type&&r<n.#r.length;r++)for(const t of e.#r){if("string"==typeof t)throw new Error("string part in extglob AST??");t.copyIn(n.#r[r])}t=n,n=t.#i}}return this}push(...e){for(const t of e)if(""!==t){if("string"!=typeof t&&!(t instanceof p&&t.#i===this))throw new Error("invalid part: "+t);this.#r.push(t)}}toJSON(){const e=null===this.type?this.#r.slice().map((e=>"string"==typeof e?e:e.toJSON())):[this.type,...this.#r.map((e=>e.toJSON()))];return this.isStart()&&!this.type&&e.unshift([]),this.isEnd()&&(this===this.#e||this.#e.#a&&"!"===this.#i?.type)&&e.push({}),e}isStart(){if(this.#e===this)return!0;if(!this.#i?.isStart())return!1;if(0===this.#s)return!0;const e=this.#i;for(let t=0;t<this.#s;t++){const n=e.#r[t];if(!(n instanceof p&&"!"===n.type))return!1}return!0}isEnd(){if(this.#e===this)return!0;if("!"===this.#i?.type)return!0;if(!this.#i?.isEnd())return!1;if(!this.type)return this.#i?.isEnd();const e=this.#i?this.#i.#r.length:0;return this.#s===e-1}copyIn(e){"string"==typeof e?this.push(e):this.push(e.clone(this))}clone(e){const t=new p(this.type,e);for(const e of this.#r)t.copyIn(e);return t}static#d(e,t,n,r){let i=!1,s=!1,a=-1,c=!1;if(null===t.type){let l=n,u="";for(;l<e.length;){const n=e.charAt(l++);if(i||"\\"===n)i=!i,u+=n;else if(s)l===a+1?"^"!==n&&"!"!==n||(c=!0):"]"!==n||l===a+2&&c||(s=!1),u+=n;else if("["!==n)if(r.noext||!o(n)||"("!==e.charAt(l))u+=n;else{t.push(u),u="";const i=new p(n,t);l=p.#d(e,i,l,r),t.push(i)}else s=!0,a=l,c=!1,u+=n}return t.push(u),l}let l=n+1,u=new p(null,t);const f=[];let d="";for(;l<e.length;){const n=e.charAt(l++);if(i||"\\"===n)i=!i,d+=n;else if(s)l===a+1?"^"!==n&&"!"!==n||(c=!0):"]"!==n||l===a+2&&c||(s=!1),d+=n;else if("["!==n)if(o(n)&&"("===e.charAt(l)){u.push(d),d="";const t=new p(n,u);u.push(t),l=p.#d(e,t,l,r)}else if("|"!==n){if(")"===n)return""===d&&0===t.#r.length&&(t.#u=!0),u.push(d),d="",t.push(...f,u),l;d+=n}else u.push(d),d="",f.push(u),u=new p(null,t);else s=!0,a=l,c=!1,d+=n}return t.type=null,t.#t=void 0,t.#r=[e.substring(n-1)],l}static fromGlob(e,t={}){const n=new p(null,void 0,t);return p.#d(e,n,0,t),n}toMMPattern(){if(this!==this.#e)return this.#e.toMMPattern();const e=this.toString(),[t,n,r,i]=this.toRegExpSource();if(!(r||this.#t||this.#c.nocase&&!this.#c.nocaseMagicOnly&&e.toUpperCase()!==e.toLowerCase()))return n;const s=(this.#c.nocase?"i":"")+(i?"u":"");return Object.assign(new RegExp(`^${t}$`,s),{_src:t,_glob:e})}get options(){return this.#c}toRegExpSource(e){const t=e??!!this.#c.dot;if(this.#e===this&&this.#f(),!this.type){const n=this.isStart()&&this.isEnd(),r=this.#r.map((t=>{const[r,i,s,o]="string"==typeof t?p.#h(t,this.#t,n):t.toRegExpSource(e);return this.#t=this.#t||s,this.#n=this.#n||o,r})).join("");let s="";if(this.isStart()&&"string"==typeof this.#r[0]&&(1!==this.#r.length||!l.has(this.#r[0]))){const n=c,i=t&&n.has(r.charAt(0))||r.startsWith("\\.")&&n.has(r.charAt(2))||r.startsWith("\\.\\.")&&n.has(r.charAt(4)),o=!t&&!e&&n.has(r.charAt(0));s=i?"(?!(?:^|/)\\.\\.?(?:$|/))":o?a:""}let o="";return this.isEnd()&&this.#e.#a&&"!"===this.#i?.type&&(o="(?:$|\\/)"),[s+r+o,(0,i.unescape)(r),this.#t=!!this.#t,this.#n]}const n="*"===this.type||"+"===this.type,r="!"===this.type?"(?:(?!(?:":"(?:";let s=this.#p(t);if(this.isStart()&&this.isEnd()&&!s&&"!"!==this.type){const e=this.toString();return this.#r=[e],this.type=null,this.#t=void 0,[e,(0,i.unescape)(this.toString()),!1,!1]}let o=!n||e||t?"":this.#p(!0);o===s&&(o=""),o&&(s=`(?:${s})(?:${o})*?`);let u="";return u="!"===this.type&&this.#u?(this.isStart()&&!t?a:"")+h:r+s+("!"===this.type?"))"+(!this.isStart()||t||e?"":a)+d+")":"@"===this.type?")":"?"===this.type?")?":"+"===this.type&&o?")":"*"===this.type&&o?")?":`)${this.type}`),[u,(0,i.unescape)(s),this.#t=!!this.#t,this.#n]}#p(e){return this.#r.map((t=>{if("string"==typeof t)throw new Error("string type in extglob ast??");const[n,r,i,s]=t.toRegExpSource(e);return this.#n=this.#n||s,n})).filter((e=>!(this.isStart()&&this.isEnd()&&!e))).join("|")}static#h(e,t,n=!1){let s=!1,o="",a=!1;for(let i=0;i<e.length;i++){const c=e.charAt(i);if(s)s=!1,o+=(u.has(c)?"\\":"")+c;else if("\\"!==c){if("["===c){const[n,s,c,l]=(0,r.parseClass)(e,i);if(c){o+=n,a=a||s,i+=c-1,t=t||l;continue}}"*"!==c?"?"!==c?o+=c.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"):(o+=f,t=!0):(o+=n&&"*"===e?h:d,t=!0)}else i===e.length-1?o+="\\\\":s=!0}return[o,(0,i.unescape)(e),!!t,a]}}t.AST=p},1995:(e,t,n)=>{var r=n(2203).Stream;e.exports=function(e){return{ReadStream:function t(n,i){if(!(this instanceof t))return new t(n,i);r.call(this);var s=this;this.path=n,this.fd=null,this.readable=!0,this.paused=!1,this.flags="r",this.mode=438,this.bufferSize=65536,i=i||{};for(var o=Object.keys(i),a=0,c=o.length;a<c;a++){var l=o[a];this[l]=i[l]}if(this.encoding&&this.setEncoding(this.encoding),void 0!==this.start){if("number"!=typeof this.start)throw TypeError("start must be a Number");if(void 0===this.end)this.end=1/0;else if("number"!=typeof this.end)throw TypeError("end must be a Number");if(this.start>this.end)throw new Error("start must be <= end");this.pos=this.start}null===this.fd?e.open(this.path,this.flags,this.mode,(function(e,t){if(e)return s.emit("error",e),void(s.readable=!1);s.fd=t,s.emit("open",t),s._read()})):process.nextTick((function(){s._read()}))},WriteStream:function t(n,i){if(!(this instanceof t))return new t(n,i);r.call(this),this.path=n,this.fd=null,this.writable=!0,this.flags="w",this.encoding="binary",this.mode=438,this.bytesWritten=0,i=i||{};for(var s=Object.keys(i),o=0,a=s.length;o<a;o++){var c=s[o];this[c]=i[c]}if(void 0!==this.start){if("number"!=typeof this.start)throw TypeError("start must be a Number");if(this.start<0)throw new Error("start must be >= zero");this.pos=this.start}this.busy=!1,this._queue=[],null===this.fd&&(this._open=e.open,this._queue.push([this._open,this.path,this.flags,this.mode,void 0]),this.flush())}}}},2188:(e,t,n)=>{"use strict";const{stringify:r}=n(1144),{outputFileSync:i}=n(7024);e.exports=function(e,t,n){const s=r(t,n);i(e,s,n)}},2203:e=>{"use strict";e.exports=require("stream")},2363:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.escape=void 0,t.escape=(e,{windowsPathsNoEscape:t=!1}={})=>t?e.replace(/[?*()[\]]/g,"[$&]"):e.replace(/[?*()[\]\\]/g,"\\$&")},2455:(e,t,n)=>{"use strict";const r=n(1236).fromPromise;e.exports={move:r(n(3314)),moveSync:n(6244)}},2591:(e,t,n)=>{"use strict";const r=n(1236).fromPromise,i=n(8737),s=n(6928),o=n(3798),a=n(5422),c=r((async function(e){let t;try{t=await i.readdir(e)}catch{return o.mkdirs(e)}return Promise.all(t.map((t=>a.remove(s.join(e,t)))))}));function l(e){let t;try{t=i.readdirSync(e)}catch{return o.mkdirsSync(e)}t.forEach((t=>{t=s.join(e,t),a.removeSync(t)}))}e.exports={emptyDirSync:l,emptydirSync:l,emptyDir:c,emptydir:c}},2613:e=>{"use strict";e.exports=require("assert")},2652:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),o=0;o<n.length;o++)"default"!==n[o]&&i(t,e,n[o]);return s(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.HumanRelayHandler=t.handleHumanRelayResponse=t.unregisterHumanRelayCallback=t.registerHumanRelayCallback=void 0;const a=o(n(1398)),c=new Map;t.registerHumanRelayCallback=(e,t)=>{c.set(e,t)},t.unregisterHumanRelayCallback=e=>{c.delete(e)},t.handleHumanRelayResponse=e=>{const t=c.get(e.requestId);t&&(e.cancelled?t(void 0):t(e.text),c.delete(e.requestId))},t.HumanRelayHandler=class{async completePrompt(e){return new Promise((async(n,r)=>{await a.env.clipboard.writeText(e);const i=Date.now().toString();(0,t.registerHumanRelayCallback)(i,(e=>{e?n(e):r(new Error("Human relay operation cancelled"))})),a.commands.executeCommand("codelensai.humanRelay",{requestId:i,promptText:e})}))}}},2909:(e,t,n)=>{let r;try{r=n(3735)}catch(e){r=n(9896)}const i=n(1236),{stringify:s,stripBom:o}=n(1144),a={readFile:i.fromPromise((async function(e,t={}){"string"==typeof t&&(t={encoding:t});const n=t.fs||r,s=!("throws"in t)||t.throws;let a,c=await i.fromCallback(n.readFile)(e,t);c=o(c);try{a=JSON.parse(c,t?t.reviver:null)}catch(t){if(s)throw t.message=`${e}: ${t.message}`,t;return null}return a})),readFileSync:function(e,t={}){"string"==typeof t&&(t={encoding:t});const n=t.fs||r,i=!("throws"in t)||t.throws;try{let r=n.readFileSync(e,t);return r=o(r),JSON.parse(r,t.reviver)}catch(t){if(i)throw t.message=`${e}: ${t.message}`,t;return null}},writeFile:i.fromPromise((async function(e,t,n={}){const o=n.fs||r,a=s(t,n);await i.fromCallback(o.writeFile)(e,a,n)})),writeFileSync:function(e,t,n={}){const i=n.fs||r,o=s(t,n);return i.writeFileSync(e,o,n)}};e.exports=a},2934:(e,t,n)=>{"use strict";const r=n(2909);e.exports={readJson:r.readFile,readJsonSync:r.readFileSync,writeJson:r.writeFile,writeJsonSync:r.writeFileSync}},3314:(e,t,n)=>{"use strict";const r=n(8737),i=n(6928),{copy:s}=n(4423),{remove:o}=n(5422),{mkdirp:a}=n(3798),{pathExists:c}=n(9288),l=n(6462);e.exports=async function(e,t,n={}){const u=n.overwrite||n.clobber||!1,{srcStat:f,isChangingCase:d=!1}=await l.checkPaths(e,t,"move",n);await l.checkParentPaths(e,f,t,"move");const h=i.dirname(t);return i.parse(h).root!==h&&await a(h),async function(e,t,n,i){if(!i)if(n)await o(t);else if(await c(t))throw new Error("dest already exists.");try{await r.rename(e,t)}catch(r){if("EXDEV"!==r.code)throw r;await async function(e,t,n){const r={overwrite:n,errorOnExist:!0,preserveTimestamps:!0};return await s(e,t,r),o(e)}(e,t,n)}}(e,t,u,d)}},3376:(e,t,n)=>{"use strict";const r=n(1236).fromPromise,i=n(2934);i.outputJson=r(n(6426)),i.outputJsonSync=n(2188),i.outputJSON=i.outputJson,i.outputJSONSync=i.outputJsonSync,i.writeJSON=i.writeJson,i.writeJSONSync=i.writeJsonSync,i.readJSON=i.readJson,i.readJSONSync=i.readJsonSync,e.exports=i},3628:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),o=0;o<n.length;o++)"default"!==n[o]&&i(t,e,n[o]);return s(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.generateDiffCommon=async function(e,t,n,r,i){if(i)if(0!==e.length)try{const{diffOutput:s,skippedFiles:o,errorMessages:c}=await u(e,t,i);let l="",f=s;if(c.length>0)if(l=(r?`Diff for ${t}`:`Generated diff for ${t}`)+" with errors.",f=`${s}\n\n--- ERRORS ENCOUNTERED ---\n${c.join("\n")}`.trim(),r)await a.env.clipboard.writeText(f);else{const e=await a.workspace.openTextDocument({content:f,language:"diff"});await a.window.showTextDocument(e,{preview:!1})}else if(""===s.trim())l=`No changes found compared to HEAD for ${t}.`;else{const e=r?`Diff (vs HEAD) for ${t}`:`Generated diff (vs HEAD) for ${t}`;if(l=r?`${e} copied.`:`${e}.`,r)await a.env.clipboard.writeText(s);else{const e=await a.workspace.openTextDocument({content:s,language:"diff"});await a.window.showTextDocument(e,{preview:!1})}}if(o.length>0){const e=o.every((e=>e.includes("(untracked")))?" (untracked)":" (untracked or not in a repo)";l?l+=` Skipped ${o.length} item(s)${e}.`:l=`Skipped ${o.length} item(s)${e}. No diff generated.`}l?n(l):0===o.length&&0===c.length&&""===s.trim()&&e.length>0&&n(`No diff generated or items skipped for ${t}.`)}catch(e){console.error(`[CodeLensAI:GenerateDiffCommon] Unexpected Error for scope "${t}":`,e),a.window.showErrorMessage(`CodeLens AI: Failed to generate/copy diff for ${t}: ${e.message}`)}else n(`No file system items found in ${t} to perform Git Diff on.`);else a.window.showErrorMessage("CodeLens AI: Git integration is not available.")},t.calculateDiffForEntries=u;const a=o(n(1398)),c=o(n(6928)),l=n(6185);async function u(e,t,n){if(!n)throw new Error("CodeLens AI: Git API is not available.");const r=new Map,i=[],s=[];let o=0;console.log(`[CodeLensAI:DiffCalc] Processing ${e.length} file system items for scope ${t}`);for(const s of e){let e;try{if(e=a.Uri.parse(s.uriString,!0),"file"!==e.scheme){i.push(`${(0,l.getDisplayUri)(s.uriString)} (non-file)`);continue}}catch(e){console.warn(`[CodeLensAI:DiffCalc][${t}] Skipping invalid URI: ${s.uriString}`,e),i.push(`${s.uriString} (invalid)`);continue}const c=n.getRepository(e);if(!c){if(s.isDirectory||i.push(`${(0,l.getDisplayUri)(s.uriString)} (untracked or no repo)`),!c&&!s.isDirectory)continue;!c&&s.isDirectory}if(c){o++;const e=c.rootUri.toString();r.has(e)||r.set(e,{repo:c,entries:[]}),r.get(e).entries.push(s)}else s.isDirectory&&o++}0===o&&e.length>0&&console.log(`[CodeLensAI:DiffCalc][${t}] No Git-tracked file system items found.`);let u="",f=0;return await a.window.withProgress({location:a.ProgressLocation.Notification,title:`CodeLens AI: Calculating Git diff (vs HEAD) for ${t}...`,cancellable:!1},(async e=>{let n=0;const i=r.size;for(const[o,d]of r.entries()){n++;const o=c.basename(d.repo.rootUri.fsPath);e.report({message:`Processing repo ${n}/${i}: ${o}`,increment:1/i*100});const h=new Set;let p=!1;for(const e of d.entries){const t=a.Uri.parse(e.uriString),n=c.relative(d.repo.rootUri.fsPath,t.fsPath).replace(/\\/g,"/");if(e.isDirectory&&("."===n||""===n)){p=!0;break}e.isDirectory,h.add(n)}let m="",g=!1;try{let e=p?["."]:Array.from(h).filter((e=>"."!==e));if(0===e.length)continue;if(p){const e=await d.repo.diffWithHEAD();if(0===e.length);else{let n="";for(const r of e)try{const e=r.renameUri||r.uri,t=c.relative(d.repo.rootUri.fsPath,e.fsPath).replace(/\\/g,"/"),i=await d.repo.diffWithHEAD(t);i&&""!==i.trim()&&(i.startsWith("diff --git")?n+=i+"\n\n":n+=`diff --git a/${t} b/${t}\n${i}\n\n`,f++)}catch(e){const n=(r.renameUri||r.uri).toString();console.error(`[CodeLensAI:DiffCalc][${t}] Error getting diff for changed file ${(0,l.getDisplayUri)(n)} in repo ${o}:`,e),s.push(`--- Error diffing changed file: ${(0,l.getDisplayUri)(n)} ---\n${e.message}\n${e.stderr||""}\n`)}m=n.trim()}}else{let n="";for(const r of e)try{const e=await d.repo.diffWithHEAD(r);e&&""!==e.trim()&&(e.startsWith("diff --git")?n+=e+"\n":n+=`diff --git a/${r} b/${r}\n${e}\n`,f++)}catch(e){console.error(`[CodeLensAI:DiffCalc][${t}] Error diffing path ${r} in repo ${o}:`,e),s.push(`--- Error diffing path: ${r} ---\n${e.message}\n${e.stderr||""}\n`)}m=n.trim()}m&&""!==m.trim()&&(!g&&(r.size>1||t.startsWith("session"))&&(u+=`--- Diff for repository: ${o} ---\n\n`,g=!0),u+=m+"\n\n")}catch(e){console.error(`[CodeLensAI:DiffCalc][${t}] Error running git diff for repo ${o}:`,e),!g&&(r.size>1||t.startsWith("session"))&&(u+=`--- Diff for repository: ${o} ---\n\n`);let n=`--- Error diffing in repository: ${o} ---\nError: ${e.message||"Unknown Git error"}\n`;e.stderr&&(n+=`Stderr:\n${e.stderr}\n`),e.gitErrorCode&&(n+=`GitErrorCode: ${e.gitErrorCode}\n`),n+="\n",s.push(n)}}})),console.log(`[CodeLensAI:DiffCalc][${t}] Finished. Diff length: ${u.length}, Skipped: ${i.length}, Diffed Files Count: ${f}, Errors: ${s.length}`),{diffOutput:u.trim(),skippedFiles:i,diffedFilesCount:f,errorMessages:s}}},3735:(e,t,n)=>{var r,i,s=n(9896),o=n(9106),a=n(1995),c=n(1283),l=n(9023);function u(e,t){Object.defineProperty(e,r,{get:function(){return t}})}"function"==typeof Symbol&&"function"==typeof Symbol.for?(r=Symbol.for("graceful-fs.queue"),i=Symbol.for("graceful-fs.previous")):(r="___graceful-fs.queue",i="___graceful-fs.previous");var f,d=function(){};if(l.debuglog?d=l.debuglog("gfs4"):/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&(d=function(){var e=l.format.apply(l,arguments);e="GFS4: "+e.split(/\n/).join("\nGFS4: "),console.error(e)}),!s[r]){var h=global[r]||[];u(s,h),s.close=function(e){function t(t,n){return e.call(s,t,(function(e){e||g(),"function"==typeof n&&n.apply(this,arguments)}))}return Object.defineProperty(t,i,{value:e}),t}(s.close),s.closeSync=function(e){function t(t){e.apply(s,arguments),g()}return Object.defineProperty(t,i,{value:e}),t}(s.closeSync),/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&process.on("exit",(function(){d(s[r]),n(2613).equal(s[r].length,0)}))}function p(e){o(e),e.gracefulify=p,e.createReadStream=function(t,n){return new e.ReadStream(t,n)},e.createWriteStream=function(t,n){return new e.WriteStream(t,n)};var t=e.readFile;e.readFile=function(e,n,r){return"function"==typeof n&&(r=n,n=null),function e(n,r,i,s){return t(n,r,(function(t){!t||"EMFILE"!==t.code&&"ENFILE"!==t.code?"function"==typeof i&&i.apply(this,arguments):m([e,[n,r,i],t,s||Date.now(),Date.now()])}))}(e,n,r)};var n=e.writeFile;e.writeFile=function(e,t,r,i){return"function"==typeof r&&(i=r,r=null),function e(t,r,i,s,o){return n(t,r,i,(function(n){!n||"EMFILE"!==n.code&&"ENFILE"!==n.code?"function"==typeof s&&s.apply(this,arguments):m([e,[t,r,i,s],n,o||Date.now(),Date.now()])}))}(e,t,r,i)};var r=e.appendFile;r&&(e.appendFile=function(e,t,n,i){return"function"==typeof n&&(i=n,n=null),function e(t,n,i,s,o){return r(t,n,i,(function(r){!r||"EMFILE"!==r.code&&"ENFILE"!==r.code?"function"==typeof s&&s.apply(this,arguments):m([e,[t,n,i,s],r,o||Date.now(),Date.now()])}))}(e,t,n,i)});var i=e.copyFile;i&&(e.copyFile=function(e,t,n,r){return"function"==typeof n&&(r=n,n=0),function e(t,n,r,s,o){return i(t,n,r,(function(i){!i||"EMFILE"!==i.code&&"ENFILE"!==i.code?"function"==typeof s&&s.apply(this,arguments):m([e,[t,n,r,s],i,o||Date.now(),Date.now()])}))}(e,t,n,r)});var s=e.readdir;e.readdir=function(e,t,n){"function"==typeof t&&(n=t,t=null);var r=c.test(process.version)?function(e,t,n,r){return s(e,i(e,t,n,r))}:function(e,t,n,r){return s(e,t,i(e,t,n,r))};return r(e,t,n);function i(e,t,n,i){return function(s,o){!s||"EMFILE"!==s.code&&"ENFILE"!==s.code?(o&&o.sort&&o.sort(),"function"==typeof n&&n.call(this,s,o)):m([r,[e,t,n],s,i||Date.now(),Date.now()])}}};var c=/^v[0-5]\./;if("v0.8"===process.version.substr(0,4)){var l=a(e);g=l.ReadStream,w=l.WriteStream}var u=e.ReadStream;u&&(g.prototype=Object.create(u.prototype),g.prototype.open=function(){var e=this;S(e.path,e.flags,e.mode,(function(t,n){t?(e.autoClose&&e.destroy(),e.emit("error",t)):(e.fd=n,e.emit("open",n),e.read())}))});var f=e.WriteStream;f&&(w.prototype=Object.create(f.prototype),w.prototype.open=function(){var e=this;S(e.path,e.flags,e.mode,(function(t,n){t?(e.destroy(),e.emit("error",t)):(e.fd=n,e.emit("open",n))}))}),Object.defineProperty(e,"ReadStream",{get:function(){return g},set:function(e){g=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"WriteStream",{get:function(){return w},set:function(e){w=e},enumerable:!0,configurable:!0});var d=g;Object.defineProperty(e,"FileReadStream",{get:function(){return d},set:function(e){d=e},enumerable:!0,configurable:!0});var h=w;function g(e,t){return this instanceof g?(u.apply(this,arguments),this):g.apply(Object.create(g.prototype),arguments)}function w(e,t){return this instanceof w?(f.apply(this,arguments),this):w.apply(Object.create(w.prototype),arguments)}Object.defineProperty(e,"FileWriteStream",{get:function(){return h},set:function(e){h=e},enumerable:!0,configurable:!0});var y=e.open;function S(e,t,n,r){return"function"==typeof n&&(r=n,n=null),function e(t,n,r,i,s){return y(t,n,r,(function(o,a){!o||"EMFILE"!==o.code&&"ENFILE"!==o.code?"function"==typeof i&&i.apply(this,arguments):m([e,[t,n,r,i],o,s||Date.now(),Date.now()])}))}(e,t,n,r)}return e.open=S,e}function m(e){d("ENQUEUE",e[0].name,e[1]),s[r].push(e),w()}function g(){for(var e=Date.now(),t=0;t<s[r].length;++t)s[r][t].length>2&&(s[r][t][3]=e,s[r][t][4]=e);w()}function w(){if(clearTimeout(f),f=void 0,0!==s[r].length){var e=s[r].shift(),t=e[0],n=e[1],i=e[2],o=e[3],a=e[4];if(void 0===o)d("RETRY",t.name,n),t.apply(null,n);else if(Date.now()-o>=6e4){d("TIMEOUT",t.name,n);var c=n.pop();"function"==typeof c&&c.call(null,i)}else{var l=Date.now()-a,u=Math.max(a-o,1);l>=Math.min(1.2*u,100)?(d("RETRY",t.name,n),t.apply(null,n.concat([o]))):s[r].push(e)}void 0===f&&(f=setTimeout(w,0))}}global[r]||u(global,s[r]),e.exports=p(c(s)),process.env.TEST_GRACEFUL_FS_GLOBAL_PATCH&&!s.__patched&&(e.exports=p(s),s.__patched=!0)},3740:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),o=0;o<n.length;o++)"default"!==n[o]&&i(t,e,n[o]);return s(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.HumanRelayViewProvider=void 0;const a=o(n(1398)),c=n(2652);t.HumanRelayViewProvider=class{_extensionUri;_session;static viewType="codelensai.humanRelayView";_view;constructor(e,t){this._extensionUri=e,this._session=t}resolveWebviewView(e,t,n){this._view=e,e.webview.options={enableScripts:!0,localResourceRoots:[a.Uri.joinPath(this._extensionUri,"webview-ui","dist")]},e.webview.html=this._getHtmlForWebview(e.webview),e.webview.onDidReceiveMessage((async e=>{switch(e.type){case"humanRelayResponse":(0,c.handleHumanRelayResponse)({requestId:e.requestId,text:e.text});break;case"humanRelayCancel":(0,c.handleHumanRelayResponse)({requestId:e.requestId,cancelled:!0})}}))}async show(e){this._view&&(this._view.show?.(!0),this._view.webview.postMessage({type:"showHumanRelayDialog",promptText:e}))}_getHtmlForWebview(e){const t=e.asWebviewUri(a.Uri.joinPath(this._extensionUri,"webview-ui","dist","bundle.js"));return`<!DOCTYPE html>\n            <html lang="en">\n            <head>\n                <meta charset="UTF-8">\n                <meta name="viewport" content="width=device-width, initial-scale=1.0">\n                <title>Human Relay</title>\n            </head>\n            <body>\n                <div id="root"></div>\n                <script nonce="${function(){let e="";const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let n=0;n<32;n++)e+=t.charAt(Math.floor(62*Math.random()));return e}()}" src="${t}"><\/script>\n            </body>\n            </html>`}}},3798:(e,t,n)=>{"use strict";const r=n(1236).fromPromise,{makeDir:i,makeDirSync:s}=n(8916),o=r(i);e.exports={mkdirs:o,mkdirsSync:s,mkdirp:o,mkdirpSync:s,ensureDir:o,ensureDirSync:s}},3838:(e,t,n)=>{"use strict";const r=n(6928),i=n(8737),{pathExists:s}=n(9288),o=n(1236).fromPromise;e.exports={symlinkPaths:o((async function(e,t){if(r.isAbsolute(e)){try{await i.lstat(e)}catch(e){throw e.message=e.message.replace("lstat","ensureSymlink"),e}return{toCwd:e,toDst:e}}const n=r.dirname(t),o=r.join(n,e);if(await s(o))return{toCwd:o,toDst:e};try{await i.lstat(e)}catch(e){throw e.message=e.message.replace("lstat","ensureSymlink"),e}return{toCwd:e,toDst:r.relative(n,e)}})),symlinkPathsSync:function(e,t){if(r.isAbsolute(e)){if(!i.existsSync(e))throw new Error("absolute srcpath does not exist");return{toCwd:e,toDst:e}}const n=r.dirname(t),s=r.join(n,e);if(i.existsSync(s))return{toCwd:s,toDst:e};if(!i.existsSync(e))throw new Error("relative srcpath does not exist");return{toCwd:e,toDst:r.relative(n,e)}}}},3843:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseClass=void 0;const n={"[:alnum:]":["\\p{L}\\p{Nl}\\p{Nd}",!0],"[:alpha:]":["\\p{L}\\p{Nl}",!0],"[:ascii:]":["\\x00-\\x7f",!1],"[:blank:]":["\\p{Zs}\\t",!0],"[:cntrl:]":["\\p{Cc}",!0],"[:digit:]":["\\p{Nd}",!0],"[:graph:]":["\\p{Z}\\p{C}",!0,!0],"[:lower:]":["\\p{Ll}",!0],"[:print:]":["\\p{C}",!0],"[:punct:]":["\\p{P}",!0],"[:space:]":["\\p{Z}\\t\\r\\n\\v\\f",!0],"[:upper:]":["\\p{Lu}",!0],"[:word:]":["\\p{L}\\p{Nl}\\p{Nd}\\p{Pc}",!0],"[:xdigit:]":["A-Fa-f0-9",!1]},r=e=>e.replace(/[[\]\\-]/g,"\\$&"),i=e=>e.join("");t.parseClass=(e,t)=>{const s=t;if("["!==e.charAt(s))throw new Error("not in a brace expression");const o=[],a=[];let c=s+1,l=!1,u=!1,f=!1,d=!1,h=s,p="";e:for(;c<e.length;){const t=e.charAt(c);if("!"!==t&&"^"!==t||c!==s+1){if("]"===t&&l&&!f){h=c+1;break}if(l=!0,"\\"!==t||f){if("["===t&&!f)for(const[t,[r,i,l]]of Object.entries(n))if(e.startsWith(t,c)){if(p)return["$.",!1,e.length-s,!0];c+=t.length,l?a.push(r):o.push(r),u=u||i;continue e}f=!1,p?(t>p?o.push(r(p)+"-"+r(t)):t===p&&o.push(r(t)),p="",c++):e.startsWith("-]",c+1)?(o.push(r(t+"-")),c+=2):e.startsWith("-",c+1)?(p=t,c+=2):(o.push(r(t)),c++)}else f=!0,c++}else d=!0,c++}if(h<c)return["",!1,0,!1];if(!o.length&&!a.length)return["$.",!1,e.length-s,!0];if(0===a.length&&1===o.length&&/^\\?.$/.test(o[0])&&!d){return[(m=2===o[0].length?o[0].slice(-1):o[0],m.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")),!1,h-s,!1]}var m;const g="["+(d?"^":"")+i(o)+"]",w="["+(d?"":"^")+i(a)+"]";return[o.length&&a.length?"("+g+"|"+w+")":o.length?g:w,u,h-s,!0]}},3876:(e,t,n)=>{"use strict";const r=n(3735),i=n(6928),s=n(3798).mkdirsSync,o=n(7211).utimesMillisSync,a=n(6462);function c(e,t,n,s){const o=(s.dereference?r.statSync:r.lstatSync)(t);if(o.isDirectory())return function(e,t,n,i,s){return t?f(n,i,s):function(e,t,n,i){return r.mkdirSync(n),f(t,n,i),u(n,e)}(e.mode,n,i,s)}(o,e,t,n,s);if(o.isFile()||o.isCharacterDevice()||o.isBlockDevice())return function(e,t,n,i,s){return t?function(e,t,n,i){if(i.overwrite)return r.unlinkSync(n),l(e,t,n,i);if(i.errorOnExist)throw new Error(`'${n}' already exists`)}(e,n,i,s):l(e,n,i,s)}(o,e,t,n,s);if(o.isSymbolicLink())return function(e,t,n,s){let o=r.readlinkSync(t);if(s.dereference&&(o=i.resolve(process.cwd(),o)),e){let e;try{e=r.readlinkSync(n)}catch(e){if("EINVAL"===e.code||"UNKNOWN"===e.code)return r.symlinkSync(o,n);throw e}if(s.dereference&&(e=i.resolve(process.cwd(),e)),a.isSrcSubdir(o,e))throw new Error(`Cannot copy '${o}' to a subdirectory of itself, '${e}'.`);if(a.isSrcSubdir(e,o))throw new Error(`Cannot overwrite '${e}' with '${o}'.`);return function(e,t){return r.unlinkSync(t),r.symlinkSync(e,t)}(o,n)}return r.symlinkSync(o,n)}(e,t,n,s);if(o.isSocket())throw new Error(`Cannot copy a socket file: ${t}`);if(o.isFIFO())throw new Error(`Cannot copy a FIFO pipe: ${t}`);throw new Error(`Unknown file: ${t}`)}function l(e,t,n,i){return r.copyFileSync(t,n),i.preserveTimestamps&&function(e,t,n){(function(e){return!(128&e)})(e)&&function(e,t){u(e,128|t)}(n,e),function(e,t){const n=r.statSync(e);o(t,n.atime,n.mtime)}(t,n)}(e.mode,t,n),u(n,e.mode)}function u(e,t){return r.chmodSync(e,t)}function f(e,t,n){const i=r.opendirSync(e);try{let r;for(;null!==(r=i.readSync());)d(r.name,e,t,n)}finally{i.closeSync()}}function d(e,t,n,r){const s=i.join(t,e),o=i.join(n,e);if(r.filter&&!r.filter(s,o))return;const{destStat:l}=a.checkPathsSync(s,o,"copy",r);return c(l,s,o,r)}e.exports=function(e,t,n){"function"==typeof n&&(n={filter:n}),(n=n||{}).clobber=!("clobber"in n)||!!n.clobber,n.overwrite="overwrite"in n?!!n.overwrite:n.clobber,n.preserveTimestamps&&"ia32"===process.arch&&process.emitWarning("Using the preserveTimestamps option in 32-bit node is not recommended;\n\n\tsee https://github.com/jprichardson/node-fs-extra/issues/269","Warning","fs-extra-WARN0002");const{srcStat:o,destStat:l}=a.checkPathsSync(e,t,"copy",n);if(a.checkParentPathsSync(e,o,t,"copy"),n.filter&&!n.filter(e,t))return;const u=i.dirname(t);return r.existsSync(u)||s(u),c(l,e,t,n)}},3993:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),o=0;o<n.length;o++)"default"!==n[o]&&i(t,e,n[o]);return s(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.SessionManager=void 0;const a=o(n(1398)),c=n(6976);class l{context;sessions=new Map;static STORAGE_KEY="codeLensAiSessions_v3";constructor(e){this.context=e}createSession(e){const t=e||`Session ${this.sessions.size+1}`,n=new c.Session(t);return this.sessions.set(n.id,n),this.persistSessions(),n}getSession(e){return this.sessions.get(e)}getAllSessions(){return Array.from(this.sessions.values()).sort(((e,t)=>e.name.localeCompare(t.name)))}removeSession(e){const t=this.sessions.get(e);if(t){t.dispose();const n=this.sessions.delete(e);return n&&this.persistSessions(),n}return!1}renameSession(e,t){const n=this.sessions.get(e);return!!n&&(n.name=t,this.persistSessions(),!0)}persistSessions(){try{const e=this.getAllSessions().map((e=>({id:e.id,name:e.name,files:e.storage.files.map((e=>({uri:e.uriString,isDirectory:e.isDirectory,parentUri:e.parentUriString})))})));this.context.workspaceState.update(l.STORAGE_KEY,e)}catch(e){console.error("[CodeLensAI:Persist] Error saving session data:",e),a.window.showErrorMessage("CodeLens AI: Error saving session data.")}}loadSessions(){let e;this.sessions.clear();try{e=this.context.workspaceState.get(l.STORAGE_KEY),e||(e=[]),e.forEach((e=>{if(!e||"string"!=typeof e.id||"string"!=typeof e.name||!Array.isArray(e.files))return void console.warn("[CodeLensAI:Load] Skipping invalid session metadata entry:",e);const t=new c.Session(e.name,e.id),n=e.files.map((n=>{if(!n||"string"!=typeof n.uri||"boolean"!=typeof n.isDirectory)return console.warn(`[CodeLensAI:Load] Skipping invalid persisted file entry in session ${e.id}:`,n),null;try{return a.Uri.parse(n.uri),n.parentUri&&a.Uri.parse(n.parentUri),{uriString:n.uri,isDirectory:n.isDirectory,parentUriString:n.parentUri,content:null,sessionId:t.id}}catch(t){return console.warn(`[CodeLensAI:Load] Skipping entry with invalid URI in session ${e.id}:`,n.uri,t),null}})).filter((e=>null!==e));t.storage.restoreFiles(n),this.sessions.set(t.id,t)}))}catch(e){console.error("[CodeLensAI:Load] Error loading session data:",e),this.sessions.clear(),a.window.showErrorMessage("CodeLens AI: Error loading session data. Sessions may be reset.")}0===this.sessions.size&&this.createSession("Default Session")}dispose(){this.getAllSessions().forEach((e=>e.dispose())),this.sessions.clear()}}t.SessionManager=l},4083:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),o=0;o<n.length;o++)"default"!==n[o]&&i(t,e,n[o]);return s(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.CodeLensAiProvider=void 0;const a=o(n(1398)),c=o(n(6928)),l=n(172),u=n(6185);t.CodeLensAiProvider=class{sessionManager;_onDidChangeTreeData=new a.EventEmitter;onDidChangeTreeData=this._onDidChangeTreeData.event;dropMimeTypes=["text/uri-list","application/vnd.code.tree.codeLensAiView"];dragMimeTypes=["application/vnd.code.tree.codeLensAiView"];customMimeType="application/vnd.code.tree.codeLensAiView";constructor(e){this.sessionManager=e}getTreeItem(e){return e}getParent(e){if(e instanceof l.ResourceItem){const t=this.sessionManager.getSession(e.sessionId);if(!t)return;if(e.entry.parentUriString){const n=t.storage.findEntry(e.entry.parentUriString);if(n)return new l.ResourceItem(n,n.isDirectory?a.TreeItemCollapsibleState.Collapsed:a.TreeItemCollapsibleState.None)}return new l.SessionItem(t,t.storage.files.length>0?a.TreeItemCollapsibleState.Collapsed:a.TreeItemCollapsibleState.None)}l.SessionItem}getChildren(e){if(!e)return Promise.resolve(this.sessionManager.getAllSessions().map((e=>new l.SessionItem(e,e.storage.files.length>0?a.TreeItemCollapsibleState.Collapsed:a.TreeItemCollapsibleState.None))));if(e instanceof l.SessionItem){const t=this.sessionManager.getSession(e.session.id);if(!t)return[];const n=t.storage.files.filter((e=>!e.parentUriString));return Promise.resolve(n.map((e=>new l.ResourceItem(e,e.isDirectory?a.TreeItemCollapsibleState.Collapsed:a.TreeItemCollapsibleState.None))))}if(e instanceof l.ResourceItem&&e.isDirectory){const t=this.sessionManager.getSession(e.sessionId);if(!t)return[];const n=t.storage.files.filter((t=>t.parentUriString===e.uriString));return Promise.resolve(n.map((e=>new l.ResourceItem(e,e.isDirectory?a.TreeItemCollapsibleState.Collapsed:a.TreeItemCollapsibleState.None))))}return Promise.resolve([])}refresh(e){this._onDidChangeTreeData.fire(e)}findTreeItem(e,t){const n=this.sessionManager.getSession(t);if(!n)return;const r=n.storage.findEntry(e);if(r){const e=r.isDirectory?a.TreeItemCollapsibleState.Collapsed:a.TreeItemCollapsibleState.None;return new l.ResourceItem(r,e)}return n.id!==t||e?void 0:new l.SessionItem(n,n.storage.files.length>0?a.TreeItemCollapsibleState.Collapsed:a.TreeItemCollapsibleState.None)}handleDrag(e,t,n){const r=e.filter((e=>e instanceof l.ResourceItem));if(r.length>0){const e=r.map((e=>`${e.sessionId}::${e.uriString}`));t.set(this.customMimeType,new a.DataTransferItem(e))}}async handleDrop(e,t,n){const r=t.get(this.customMimeType),i=t.get("text/uri-list");if(!n.isCancellationRequested)if(r){const t=r.value;if(!Array.isArray(t)||0===t.length)return;const n=t[0].split("::");if(n.length<2)return void console.warn("[CodeLensAI:handleDrop] Invalid dragged item ID format.");const i=n[0],s=t.map((e=>e.substring(e.indexOf("::")+2))).filter(Boolean),o=this.sessionManager.getSession(i);if(!o)return void console.error(`[CodeLensAI:handleDrop] Session not found for internal drop: ${i}`);let c,f,d=!1;if(e instanceof l.SessionItem){if(e.session.id!==i)return void a.window.showErrorMessage("CodeLens AI: Cannot move items between sessions yet.");d=!0,f=void 0}else{if(!(e instanceof l.ResourceItem))return;if(e.sessionId!==i)return void a.window.showErrorMessage("CodeLens AI: Cannot move items between sessions yet.");c=e.uriString,f=e.entry.parentUriString}const h=o.storage.findEntry(s[0]);if(!h)return;const p=h.parentUriString;if(!d&&p!==f)return void a.window.showWarningMessage("CodeLens AI: Cannot move items between different directory levels yet.");o.storage.reorderItems(s,c,d)?(this.sessionManager.persistSessions(),await(0,u.updateCodeBlockDocument)(o),this.refresh()):this.refresh()}else if(i){let t;if(e instanceof l.SessionItem)t=e.session;else if(e instanceof l.ResourceItem)t=this.sessionManager.getSession(e.sessionId);else{const e=this.sessionManager.getAllSessions();if(t=e[0],t&&e.length>1)a.window.showInformationMessage(`CodeLens AI: Added resources to the first session: "${t.name}"`);else if(!t)return void a.window.showErrorMessage("CodeLens AI: Cannot add resources: No sessions exist.")}if(!t)return void a.window.showErrorMessage("CodeLens AI: Could not determine target session for drop.");const n=(await i.asString()).split("\n").map((e=>e.trim())).filter(Boolean);if(0===n.length)return;let r=!1,s=0;const o=[];await a.window.withProgress({location:a.ProgressLocation.Notification,title:`CodeLens AI: Adding to session "${t.name}"...`,cancellable:!0},(async(e,i)=>{i.onCancellationRequested((()=>{}));for(let l=0;l<n.length&&!i.isCancellationRequested;l++){const i=n[l];let f;try{f=a.Uri.parse(i,!0);const d="file"===f.scheme?f.fsPath:i;if("file"===f.scheme&&(0,u.isPathExcluded)(d)){o.push(c.basename(d)),s++;continue}e.report({message:`(${l+1}/${n.length}) Adding ${(0,u.getDisplayUri)(i,"treeDescription")}`,increment:1/n.length*100}),await t.storage.addResource(f)?r=!0:"file"!==f.scheme||(0,u.isPathExcluded)(d)}catch(e){const t=f?.toString()??i;a.window.showErrorMessage(`CodeLens AI: Error processing ${(0,u.getDisplayUri)(t)}: ${e.message}`),console.error(`[CodeLensAI:handleDrop] Error processing URI ${t}:`,e),s++}}})),r&&(this.sessionManager.persistSessions(),await(0,u.updateCodeBlockDocument)(t));let f="";r&&o.length>0?f=`Added items. Skipped ${o.length} due to exclusion rules: ${o.slice(0,3).join(", ")}${o.length>3?"...":""}`:r&&s>0?f=`Added items. ${s} other item(s) were skipped (duplicates, errors).`:!r&&o.length>0?f=`No new items added. Skipped ${o.length} due to exclusion rules: ${o.slice(0,3).join(", ")}${o.length>3?"...":""}`:!r&&s>0&&(f=`No new items added. ${s} item(s) were skipped (duplicates, errors).`),f&&a.window.showInformationMessage(f),this.refresh()}}}},4116:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unescape=void 0,t.unescape=(e,{windowsPathsNoEscape:t=!1}={})=>t?e.replace(/\[([^\/\\])\]/g,"$1"):e.replace(/((?!\\).|^)\[([^\/\\])\]/g,"$1$2").replace(/\\([^\/])/g,"$1")},4265:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),o=0;o<n.length;o++)"default"!==n[o]&&i(t,e,n[o]);return s(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.activate=async function(e){console.log("Activating CodeLens AI...");try{const e=a.extensions.getExtension("vscode.git");e?(e.isActive||await e.activate(),b=e.exports.getAPI(1),b?console.log("CodeLens AI: Successfully obtained Git API."):(console.error("CodeLens AI: Failed to get Git API from vscode.git extension."),a.window.showWarningMessage("CodeLens AI: Could not initialize Git features. Git API unavailable."))):(console.warn("CodeLens AI: vscode.git extension not found."),a.window.showWarningMessage("CodeLens AI: vscode.git extension not installed or disabled. Git features unavailable."))}catch(e){console.error("CodeLens AI: Failed to get/activate Git API:",e),a.window.showWarningMessage("CodeLens AI: Could not initialize Git features due to an error.")}w=new l.SessionManager(e),y=new g.ProfileManager(e),w.loadSessions(),S=new f.CodeLensAiProvider(w),v=a.window.createTreeView("codeLensAiView",{treeDataProvider:S,dragAndDropController:S,canSelectMany:!0}),e.subscriptions.push(v),function(e){const t=(t,n)=>{e.subscriptions.push(a.commands.registerCommand(t,n))};t("codelensai.addSession",(async()=>{const e=await a.window.showInputBox({prompt:"Enter new session name",value:`Session ${w.getAllSessions().length+1}`});if(e?.trim()){const t=w.createSession(e.trim());S.refresh(),await v.reveal(new u.SessionItem(t),{select:!0,focus:!0,expand:!0})}})),t("codelensai.humanRelay",(async t=>{const n=t?.session??await(0,d.selectSession)("Select session for Human Relay",w);if(!n)return;const r=await y.getProfiles(),i=r.map((e=>e.name)),s=await a.window.showQuickPick(["None",...i],{placeHolder:"Select a profile to use"});let o="";if(s&&"None"!==s){const e=r.find((e=>e.name===s));e&&(o=e.instructions)}const c=new m.HumanRelayViewProvider(e.extensionUri,n),l=a.window.registerWebviewViewProvider(m.HumanRelayViewProvider.viewType,c);e.subscriptions.push(l);const u=new p.HumanRelayHandler;try{const e=await a.window.showInputBox({prompt:"Enter the prompt for the AI"});if(e){const t=`${o}\n\n${e}`;await u.completePrompt(t).then((e=>{e&&a.commands.executeCommand("workbench.view.extension.codelens-ai-activitybar").then((()=>{c.show(t)}))}))}}catch(e){a.window.showErrorMessage(`Human Relay Error: ${e}`)}})),t("codelensai.addProfile",(async()=>{const e=await a.window.showInputBox({prompt:"Enter profile name"});if(e){const t=await a.window.showInputBox({prompt:"Enter instructions"});t&&(await y.addProfile({name:e,instructions:t}),a.window.showInformationMessage(`Profile "${e}" added.`))}})),t("codelensai.removeProfile",(async()=>{const e=(await y.getProfiles()).map((e=>e.name)),t=await a.window.showQuickPick(e,{placeHolder:"Select a profile to remove"});t&&(await y.removeProfile(t),a.window.showInformationMessage(`Profile "${t}" removed.`))})),t("codelensai.editProfile",(async()=>{const e=await y.getProfiles(),t=e.map((e=>e.name)),n=await a.window.showQuickPick(t,{placeHolder:"Select a profile to edit"});if(n){const t=e.find((e=>e.name===n));if(t){const e=await a.window.showInputBox({prompt:"Enter new profile name",value:t.name});if(e){const r=await a.window.showInputBox({prompt:"Enter new instructions",value:t.instructions});r&&(await y.updateProfile(n,{name:e,instructions:r}),a.window.showInformationMessage(`Profile "${n}" updated.`))}}}})),t("codelensai.removeSession",(async e=>{const t=e?.session??await(0,d.selectSession)("Select session to remove",w);t&&"Yes"===await a.window.showWarningMessage(`Remove session "${t.name}" and close its associated document (if open)?`,{modal:!0},"Yes")&&(await t.closeAssociatedDocument(!0),w.removeSession(t.id)&&S.refresh())})),t("codelensai.renameSession",(async e=>{const t=e?.session??await(0,d.selectSession)("Select session to rename",w);if(!t)return;const n=await a.window.showInputBox({prompt:`Enter new name for "${t.name}"`,value:t.name});n?.trim()&&n.trim()!==t.name&&w.renameSession(t.id,n.trim())&&S.refresh()})),t("codelensai.clearSession",(async e=>{const t=e?.session??await(0,d.selectSession)("Select session to clear",w);if(!t)return;if(0===t.storage.files.length)return void a.window.showInformationMessage(`Session "${t.name}" is already empty.`);const n=t.storage.clearFiles();w.persistSessions(),S.refresh(),await(0,d.updateCodeBlockDocument)(t),a.window.showInformationMessage(`Cleared ${n} items from session "${t.name}".`)})),t("codelensai.generateCodeBlock",(async e=>{const t=e?.session??await(0,d.selectSession)("Select session to generate code block for",w);if(!t)return;if(0===t.storage.files.length)return void a.window.showInformationMessage(`Session "${t.name}" is empty.`);const n=await(0,d.showCodeBlockDocument)(t);n&&await a.window.showTextDocument(n,{preview:!1,preserveFocus:!1})})),t("codelensai.copyToClipboard",(async e=>{const t=e?.session??await(0,d.selectSession)("Select session to copy content from",w);if(!t)return;if(0===t.storage.resourcesOnly.length)return void a.window.showInformationMessage(`Session "${t.name}" contains no file/resource content to copy.`);let n="";n=t.associatedDocument&&!t.associatedDocument.isClosed?t.associatedDocument.getText():await(0,d.generateMarkdownContent)(t),n&&!n.startsWith("\x3c!-- No file/resource content")?(await a.env.clipboard.writeText(n),a.window.showInformationMessage(`Session "${t.name}" Code Block content copied!`)):a.window.showWarningMessage("No code block content generated or found to copy.")})),t("codelensai.generateDirectoryCodeBlock",(async e=>{if(!(e instanceof u.ResourceItem&&e.isDirectory))return;const t=w.getSession(e.sessionId);if(!t)return;const n=c.basename(e.resourceUri?.fsPath||"directory"),r=(0,d.getDescendantEntries)(t,e.uriString).filter((e=>!e.isDirectory));if(0===r.length)return void a.window.showInformationMessage(`Directory "${n}" contains no file content within the session.`);const i=await(0,d.generateMarkdownContentForEntries)(r,`Content for Directory: ${n}`),s=await a.workspace.openTextDocument({content:i,language:"markdown"});await a.window.showTextDocument(s,{preview:!1})})),t("codelensai.copyDirectoryContentToClipboard",(async e=>{if(!(e instanceof u.ResourceItem&&e.isDirectory))return;const t=w.getSession(e.sessionId);if(!t)return;const n=c.basename(e.resourceUri?.fsPath||"directory"),r=(0,d.getDescendantEntries)(t,e.uriString).filter((e=>!e.isDirectory));if(0===r.length)return void a.window.showInformationMessage(`Directory "${n}" contains no file content to copy.`);const i=await(0,d.generateMarkdownContentForEntries)(r,`Content for Directory: ${n}`);await a.env.clipboard.writeText(i),a.window.showInformationMessage(`Content for directory "${n}" copied!`)})),t("codelensai.removeItem",(async e=>{if(!(e instanceof u.ResourceItem))return;const t=w.getSession(e.sessionId);t&&t.storage.removeEntry(e.uriString)?(w.persistSessions(),await(0,d.updateCodeBlockDocument)(t),S.refresh(),a.window.showInformationMessage(`Removed "${(0,d.getDisplayUri)(e.uriString,"treeDescription")}". You can undo this by clicking 'Undo Last Removal' in the tree view.`)):S.refresh()})),t("codelensai.refreshView",(()=>S.refresh())),t("codelensai.undoLastRemoval",(async e=>{const t=e?.session??await(0,d.selectSession)("Select session to undo last removal for",w);if(!t)return;if(!t.storage.hasLastRemovedFiles())return void a.window.showInformationMessage(`No recent removals to undo for session "${t.name}".`);const n=t.storage.undoLastRemoval();if(n&&n.length>0){w.persistSessions(),await(0,d.updateCodeBlockDocument)(t),S.refresh(),a.window.showInformationMessage(`Successfully restored ${n.length} item(s) to session "${t.name}".`);try{if(n.length>0){const e=S.findTreeItem(n[0].uriString,t.id);e&&await v.reveal(e,{select:!0,focus:!1,expand:!0})}}catch(e){}}else a.window.showWarningMessage(`Failed to undo last removal for session "${t.name}".`)})),t("codelensai.addActiveEditorToSession",(async e=>{const t=e?.session??await(0,d.selectSession)("Select session to add active editor to",w);t&&await async function(e){const t=a.window.activeTextEditor;if(!t)return void a.window.showInformationMessage("No active editor found.");const{uri:n}=t.document,r=n.toString();if(t.document===e.associatedDocument)return void a.window.showInformationMessage("Cannot add the session's own generated document to itself.");if(e.storage.findEntry(r))return void a.window.showInformationMessage(`"${(0,d.getDisplayUri)(r,"treeDescription")}" is already in session "${e.name}".`);const i={uriString:r,isDirectory:!1,content:null,sessionId:e.id};e.storage.addItem(i)?(w.persistSessions(),await(0,d.updateCodeBlockDocument)(e),S.refresh(),a.window.showInformationMessage(`Added "${(0,d.getDisplayUri)(r,"treeDescription")}" to session "${e.name}".`)):a.window.showWarningMessage(`Failed to add "${(0,d.getDisplayUri)(r)}". It might already exist.`)}(t)})),t("codelensai.addAllOpenEditorsToSession",(async e=>{const t=e?.session??await(0,d.selectSession)("Select session to add all open editors to",w);t&&await async function(e){const t=new Set,n=e.associatedDocument?.uri.toString();if(a.window.tabGroups.all.forEach((e=>{e.tabs.forEach((e=>{const r=e.input?.uri;if(r instanceof a.Uri){const e=r.toString();e!==n&&t.add(e)}}))})),0===t.size)return void a.window.showInformationMessage("No other unique open editors found to add.");let r=0,i=0;if(t.forEach((t=>{if(e.storage.findEntry(t))i++;else{const n={uriString:t,isDirectory:!1,content:null,sessionId:e.id};e.storage.addItem(n)?r++:i++}})),r>0){w.persistSessions(),await(0,d.updateCodeBlockDocument)(e),S.refresh();let t=`Added ${r} editor(s) to "${e.name}".`;i>0&&(t+=` Skipped ${i} (already present or session document).`),a.window.showInformationMessage(t)}else i>0?a.window.showInformationMessage(`All open editors were already present in session "${e.name}" or represent the session document.`):a.window.showInformationMessage("No new editors were added.")}(t)})),t("codelensai.copyDirectoryStructure",(async e=>{let t,n,r=[],i="";if(e instanceof u.SessionItem)t=e.session,r=t.storage.files.filter((e=>!e.parentUriString)),n=void 0,i=`session "${t.name}"`;else{if(!(e instanceof u.ResourceItem&&e.isDirectory))return e instanceof u.ResourceItem&&!e.isDirectory?void a.window.showInformationMessage("Cannot copy structure of a single file."):void a.window.showWarningMessage("Please right-click on a Session or Directory item to copy its structure.");if(t=w.getSession(e.sessionId),!t)return;r=t.storage.files.filter((t=>t.parentUriString===e.uriString)),n=e.uriString,i=`directory "${c.basename(e.resourceUri?.fsPath||"directory")}"`}if(!t)return void a.window.showErrorMessage("CodeLens AI: Could not find the session for the selected item.");const s=n?t.storage.findEntry(n):null;if(!s&&n)return void a.window.showErrorMessage("CodeLens AI: Could not find the starting directory entry.");const o=a.workspace.getConfiguration("codelensai").get("excludeFromTree")||{},l=e=>(0,d.isPathExcludedFromTree)(e,o);try{let e="";s?(e+=`${c.basename(a.Uri.parse(s.uriString).fsPath||s.uriString)}\n`,e+=(0,d.buildStructureStringRecursive)(r,t,"  ",1,s.uriString,l)):e+=(0,d.buildStructureStringRecursive)(r,t,"",0,void 0,l),""===e.trim()&&s?e=`${c.basename(a.Uri.parse(s.uriString).fsPath||s.uriString)}\n(Directory is empty or all contents excluded)`:""===e.trim()&&(e="(Session is empty or all contents excluded)"),await a.env.clipboard.writeText(e.trimEnd()),a.window.showInformationMessage(`Directory structure for ${i} copied to clipboard!`)}catch(e){console.error(`[CodeLensAI:CopyStructure] Error building structure for ${i}:`,e),a.window.showErrorMessage(`CodeLens AI: Failed to copy structure: ${e.message}`)}}));const n=async(e,t)=>{if(!b)return void a.window.showErrorMessage("CodeLens AI: Git integration is not available.");let n,r=[],i="";if(e instanceof u.SessionItem)n=e.session,r=[...n.storage.files],i=`session "${n.name}"`;else if(e instanceof u.ResourceItem){if(n=w.getSession(e.sessionId),!n)return;const t=c.basename(e.resourceUri?.fsPath||e.uriString);e.isDirectory?(r=(0,d.getDescendantEntries)(n,e.uriString),i=`directory "${t}"`):(r=[e.entry],i=`file "${t}"`)}else{if(n=await(0,d.selectSession)(`Select session to ${t?"copy":"generate"} Git diff for`,w),!n)return;r=[...n.storage.files],i=`session "${n.name}"`}if(!n)return void a.window.showErrorMessage("CodeLens AI: Could not determine session for Git Diff.");if(0===r.length)return void a.window.showInformationMessage(`No items found in ${i} to diff.`);const s=r.filter((e=>{try{return"file"===a.Uri.parse(e.uriString).scheme}catch{return!1}}));0!==s.length?await(0,h.generateDiffCommon)(s,i,(e=>a.window.showInformationMessage(e)),t,b):a.window.showInformationMessage(`No file system items found in ${i} to diff with Git.`)};t("codelensai.generateDiffDocument",(e=>n(e,!1))),t("codelensai.copyDiffToClipboard",(e=>n(e,!0))),t("codelensai.generateDirectoryDiffDocument",(e=>n(e,!1))),t("codelensai.copyDirectoryDiffToClipboard",(e=>n(e,!0))),t("codelensai.generateFileDiffDocument",(e=>n(e,!1))),t("codelensai.copyFileDiffToClipboard",(e=>n(e,!0))),t("codelensai.expandAllSubdirectories",(async e=>{const t=e?.session??await(0,d.selectSession)("Select session to expand all subdirectories for",w);if(!t)return;const n=t.storage.files.filter((e=>e.isDirectory));if(0!==n.length)try{for(const e of n){const n=S.findTreeItem(e.uriString,t.id);n&&await v.reveal(n,{expand:3})}a.window.showInformationMessage(`Expanded all directories in session "${t.name}".`)}catch(e){a.window.showWarningMessage(`Some directories could not be expanded in session "${t.name}".`)}else a.window.showInformationMessage(`No directories found in session "${t.name}".`)}))}(e),e.subscriptions.push({dispose:()=>w.dispose()}),console.log("CodeLens AI activated.")},t.deactivate=function(){console.log("Deactivating CodeLens AI..."),b=void 0};const a=o(n(1398)),c=o(n(6928)),l=n(3993),u=n(172),f=n(4083),d=n(6185),h=n(3628),p=n(2652),m=n(3740),g=n(8736);let w,y,S,v,b},4423:(e,t,n)=>{"use strict";const r=n(1236).fromPromise;e.exports={copy:r(n(4994)),copySync:n(3876)}},4994:(e,t,n)=>{"use strict";const r=n(8737),i=n(6928),{mkdirs:s}=n(3798),{pathExists:o}=n(9288),{utimesMillis:a}=n(7211),c=n(6462);async function l(e,t,n){return!n.filter||n.filter(e,t)}async function u(e,t,n,s){const o=s.dereference?r.stat:r.lstat,a=await o(t);if(a.isDirectory())return async function(e,t,n,s,o){t||await r.mkdir(s);const a=[];for await(const e of await r.opendir(n)){const t=i.join(n,e.name),r=i.join(s,e.name);a.push(l(t,r,o).then((e=>{if(e)return c.checkPaths(t,r,"copy",o).then((({destStat:e})=>u(e,t,r,o)))})))}await Promise.all(a),t||await r.chmod(s,e.mode)}(a,e,t,n,s);if(a.isFile()||a.isCharacterDevice()||a.isBlockDevice())return async function(e,t,n,i,s){if(!t)return f(e,n,i,s);if(s.overwrite)return await r.unlink(i),f(e,n,i,s);if(s.errorOnExist)throw new Error(`'${i}' already exists`)}(a,e,t,n,s);if(a.isSymbolicLink())return async function(e,t,n,s){let o=await r.readlink(t);if(s.dereference&&(o=i.resolve(process.cwd(),o)),!e)return r.symlink(o,n);let a=null;try{a=await r.readlink(n)}catch(e){if("EINVAL"===e.code||"UNKNOWN"===e.code)return r.symlink(o,n);throw e}if(s.dereference&&(a=i.resolve(process.cwd(),a)),c.isSrcSubdir(o,a))throw new Error(`Cannot copy '${o}' to a subdirectory of itself, '${a}'.`);if(c.isSrcSubdir(a,o))throw new Error(`Cannot overwrite '${a}' with '${o}'.`);return await r.unlink(n),r.symlink(o,n)}(e,t,n,s);if(a.isSocket())throw new Error(`Cannot copy a socket file: ${t}`);if(a.isFIFO())throw new Error(`Cannot copy a FIFO pipe: ${t}`);throw new Error(`Unknown file: ${t}`)}async function f(e,t,n,i){if(await r.copyFile(t,n),i.preserveTimestamps){128&e.mode||await function(e,t){return r.chmod(e,128|t)}(n,e.mode);const i=await r.stat(t);await a(n,i.atime,i.mtime)}return r.chmod(n,e.mode)}e.exports=async function(e,t,n={}){"function"==typeof n&&(n={filter:n}),n.clobber=!("clobber"in n)||!!n.clobber,n.overwrite="overwrite"in n?!!n.overwrite:n.clobber,n.preserveTimestamps&&"ia32"===process.arch&&process.emitWarning("Using the preserveTimestamps option in 32-bit node is not recommended;\n\n\tsee https://github.com/jprichardson/node-fs-extra/issues/269","Warning","fs-extra-WARN0001");const{srcStat:r,destStat:a}=await c.checkPaths(e,t,"copy",n);if(await c.checkParentPaths(e,r,t,"copy"),!await l(e,t,n))return;const f=i.dirname(t);await o(f)||await s(f),await u(a,e,t,n)}},5291:(e,t,n)=>{"use strict";const r=n(1236).fromPromise,i=n(6928),s=n(8737),{mkdirs:o,mkdirsSync:a}=n(3798),{symlinkPaths:c,symlinkPathsSync:l}=n(3838),{symlinkType:u,symlinkTypeSync:f}=n(7064),{pathExists:d}=n(9288),{areIdentical:h}=n(6462);e.exports={createSymlink:r((async function(e,t,n){let r;try{r=await s.lstat(t)}catch{}if(r&&r.isSymbolicLink()){const[n,r]=await Promise.all([s.stat(e),s.stat(t)]);if(h(n,r))return}const a=await c(e,t);e=a.toDst;const l=await u(a.toCwd,n),f=i.dirname(t);return await d(f)||await o(f),s.symlink(e,t,l)})),createSymlinkSync:function(e,t,n){let r;try{r=s.lstatSync(t)}catch{}if(r&&r.isSymbolicLink()){const n=s.statSync(e),r=s.statSync(t);if(h(n,r))return}const o=l(e,t);e=o.toDst,n=f(o.toCwd,n);const c=i.dirname(t);return s.existsSync(c)||a(c),s.symlinkSync(e,t,n)}}},5422:(e,t,n)=>{"use strict";const r=n(3735),i=n(1236).fromCallback;e.exports={remove:i((function(e,t){r.rm(e,{recursive:!0,force:!0},t)})),removeSync:function(e){r.rmSync(e,{recursive:!0,force:!0})}}},6185:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),o=0;o<n.length;o++)"default"!==n[o]&&i(t,e,n[o]);return s(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.isPathExcluded=function(e){const t=a.workspace.getConfiguration("codelensai").get("exclude");if(!t||0===Object.keys(t).length)return!1;const n=e.replace(/\\/g,"/"),r=a.workspace.workspaceFolders,i={dot:!0,nocase:"win32"===process.platform};for(const e in t)if(!0===t[e]){const t=e.replace(/\\/g,"/");if((0,l.minimatch)(n,t,i))return!0;if(r)for(const e of r){const r=e.uri.fsPath.replace(/\\/g,"/");if(n.startsWith(r+"/")){const e=n.substring(r.length+1);if((0,l.minimatch)(e,t,i))return!0}}if(!t.includes("/")&&(0,l.minimatch)(c.basename(n),t,i))return!0}return!1},t.isPathExcludedFromTree=function(e,t){if(!t||0===Object.keys(t).length)return!1;const n=e.replace(/\\/g,"/"),r={dot:!0,nocase:"win32"===process.platform};for(const e in t)if(!0===t[e]){const t=e.replace(/\\/g,"/");if((0,l.minimatch)(n,t,r))return!0}return!1},t.selectSession=async function(e,t){const n=t.getAllSessions();if(0===n.length)return void a.window.showErrorMessage("CodeLens AI: No sessions available.");if(1===n.length)return n[0];const r=n.map((e=>({label:e.name,description:`(${e.storage.files.length} items)`,session:e}))),i=await a.window.showQuickPick(r,{placeHolder:e,canPickMany:!1});return i?.session},t.generateMarkdownContentForEntries=f,t.generateMarkdownContent=d,t.showCodeBlockDocument=async function(e){const t=await d(e);if(e.associatedDocument&&!e.associatedDocument.isClosed){const n=e.associatedDocument;try{const e=new a.WorkspaceEdit;if(e.replace(n.uri,new a.Range(0,0,n.lineCount,0),t),!await a.workspace.applyEdit(e))throw new Error("ApplyEdit failed to update document");return n}catch(r){return console.error(`[CodeLensAI:ShowDoc] Error updating associated doc ${n.uri}:`,r),await e.closeAssociatedDocument(!1),h(e,t)}}return h(e,t)},t.createNewAssociatedDocument=h,t.updateCodeBlockDocument=async function(e){if(e.associatedDocument&&!e.associatedDocument.isClosed){const t=e.associatedDocument,n=await d(e);try{const r=new a.WorkspaceEdit;r.replace(t.uri,new a.Range(0,0,t.lineCount,0),n),await a.workspace.applyEdit(r)||(console.warn(`[CodeLensAI:UpdateDoc] ApplyEdit failed silently for ${t.uri}. Detaching link.`),e.closeAssociatedDocument(!1))}catch(n){console.error(`[CodeLensAI:UpdateDoc] Error applying edit to ${t.uri}:`,n),e.closeAssociatedDocument(!1),a.window.showErrorMessage("CodeLens AI: Error updating the associated code block document.")}}},t.getDisplayUri=p,t.getDisplayPath=m,t.getDescendantEntries=function(e,t){const n=e.storage.findEntry(t);if(!n)return[];if(!n.isDirectory)return[n];const r=[n],i=[t],s=new Set([t]);for(;i.length>0;){const t=i.shift();for(const n of e.storage.files)n.parentUriString!==t||s.has(n.uriString)||(r.push(n),s.add(n.uriString),n.isDirectory&&i.push(n.uriString))}return r},t.buildStructureStringRecursive=function e(t,n,r,i,s,o){let l="";const u=[...t].sort(((e,t)=>{if(e.isDirectory!==t.isDirectory)return e.isDirectory?-1:1;const n=c.basename(a.Uri.parse(e.uriString).path),r=c.basename(a.Uri.parse(t.uriString).path);return n.localeCompare(r)}));return u.forEach(((t,f)=>{const d=f===u.length-1,h=d?"└── ":"├── ",p=a.Uri.parse(t.uriString),g=c.basename(p.path);let w="";try{if(s){const e=a.Uri.parse(s);if("file"===p.scheme&&"file"===e.scheme)w=c.relative(e.fsPath,p.fsPath).replace(/\\/g,"/");else{const t=e.path.split("/").filter(Boolean),n=p.path.split("/").filter(Boolean);let r=0;for(;r<t.length&&r<n.length&&t[r]===n[r];)r++;w=n.slice(r).join("/")}}else w=m(p.fsPath||p.path,!1);""===w&&t.uriString!==s&&(w=g)}catch(e){w=g}if(!o(w)&&(l+=`${r}${h}${g}\n`,t.isDirectory)){const a=n.storage.files.filter((e=>e.parentUriString===t.uriString));l+=e(a,n,r+(d?"    ":"│   "),i+1,s,o)}})),l};const a=o(n(1398)),c=o(n(6928)),l=n(8722);function u(e){const t=e.split("\n"),n=String(t.length).length;return t.map(((e,t)=>`${String(t+1).padStart(n," ")} | ${e}`)).join("\n")}async function f(e,t){let n=t?`\x3c!-- ${t} --\x3e\n\n`:"";const r=e.filter((e=>!e.isDirectory));if(0===r.length)return t?`\x3c!-- ${t} --\x3e\n\x3c!-- No file/resource content found for the given entries. --\x3e\n`:"\x3c!-- No file/resource content found for the given entries. --\x3e\n";for(const e of r){let t=e.content;if(null===t)try{const n=a.Uri.parse(e.uriString);t=(await a.workspace.openTextDocument(n)).getText()}catch(n){console.error(`[CodeLensAI:MarkdownGenEntries] Error reading URI ${e.uriString}:`,n);const r=p(e.uriString);t="FileNotFound"===n?.code||"EntryNotFound"===n?.code||n?.message?.includes("cannot open")||n?.message?.includes("Unable to resolve")?`--- Error: Resource not found or inaccessible (${r}) ---`:`--- Error reading content for ${r}: ${n.message} ---`}const r=p(e.uriString,"markdownHeader"),i=a.Uri.parse(e.uriString).path,s=i.includes("!/")?i.substring(i.lastIndexOf("!/")+1):i,o=c.extname(s);o&&o.substring(1),n+=`<file path="${r}">\n${u(t??"--- Content Unavailable ---\n")}\n</file>\n\n`}return n.trimEnd()}async function d(e){return f(e.storage.files,`Content for Session: ${e.name}`)}async function h(e,t){try{const n=await a.workspace.openTextDocument({content:t,language:"markdown"});return e.setAssociatedDocument(n),n}catch(t){return console.error("[CodeLensAI:ShowDoc] Failed to create associated document:",t),a.window.showErrorMessage(`CodeLens AI: Failed to create associated document: ${t.message}`),void e.closeAssociatedDocument(!1)}}function p(e,t="markdownHeader"){try{const n=a.Uri.parse(e),r=n.scheme,i=(n.path,n.toString().lastIndexOf("!/"));if("jar"!==r&&"zip"!==r&&"file"!==r||-1===i){if("file"===r)return m(n.fsPath,"treeDescription"===t);{let e=n.fsPath||n.path;n.authority&&e.startsWith("/"+n.authority)&&(e=e.substring(n.authority.length+1)),e.startsWith("/")&&(e=e.substring(1));const i=n.authority?`//${n.authority}/`:"",s=`${r}:`,o=`${s}${i}${e}`;return"treeDescription"===t&&o.length>45?o.substring(0,s.length+4)+"..."+o.substring(o.length-(45-s.length-7)):o}}{const e=n.toString();let s=e.substring(0,i),o=e.substring(i+1),l="archive",u=r;try{const e=a.Uri.parse(s);l=c.basename(e.fsPath||e.path),u=e.scheme}catch{l=c.basename(s)}const f=(o.startsWith("/")?o.substring(1):o).replace(/\\/g,"/"),d=`${l}!/${f}`,h="file"!==u&&u!==r?`${u}:`:"";if("treeDescription"===t){return`${h}${l.length>15?l.substring(0,6)+"..."+l.slice(-6):l}!/${f.length>25?"/.../"+f.slice(-22):f}`}return`${h}${d}`}}catch(n){return"treeDescription"===t&&e.length>40?e.substring(0,15)+"..."+e.substring(e.length-22):e}}function m(e,t=!1){const n=a.workspace.workspaceFolders;let r;if(n){const i=[...n].sort(((e,t)=>t.uri.fsPath.length-e.uri.fsPath.length));for(const s of i){const i=s.uri.fsPath,o=c.relative(i,e);if(!o.startsWith("..")&&!c.isAbsolute(o)){r=""===o?c.basename(i):o,r=r.replace(/\\/g,"/"),t&&""!==o&&n.length>1&&(r=`${c.basename(s.name)}/${r}`);break}}}if(r){if(t&&r.length>40){const e=r.split("/");return e.length>2?e[0]+"/.../"+e[e.length-1]:r}return r}{const n=c.sep,r=e.split(n).filter(Boolean),i=r.length;return t&&i>3?`...${n}${r.slice(-2).join(n)}`:!t&&i>5?`...${n}${r.slice(-3).join(n)}`:e}}},6244:(e,t,n)=>{"use strict";const r=n(3735),i=n(6928),s=n(4423).copySync,o=n(5422).removeSync,a=n(3798).mkdirpSync,c=n(6462);function l(e,t,n){try{r.renameSync(e,t)}catch(r){if("EXDEV"!==r.code)throw r;return function(e,t,n){return s(e,t,{overwrite:n,errorOnExist:!0,preserveTimestamps:!0}),o(e)}(e,t,n)}}e.exports=function(e,t,n){const s=(n=n||{}).overwrite||n.clobber||!1,{srcStat:u,isChangingCase:f=!1}=c.checkPathsSync(e,t,"move",n);return c.checkParentPathsSync(e,u,t,"move"),function(e){const t=i.dirname(e);return i.parse(t).root===t}(t)||a(i.dirname(t)),function(e,t,n,i){if(i)return l(e,t,n);if(n)return o(t),l(e,t,n);if(r.existsSync(t))throw new Error("dest already exists.");return l(e,t,n)}(e,t,s,f)}},6288:(e,t,n)=>{"use strict";const{createFile:r,createFileSync:i}=n(9616),{createLink:s,createLinkSync:o}=n(1522),{createSymlink:a,createSymlinkSync:c}=n(5291);e.exports={createFile:r,createFileSync:i,ensureFile:r,ensureFileSync:i,createLink:s,createLinkSync:o,ensureLink:s,ensureLinkSync:o,createSymlink:a,createSymlinkSync:c,ensureSymlink:a,ensureSymlinkSync:c}},6426:(e,t,n)=>{"use strict";const{stringify:r}=n(1144),{outputFile:i}=n(7024);e.exports=async function(e,t,n={}){const s=r(t,n);await i(e,s,n)}},6462:(e,t,n)=>{"use strict";const r=n(8737),i=n(6928),s=n(1236).fromPromise;function o(e,t){return t.ino&&t.dev&&t.ino===e.ino&&t.dev===e.dev}function a(e,t){const n=i.resolve(e).split(i.sep).filter((e=>e)),r=i.resolve(t).split(i.sep).filter((e=>e));return n.every(((e,t)=>r[t]===e))}function c(e,t,n){return`Cannot ${n} '${e}' to a subdirectory of itself, '${t}'.`}e.exports={checkPaths:s((async function(e,t,n,s){const{srcStat:l,destStat:u}=await function(e,t,n){const i=n.dereference?e=>r.stat(e,{bigint:!0}):e=>r.lstat(e,{bigint:!0});return Promise.all([i(e),i(t).catch((e=>{if("ENOENT"===e.code)return null;throw e}))]).then((([e,t])=>({srcStat:e,destStat:t})))}(e,t,s);if(u){if(o(l,u)){const r=i.basename(e),s=i.basename(t);if("move"===n&&r!==s&&r.toLowerCase()===s.toLowerCase())return{srcStat:l,destStat:u,isChangingCase:!0};throw new Error("Source and destination must not be the same.")}if(l.isDirectory()&&!u.isDirectory())throw new Error(`Cannot overwrite non-directory '${t}' with directory '${e}'.`);if(!l.isDirectory()&&u.isDirectory())throw new Error(`Cannot overwrite directory '${t}' with non-directory '${e}'.`)}if(l.isDirectory()&&a(e,t))throw new Error(c(e,t,n));return{srcStat:l,destStat:u}})),checkPathsSync:function(e,t,n,s){const{srcStat:l,destStat:u}=function(e,t,n){let i;const s=n.dereference?e=>r.statSync(e,{bigint:!0}):e=>r.lstatSync(e,{bigint:!0}),o=s(e);try{i=s(t)}catch(e){if("ENOENT"===e.code)return{srcStat:o,destStat:null};throw e}return{srcStat:o,destStat:i}}(e,t,s);if(u){if(o(l,u)){const r=i.basename(e),s=i.basename(t);if("move"===n&&r!==s&&r.toLowerCase()===s.toLowerCase())return{srcStat:l,destStat:u,isChangingCase:!0};throw new Error("Source and destination must not be the same.")}if(l.isDirectory()&&!u.isDirectory())throw new Error(`Cannot overwrite non-directory '${t}' with directory '${e}'.`);if(!l.isDirectory()&&u.isDirectory())throw new Error(`Cannot overwrite directory '${t}' with non-directory '${e}'.`)}if(l.isDirectory()&&a(e,t))throw new Error(c(e,t,n));return{srcStat:l,destStat:u}},checkParentPaths:s((async function e(t,n,s,a){const l=i.resolve(i.dirname(t)),u=i.resolve(i.dirname(s));if(u===l||u===i.parse(u).root)return;let f;try{f=await r.stat(u,{bigint:!0})}catch(e){if("ENOENT"===e.code)return;throw e}if(o(n,f))throw new Error(c(t,s,a));return e(t,n,u,a)})),checkParentPathsSync:function e(t,n,s,a){const l=i.resolve(i.dirname(t)),u=i.resolve(i.dirname(s));if(u===l||u===i.parse(u).root)return;let f;try{f=r.statSync(u,{bigint:!0})}catch(e){if("ENOENT"===e.code)return;throw e}if(o(n,f))throw new Error(c(t,s,a));return e(t,n,u,a)},isSrcSubdir:a,areIdentical:o}},6899:(e,t,n)=>{"use strict";n.r(t),n.d(t,{NIL:()=>D,parse:()=>y,stringify:()=>d,v1:()=>w,v3:()=>v,v4:()=>E,v5:()=>P,validate:()=>l,version:()=>I});const r=require("crypto");var i=n.n(r);const s=new Uint8Array(256);let o=s.length;function a(){return o>s.length-16&&(i().randomFillSync(s),o=0),s.slice(o,o+=16)}const c=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,l=function(e){return"string"==typeof e&&c.test(e)},u=[];for(let e=0;e<256;++e)u.push((e+256).toString(16).slice(1));function f(e,t=0){return u[e[t+0]]+u[e[t+1]]+u[e[t+2]]+u[e[t+3]]+"-"+u[e[t+4]]+u[e[t+5]]+"-"+u[e[t+6]]+u[e[t+7]]+"-"+u[e[t+8]]+u[e[t+9]]+"-"+u[e[t+10]]+u[e[t+11]]+u[e[t+12]]+u[e[t+13]]+u[e[t+14]]+u[e[t+15]]}const d=function(e,t=0){const n=f(e,t);if(!l(n))throw TypeError("Stringified UUID is invalid");return n};let h,p,m=0,g=0;const w=function(e,t,n){let r=t&&n||0;const i=t||new Array(16);let s=(e=e||{}).node||h,o=void 0!==e.clockseq?e.clockseq:p;if(null==s||null==o){const t=e.random||(e.rng||a)();null==s&&(s=h=[1|t[0],t[1],t[2],t[3],t[4],t[5]]),null==o&&(o=p=16383&(t[6]<<8|t[7]))}let c=void 0!==e.msecs?e.msecs:Date.now(),l=void 0!==e.nsecs?e.nsecs:g+1;const u=c-m+(l-g)/1e4;if(u<0&&void 0===e.clockseq&&(o=o+1&16383),(u<0||c>m)&&void 0===e.nsecs&&(l=0),l>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");m=c,g=l,p=o,c+=122192928e5;const d=(1e4*(268435455&c)+l)%4294967296;i[r++]=d>>>24&255,i[r++]=d>>>16&255,i[r++]=d>>>8&255,i[r++]=255&d;const w=c/4294967296*1e4&268435455;i[r++]=w>>>8&255,i[r++]=255&w,i[r++]=w>>>24&15|16,i[r++]=w>>>16&255,i[r++]=o>>>8|128,i[r++]=255&o;for(let e=0;e<6;++e)i[r+e]=s[e];return t||f(i)},y=function(e){if(!l(e))throw TypeError("Invalid UUID");let t;const n=new Uint8Array(16);return n[0]=(t=parseInt(e.slice(0,8),16))>>>24,n[1]=t>>>16&255,n[2]=t>>>8&255,n[3]=255&t,n[4]=(t=parseInt(e.slice(9,13),16))>>>8,n[5]=255&t,n[6]=(t=parseInt(e.slice(14,18),16))>>>8,n[7]=255&t,n[8]=(t=parseInt(e.slice(19,23),16))>>>8,n[9]=255&t,n[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,n[11]=t/4294967296&255,n[12]=t>>>24&255,n[13]=t>>>16&255,n[14]=t>>>8&255,n[15]=255&t,n};function S(e,t,n){function r(e,r,i,s){var o;if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));const t=[];for(let n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t}(e)),"string"==typeof r&&(r=y(r)),16!==(null===(o=r)||void 0===o?void 0:o.length))throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let a=new Uint8Array(16+e.length);if(a.set(r),a.set(e,r.length),a=n(a),a[6]=15&a[6]|t,a[8]=63&a[8]|128,i){s=s||0;for(let e=0;e<16;++e)i[s+e]=a[e];return i}return f(a)}try{r.name=e}catch(e){}return r.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",r.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",r}const v=S("v3",48,(function(e){return Array.isArray(e)?e=Buffer.from(e):"string"==typeof e&&(e=Buffer.from(e,"utf8")),i().createHash("md5").update(e).digest()})),b={randomUUID:i().randomUUID},E=function(e,t,n){if(b.randomUUID&&!t&&!e)return b.randomUUID();const r=(e=e||{}).random||(e.rng||a)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=r[e];return t}return f(r)},P=S("v5",80,(function(e){return Array.isArray(e)?e=Buffer.from(e):"string"==typeof e&&(e=Buffer.from(e,"utf8")),i().createHash("sha1").update(e).digest()})),D="00000000-0000-0000-0000-000000000000",I=function(e){if(!l(e))throw TypeError("Invalid UUID");return parseInt(e.slice(14,15),16)}},6928:e=>{"use strict";e.exports=require("path")},6976:function(e,t,n){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),o=0;o<n.length;o++)"default"!==n[o]&&i(t,e,n[o]);return s(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.Session=t.SessionResourceStorage=void 0;const a=o(n(1398)),c=o(n(6928)),l=o(n(1605)),u=n(6899),f=n(6185);class d{_files=[];sessionId;lastRemovedFiles=[];constructor(e){this.sessionId=e}get files(){return this._files}get resourcesOnly(){return this._files.filter((e=>!e.isDirectory)).map((e=>({uriString:e.uriString,content:e.content})))}findEntry(e){return this._files.find((t=>t.uriString===e))}addItem(e){return!this._files.some((t=>t.uriString===e.uriString))&&(this._files.push(e),!0)}async addResource(e,t){const n=e.toString(),r=t?.toString();if(this._files.some((e=>e.uriString===n)))return!1;if("file"===e.scheme&&(0,f.isPathExcluded)(e.fsPath))return!1;let i=!1,s=null,o=!1;try{if("file"!==e.scheme||e.path.includes("!/"))i=!1,o=!1;else{const t=await l.stat(e.fsPath);if(i=t.isDirectory(),o=i,!i)try{t.size<1048576?s=await l.readFile(e.fsPath,"utf8"):(console.warn(`[CodeLensAI:Storage:addResource] File too large for initial read, load on demand: ${e.fsPath}`),s=null)}catch(t){console.warn(`[CodeLensAI:Storage:addResource] Failed initial read ${e.fsPath}: ${t.message}`),s=null}}}catch(e){return"ENOENT"===e.code?(console.warn(`[CodeLensAI:Storage:addResource] Resource not found: ${n}`),a.window.showWarningMessage(`Item not found: ${(0,f.getDisplayUri)(n)}`)):(console.error(`[CodeLensAI:Storage:addResource] Error processing URI ${n}:`,e),a.window.showErrorMessage(`Error adding ${(0,f.getDisplayUri)(n)}: ${e.message}`)),!1}const u={uriString:n,isDirectory:i,content:s,parentUriString:r,sessionId:this.sessionId};if(this._files.push(u),o&&"file"===e.scheme)try{const t=await l.readdir(e.fsPath,{withFileTypes:!0}),n=[];for(const r of t){const t=c.join(e.fsPath,r.name),i=a.Uri.file(t);(0,f.isPathExcluded)(t)||n.push(this.addResource(i,e))}await Promise.all(n)}catch(t){console.error(`[CodeLensAI:Storage:addResource] Error reading directory ${e.fsPath}:`,t)}return!0}removeEntry(e){const t=this._files.length;if(!this.findEntry(e))return!1;const n=new Set,r=[e];for(;r.length>0;){const e=r.shift();n.has(e)||(n.add(e),this._files.forEach((t=>{t.parentUriString===e&&r.push(t.uriString)})))}return this.lastRemovedFiles=this._files.filter((e=>n.has(e.uriString))),this._files=this._files.filter((e=>!n.has(e.uriString))),this._files.length<t}clearFiles(){const e=this._files.length;return this.lastRemovedFiles=[...this._files],this._files=[],e}restoreFiles(e){this._files=e}reorderItems(e,t,n=!1){const r=[];for(const t of e){const e=this.findEntry(t);if(!e)return console.error(`[CodeLensAI:Storage:reorder] Dragged entry not found: ${t}`),!1;r.push(e)}if(0===r.length)return!1;const i=r[0].parentUriString;if(!r.every((e=>e.parentUriString===i)))return a.window.showWarningMessage("CodeLens AI: Cannot move items between different containers yet."),!1;r.map((e=>this._files.findIndex((t=>t.uriString===e.uriString)))).sort(((e,t)=>t-e)).forEach((e=>{e>-1&&this._files.splice(e,1)}));let s=-1;if(n)s=this._files.findIndex((e=>void 0===e.parentUriString)),-1===s&&(s=this._files.length),r.forEach((e=>e.parentUriString=void 0));else if(t){const e=this._files.findIndex((e=>e.uriString===t));if(-1===e)return console.error(`[CodeLensAI:Storage:reorder] Target URI not found after removal: ${t}`),this._files.push(...r),!1;const n=this._files[e];s=e,r.forEach((e=>e.parentUriString=n.parentUriString))}else{const e=i;let t=-1;for(let n=this._files.length-1;n>=0;n--)if(this._files[n].parentUriString===e){t=n;break}s=t+1}return this._files.splice(s,0,...r),!0}hasLastRemovedFiles(){return this.lastRemovedFiles.length>0}undoLastRemoval(){if(this.hasLastRemovedFiles()){const e=this.lastRemovedFiles;return this._files=[...this._files,...e],this.lastRemovedFiles=[],e}}}t.SessionResourceStorage=d,t.Session=class{id;name;storage;associatedDocument=null;docCloseListener=null;constructor(e,t=(0,u.v4)()){this.id=t,this.name=e,this.storage=new d(this.id)}dispose(){this.closeAssociatedDocument(!1),this.storage.clearFiles()}setAssociatedDocument(e){this.docCloseListener?.dispose(),this.associatedDocument=e,this.docCloseListener=a.workspace.onDidCloseTextDocument((e=>{e===this.associatedDocument&&(this.associatedDocument=null,this.docCloseListener?.dispose(),this.docCloseListener=null)}))}async closeAssociatedDocument(e=!0){const t=this.associatedDocument;if(this.associatedDocument=null,this.docCloseListener?.dispose(),this.docCloseListener=null,e&&t)for(const e of a.window.visibleTextEditors)if(e.document===t)try{await a.window.showTextDocument(t,{viewColumn:e.viewColumn,preserveFocus:!1}),await a.commands.executeCommand("workbench.action.closeActiveEditor");break}catch(e){console.error(`[CodeLensAI:Session ${this.id}] Error closing editor:`,e)}}}},7024:(e,t,n)=>{"use strict";const r=n(1236).fromPromise,i=n(8737),s=n(6928),o=n(3798),a=n(9288).pathExists;e.exports={outputFile:r((async function(e,t,n="utf-8"){const r=s.dirname(e);return await a(r)||await o.mkdirs(r),i.writeFile(e,t,n)})),outputFileSync:function(e,...t){const n=s.dirname(e);i.existsSync(n)||o.mkdirsSync(n),i.writeFileSync(e,...t)}}},7064:(e,t,n)=>{"use strict";const r=n(8737),i=n(1236).fromPromise;e.exports={symlinkType:i((async function(e,t){if(t)return t;let n;try{n=await r.lstat(e)}catch{return"file"}return n&&n.isDirectory()?"dir":"file"})),symlinkTypeSync:function(e,t){if(t)return t;let n;try{n=r.lstatSync(e)}catch{return"file"}return n&&n.isDirectory()?"dir":"file"}}},7111:(e,t,n)=>{"use strict";const r=n(6928);e.exports.checkPath=function(e){if("win32"===process.platform&&/[<>:"|?*]/.test(e.replace(r.parse(e).root,""))){const t=new Error(`Path contains invalid characters: ${e}`);throw t.code="EINVAL",t}}},7211:(e,t,n)=>{"use strict";const r=n(8737),i=n(1236).fromPromise;e.exports={utimesMillis:i((async function(e,t,n){const i=await r.open(e,"r+");let s=null;try{await r.futimes(i,t,n)}finally{try{await r.close(i)}catch(e){s=e}}if(s)throw s})),utimesMillisSync:function(e,t,n){const i=r.openSync(e,"r+");return r.futimesSync(i,t,n),r.closeSync(i)}}},8505:e=>{"use strict";function t(e,t,i){e instanceof RegExp&&(e=n(e,i)),t instanceof RegExp&&(t=n(t,i));var s=r(e,t,i);return s&&{start:s[0],end:s[1],pre:i.slice(0,s[0]),body:i.slice(s[0]+e.length,s[1]),post:i.slice(s[1]+t.length)}}function n(e,t){var n=t.match(e);return n?n[0]:null}function r(e,t,n){var r,i,s,o,a,c=n.indexOf(e),l=n.indexOf(t,c+1),u=c;if(c>=0&&l>0){if(e===t)return[c,l];for(r=[],s=n.length;u>=0&&!a;)u==c?(r.push(u),c=n.indexOf(e,u+1)):1==r.length?a=[r.pop(),l]:((i=r.pop())<s&&(s=i,o=l),l=n.indexOf(t,u+1)),u=c<l&&c>=0?c:l;r.length&&(a=[s,o])}return a}e.exports=t,t.range=r},8722:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.unescape=t.escape=t.AST=t.Minimatch=t.match=t.makeRe=t.braceExpand=t.defaults=t.filter=t.GLOBSTAR=t.sep=t.minimatch=void 0;const i=r(n(8928)),s=n(9274),o=n(1674),a=n(2363),c=n(4116);t.minimatch=(e,t,n={})=>((0,s.assertValidPattern)(t),!(!n.nocomment&&"#"===t.charAt(0))&&new _(t,n).match(e));const l=/^\*+([^+@!?\*\[\(]*)$/,u=e=>t=>!t.startsWith(".")&&t.endsWith(e),f=e=>t=>t.endsWith(e),d=e=>(e=e.toLowerCase(),t=>!t.startsWith(".")&&t.toLowerCase().endsWith(e)),h=e=>(e=e.toLowerCase(),t=>t.toLowerCase().endsWith(e)),p=/^\*+\.\*+$/,m=e=>!e.startsWith(".")&&e.includes("."),g=e=>"."!==e&&".."!==e&&e.includes("."),w=/^\.\*+$/,y=e=>"."!==e&&".."!==e&&e.startsWith("."),S=/^\*+$/,v=e=>0!==e.length&&!e.startsWith("."),b=e=>0!==e.length&&"."!==e&&".."!==e,E=/^\?+([^+@!?\*\[\(]*)?$/,P=([e,t=""])=>{const n=$([e]);return t?(t=t.toLowerCase(),e=>n(e)&&e.toLowerCase().endsWith(t)):n},D=([e,t=""])=>{const n=C([e]);return t?(t=t.toLowerCase(),e=>n(e)&&e.toLowerCase().endsWith(t)):n},I=([e,t=""])=>{const n=C([e]);return t?e=>n(e)&&e.endsWith(t):n},O=([e,t=""])=>{const n=$([e]);return t?e=>n(e)&&e.endsWith(t):n},$=([e])=>{const t=e.length;return e=>e.length===t&&!e.startsWith(".")},C=([e])=>{const t=e.length;return e=>e.length===t&&"."!==e&&".."!==e},x="object"==typeof process&&process?"object"==typeof process.env&&process.env&&process.env.__MINIMATCH_TESTING_PLATFORM__||process.platform:"posix";t.sep="win32"===x?"\\":"/",t.minimatch.sep=t.sep,t.GLOBSTAR=Symbol("globstar **"),t.minimatch.GLOBSTAR=t.GLOBSTAR,t.filter=(e,n={})=>r=>(0,t.minimatch)(r,e,n),t.minimatch.filter=t.filter;const M=(e,t={})=>Object.assign({},e,t);t.defaults=e=>{if(!e||"object"!=typeof e||!Object.keys(e).length)return t.minimatch;const n=t.minimatch;return Object.assign(((t,r,i={})=>n(t,r,M(e,i))),{Minimatch:class extends n.Minimatch{constructor(t,n={}){super(t,M(e,n))}static defaults(t){return n.defaults(M(e,t)).Minimatch}},AST:class extends n.AST{constructor(t,n,r={}){super(t,n,M(e,r))}static fromGlob(t,r={}){return n.AST.fromGlob(t,M(e,r))}},unescape:(t,r={})=>n.unescape(t,M(e,r)),escape:(t,r={})=>n.escape(t,M(e,r)),filter:(t,r={})=>n.filter(t,M(e,r)),defaults:t=>n.defaults(M(e,t)),makeRe:(t,r={})=>n.makeRe(t,M(e,r)),braceExpand:(t,r={})=>n.braceExpand(t,M(e,r)),match:(t,r,i={})=>n.match(t,r,M(e,i)),sep:n.sep,GLOBSTAR:t.GLOBSTAR})},t.minimatch.defaults=t.defaults,t.braceExpand=(e,t={})=>((0,s.assertValidPattern)(e),t.nobrace||!/\{(?:(?!\{).)*\}/.test(e)?[e]:(0,i.default)(e)),t.minimatch.braceExpand=t.braceExpand,t.makeRe=(e,t={})=>new _(e,t).makeRe(),t.minimatch.makeRe=t.makeRe,t.match=(e,t,n={})=>{const r=new _(t,n);return e=e.filter((e=>r.match(e))),r.options.nonull&&!e.length&&e.push(t),e},t.minimatch.match=t.match;const k=/[?*]|[+@!]\(.*?\)|\[|\]/;class _{options;set;pattern;windowsPathsNoEscape;nonegate;negate;comment;empty;preserveMultipleSlashes;partial;globSet;globParts;nocase;isWindows;platform;windowsNoMagicRoot;regexp;constructor(e,t={}){(0,s.assertValidPattern)(e),t=t||{},this.options=t,this.pattern=e,this.platform=t.platform||x,this.isWindows="win32"===this.platform,this.windowsPathsNoEscape=!!t.windowsPathsNoEscape||!1===t.allowWindowsEscape,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.preserveMultipleSlashes=!!t.preserveMultipleSlashes,this.regexp=null,this.negate=!1,this.nonegate=!!t.nonegate,this.comment=!1,this.empty=!1,this.partial=!!t.partial,this.nocase=!!this.options.nocase,this.windowsNoMagicRoot=void 0!==t.windowsNoMagicRoot?t.windowsNoMagicRoot:!(!this.isWindows||!this.nocase),this.globSet=[],this.globParts=[],this.set=[],this.make()}hasMagic(){if(this.options.magicalBraces&&this.set.length>1)return!0;for(const e of this.set)for(const t of e)if("string"!=typeof t)return!0;return!1}debug(...e){}make(){const e=this.pattern,t=this.options;if(!t.nocomment&&"#"===e.charAt(0))return void(this.comment=!0);if(!e)return void(this.empty=!0);this.parseNegate(),this.globSet=[...new Set(this.braceExpand())],t.debug&&(this.debug=(...e)=>console.error(...e)),this.debug(this.pattern,this.globSet);const n=this.globSet.map((e=>this.slashSplit(e)));this.globParts=this.preprocess(n),this.debug(this.pattern,this.globParts);let r=this.globParts.map(((e,t,n)=>{if(this.isWindows&&this.windowsNoMagicRoot){const t=!(""!==e[0]||""!==e[1]||"?"!==e[2]&&k.test(e[2])||k.test(e[3])),n=/^[a-z]:/i.test(e[0]);if(t)return[...e.slice(0,4),...e.slice(4).map((e=>this.parse(e)))];if(n)return[e[0],...e.slice(1).map((e=>this.parse(e)))]}return e.map((e=>this.parse(e)))}));if(this.debug(this.pattern,r),this.set=r.filter((e=>-1===e.indexOf(!1))),this.isWindows)for(let e=0;e<this.set.length;e++){const t=this.set[e];""===t[0]&&""===t[1]&&"?"===this.globParts[e][2]&&"string"==typeof t[3]&&/^[a-z]:$/i.test(t[3])&&(t[2]="?")}this.debug(this.pattern,this.set)}preprocess(e){if(this.options.noglobstar)for(let t=0;t<e.length;t++)for(let n=0;n<e[t].length;n++)"**"===e[t][n]&&(e[t][n]="*");const{optimizationLevel:t=1}=this.options;return t>=2?(e=this.firstPhasePreProcess(e),e=this.secondPhasePreProcess(e)):e=t>=1?this.levelOneOptimize(e):this.adjascentGlobstarOptimize(e),e}adjascentGlobstarOptimize(e){return e.map((e=>{let t=-1;for(;-1!==(t=e.indexOf("**",t+1));){let n=t;for(;"**"===e[n+1];)n++;n!==t&&e.splice(t,n-t)}return e}))}levelOneOptimize(e){return e.map((e=>0===(e=e.reduce(((e,t)=>{const n=e[e.length-1];return"**"===t&&"**"===n?e:".."===t&&n&&".."!==n&&"."!==n&&"**"!==n?(e.pop(),e):(e.push(t),e)}),[])).length?[""]:e))}levelTwoFileOptimize(e){Array.isArray(e)||(e=this.slashSplit(e));let t=!1;do{if(t=!1,!this.preserveMultipleSlashes){for(let n=1;n<e.length-1;n++){const r=e[n];1===n&&""===r&&""===e[0]||"."!==r&&""!==r||(t=!0,e.splice(n,1),n--)}"."!==e[0]||2!==e.length||"."!==e[1]&&""!==e[1]||(t=!0,e.pop())}let n=0;for(;-1!==(n=e.indexOf("..",n+1));){const r=e[n-1];r&&"."!==r&&".."!==r&&"**"!==r&&(t=!0,e.splice(n-1,2),n-=2)}}while(t);return 0===e.length?[""]:e}firstPhasePreProcess(e){let t=!1;do{t=!1;for(let n of e){let r=-1;for(;-1!==(r=n.indexOf("**",r+1));){let i=r;for(;"**"===n[i+1];)i++;i>r&&n.splice(r+1,i-r);let s=n[r+1];const o=n[r+2],a=n[r+3];if(".."!==s)continue;if(!o||"."===o||".."===o||!a||"."===a||".."===a)continue;t=!0,n.splice(r,1);const c=n.slice(0);c[r]="**",e.push(c),r--}if(!this.preserveMultipleSlashes){for(let e=1;e<n.length-1;e++){const r=n[e];1===e&&""===r&&""===n[0]||"."!==r&&""!==r||(t=!0,n.splice(e,1),e--)}"."!==n[0]||2!==n.length||"."!==n[1]&&""!==n[1]||(t=!0,n.pop())}let i=0;for(;-1!==(i=n.indexOf("..",i+1));){const e=n[i-1];if(e&&"."!==e&&".."!==e&&"**"!==e){t=!0;const e=1===i&&"**"===n[i+1]?["."]:[];n.splice(i-1,2,...e),0===n.length&&n.push(""),i-=2}}}}while(t);return e}secondPhasePreProcess(e){for(let t=0;t<e.length-1;t++)for(let n=t+1;n<e.length;n++){const r=this.partsMatch(e[t],e[n],!this.preserveMultipleSlashes);if(r){e[t]=[],e[n]=r;break}}return e.filter((e=>e.length))}partsMatch(e,t,n=!1){let r=0,i=0,s=[],o="";for(;r<e.length&&i<t.length;)if(e[r]===t[i])s.push("b"===o?t[i]:e[r]),r++,i++;else if(n&&"**"===e[r]&&t[i]===e[r+1])s.push(e[r]),r++;else if(n&&"**"===t[i]&&e[r]===t[i+1])s.push(t[i]),i++;else if("*"!==e[r]||!t[i]||!this.options.dot&&t[i].startsWith(".")||"**"===t[i]){if("*"!==t[i]||!e[r]||!this.options.dot&&e[r].startsWith(".")||"**"===e[r])return!1;if("a"===o)return!1;o="b",s.push(t[i]),r++,i++}else{if("b"===o)return!1;o="a",s.push(e[r]),r++,i++}return e.length===t.length&&s}parseNegate(){if(this.nonegate)return;const e=this.pattern;let t=!1,n=0;for(let r=0;r<e.length&&"!"===e.charAt(r);r++)t=!t,n++;n&&(this.pattern=e.slice(n)),this.negate=t}matchOne(e,n,r=!1){const i=this.options;if(this.isWindows){const t="string"==typeof e[0]&&/^[a-z]:$/i.test(e[0]),r=!t&&""===e[0]&&""===e[1]&&"?"===e[2]&&/^[a-z]:$/i.test(e[3]),i="string"==typeof n[0]&&/^[a-z]:$/i.test(n[0]),s=r?3:t?0:void 0,o=!i&&""===n[0]&&""===n[1]&&"?"===n[2]&&"string"==typeof n[3]&&/^[a-z]:$/i.test(n[3])?3:i?0:void 0;if("number"==typeof s&&"number"==typeof o){const[t,r]=[e[s],n[o]];t.toLowerCase()===r.toLowerCase()&&(n[o]=t,o>s?n=n.slice(o):s>o&&(e=e.slice(s)))}}const{optimizationLevel:s=1}=this.options;s>=2&&(e=this.levelTwoFileOptimize(e)),this.debug("matchOne",this,{file:e,pattern:n}),this.debug("matchOne",e.length,n.length);for(var o=0,a=0,c=e.length,l=n.length;o<c&&a<l;o++,a++){this.debug("matchOne loop");var u=n[a],f=e[o];if(this.debug(n,u,f),!1===u)return!1;if(u===t.GLOBSTAR){this.debug("GLOBSTAR",[n,u,f]);var d=o,h=a+1;if(h===l){for(this.debug("** at the end");o<c;o++)if("."===e[o]||".."===e[o]||!i.dot&&"."===e[o].charAt(0))return!1;return!0}for(;d<c;){var p=e[d];if(this.debug("\nglobstar while",e,d,n,h,p),this.matchOne(e.slice(d),n.slice(h),r))return this.debug("globstar found match!",d,c,p),!0;if("."===p||".."===p||!i.dot&&"."===p.charAt(0)){this.debug("dot detected!",e,d,n,h);break}this.debug("globstar swallow a segment, and continue"),d++}return!(!r||(this.debug("\n>>> no match, partial?",e,d,n,h),d!==c))}let s;if("string"==typeof u?(s=f===u,this.debug("string match",u,f,s)):(s=u.test(f),this.debug("pattern match",u,f,s)),!s)return!1}if(o===c&&a===l)return!0;if(o===c)return r;if(a===l)return o===c-1&&""===e[o];throw new Error("wtf?")}braceExpand(){return(0,t.braceExpand)(this.pattern,this.options)}parse(e){(0,s.assertValidPattern)(e);const n=this.options;if("**"===e)return t.GLOBSTAR;if(""===e)return"";let r,i=null;(r=e.match(S))?i=n.dot?b:v:(r=e.match(l))?i=(n.nocase?n.dot?h:d:n.dot?f:u)(r[1]):(r=e.match(E))?i=(n.nocase?n.dot?D:P:n.dot?I:O)(r):(r=e.match(p))?i=n.dot?g:m:(r=e.match(w))&&(i=y);const a=o.AST.fromGlob(e,this.options).toMMPattern();return i&&"object"==typeof a&&Reflect.defineProperty(a,"test",{value:i}),a}makeRe(){if(this.regexp||!1===this.regexp)return this.regexp;const e=this.set;if(!e.length)return this.regexp=!1,this.regexp;const n=this.options,r=n.noglobstar?"[^/]*?":n.dot?"(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?":"(?:(?!(?:\\/|^)\\.).)*?",i=new Set(n.nocase?["i"]:[]);let s=e.map((e=>{const n=e.map((e=>{if(e instanceof RegExp)for(const t of e.flags.split(""))i.add(t);return"string"==typeof e?e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"):e===t.GLOBSTAR?t.GLOBSTAR:e._src}));return n.forEach(((e,i)=>{const s=n[i+1],o=n[i-1];e===t.GLOBSTAR&&o!==t.GLOBSTAR&&(void 0===o?void 0!==s&&s!==t.GLOBSTAR?n[i+1]="(?:\\/|"+r+"\\/)?"+s:n[i]=r:void 0===s?n[i-1]=o+"(?:\\/|"+r+")?":s!==t.GLOBSTAR&&(n[i-1]=o+"(?:\\/|\\/"+r+"\\/)"+s,n[i+1]=t.GLOBSTAR))})),n.filter((e=>e!==t.GLOBSTAR)).join("/")})).join("|");const[o,a]=e.length>1?["(?:",")"]:["",""];s="^"+o+s+a+"$",this.negate&&(s="^(?!"+s+").+$");try{this.regexp=new RegExp(s,[...i].join(""))}catch(e){this.regexp=!1}return this.regexp}slashSplit(e){return this.preserveMultipleSlashes?e.split("/"):this.isWindows&&/^\/\/[^\/]+/.test(e)?["",...e.split(/\/+/)]:e.split(/\/+/)}match(e,t=this.partial){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return""===e;if("/"===e&&t)return!0;const n=this.options;this.isWindows&&(e=e.split("\\").join("/"));const r=this.slashSplit(e);this.debug(this.pattern,"split",r);const i=this.set;this.debug(this.pattern,"set",i);let s=r[r.length-1];if(!s)for(let e=r.length-2;!s&&e>=0;e--)s=r[e];for(let e=0;e<i.length;e++){const o=i[e];let a=r;if(n.matchBase&&1===o.length&&(a=[s]),this.matchOne(a,o,t))return!!n.flipNegate||!this.negate}return!n.flipNegate&&this.negate}static defaults(e){return t.minimatch.defaults(e).Minimatch}}t.Minimatch=_;var A=n(1674);Object.defineProperty(t,"AST",{enumerable:!0,get:function(){return A.AST}});var L=n(2363);Object.defineProperty(t,"escape",{enumerable:!0,get:function(){return L.escape}});var R=n(4116);Object.defineProperty(t,"unescape",{enumerable:!0,get:function(){return R.unescape}}),t.minimatch.AST=o.AST,t.minimatch.Minimatch=_,t.minimatch.escape=a.escape,t.minimatch.unescape=c.unescape},8736:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProfileManager=void 0;class n{context;static storageKey="codelensai.profiles";constructor(e){this.context=e}async getProfiles(){return this.context.globalState.get(n.storageKey,[])}async saveProfiles(e){return this.context.globalState.update(n.storageKey,e)}async addProfile(e){const t=await this.getProfiles();return t.push(e),this.saveProfiles(t)}async removeProfile(e){const t=(await this.getProfiles()).filter((t=>t.name!==e));return this.saveProfiles(t)}async updateProfile(e,t){const n=await this.getProfiles(),r=n.findIndex((t=>t.name===e));if(-1!==r)return n[r]=t,this.saveProfiles(n)}}t.ProfileManager=n},8737:(e,t,n)=>{"use strict";const r=n(1236).fromCallback,i=n(3735),s=["access","appendFile","chmod","chown","close","copyFile","cp","fchmod","fchown","fdatasync","fstat","fsync","ftruncate","futimes","glob","lchmod","lchown","lutimes","link","lstat","mkdir","mkdtemp","open","opendir","readdir","readFile","readlink","realpath","rename","rm","rmdir","stat","statfs","symlink","truncate","unlink","utimes","writeFile"].filter((e=>"function"==typeof i[e]));Object.assign(t,i),s.forEach((e=>{t[e]=r(i[e])})),t.exists=function(e,t){return"function"==typeof t?i.exists(e,t):new Promise((t=>i.exists(e,t)))},t.read=function(e,t,n,r,s,o){return"function"==typeof o?i.read(e,t,n,r,s,o):new Promise(((o,a)=>{i.read(e,t,n,r,s,((e,t,n)=>{if(e)return a(e);o({bytesRead:t,buffer:n})}))}))},t.write=function(e,t,...n){return"function"==typeof n[n.length-1]?i.write(e,t,...n):new Promise(((r,s)=>{i.write(e,t,...n,((e,t,n)=>{if(e)return s(e);r({bytesWritten:t,buffer:n})}))}))},t.readv=function(e,t,...n){return"function"==typeof n[n.length-1]?i.readv(e,t,...n):new Promise(((r,s)=>{i.readv(e,t,...n,((e,t,n)=>{if(e)return s(e);r({bytesRead:t,buffers:n})}))}))},t.writev=function(e,t,...n){return"function"==typeof n[n.length-1]?i.writev(e,t,...n):new Promise(((r,s)=>{i.writev(e,t,...n,((e,t,n)=>{if(e)return s(e);r({bytesWritten:t,buffers:n})}))}))},"function"==typeof i.realpath.native?t.realpath.native=r(i.realpath.native):process.emitWarning("fs.realpath.native is not a function. Is fs being monkey-patched?","Warning","fs-extra-WARN0003")},8916:(e,t,n)=>{"use strict";const r=n(8737),{checkPath:i}=n(7111),s=e=>"number"==typeof e?e:{mode:511,...e}.mode;e.exports.makeDir=async(e,t)=>(i(e),r.mkdir(e,{mode:s(t),recursive:!0})),e.exports.makeDirSync=(e,t)=>(i(e),r.mkdirSync(e,{mode:s(t),recursive:!0}))},8928:(e,t,n)=>{var r=n(8505);e.exports=function(e){return e?("{}"===e.substr(0,2)&&(e="\\{\\}"+e.substr(2)),g(function(e){return e.split("\\\\").join(i).split("\\{").join(s).split("\\}").join(o).split("\\,").join(a).split("\\.").join(c)}(e),!0).map(u)):[]};var i="\0SLASH"+Math.random()+"\0",s="\0OPEN"+Math.random()+"\0",o="\0CLOSE"+Math.random()+"\0",a="\0COMMA"+Math.random()+"\0",c="\0PERIOD"+Math.random()+"\0";function l(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function u(e){return e.split(i).join("\\").split(s).join("{").split(o).join("}").split(a).join(",").split(c).join(".")}function f(e){if(!e)return[""];var t=[],n=r("{","}",e);if(!n)return e.split(",");var i=n.pre,s=n.body,o=n.post,a=i.split(",");a[a.length-1]+="{"+s+"}";var c=f(o);return o.length&&(a[a.length-1]+=c.shift(),a.push.apply(a,c)),t.push.apply(t,a),t}function d(e){return"{"+e+"}"}function h(e){return/^-?0\d/.test(e)}function p(e,t){return e<=t}function m(e,t){return e>=t}function g(e,t){var n=[],i=r("{","}",e);if(!i)return[e];var s=i.pre,a=i.post.length?g(i.post,!1):[""];if(/\$$/.test(i.pre))for(var c=0;c<a.length;c++){var u=s+"{"+i.body+"}"+a[c];n.push(u)}else{var w,y,S=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(i.body),v=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(i.body),b=S||v,E=i.body.indexOf(",")>=0;if(!b&&!E)return i.post.match(/,.*\}/)?g(e=i.pre+"{"+i.body+o+i.post):[e];if(b)w=i.body.split(/\.\./);else if(1===(w=f(i.body)).length&&1===(w=g(w[0],!1).map(d)).length)return a.map((function(e){return i.pre+w[0]+e}));if(b){var P=l(w[0]),D=l(w[1]),I=Math.max(w[0].length,w[1].length),O=3==w.length?Math.abs(l(w[2])):1,$=p;D<P&&(O*=-1,$=m);var C=w.some(h);y=[];for(var x=P;$(x,D);x+=O){var M;if(v)"\\"===(M=String.fromCharCode(x))&&(M="");else if(M=String(x),C){var k=I-M.length;if(k>0){var _=new Array(k+1).join("0");M=x<0?"-"+_+M.slice(1):_+M}}y.push(M)}}else{y=[];for(var A=0;A<w.length;A++)y.push.apply(y,g(w[A],!1))}for(A=0;A<y.length;A++)for(c=0;c<a.length;c++)u=s+y[A]+a[c],(!t||b||u)&&n.push(u)}return n}},9023:e=>{"use strict";e.exports=require("util")},9106:(e,t,n)=>{var r=n(9140),i=process.cwd,s=null,o=process.env.GRACEFUL_FS_PLATFORM||process.platform;process.cwd=function(){return s||(s=i.call(process)),s};try{process.cwd()}catch(e){}if("function"==typeof process.chdir){var a=process.chdir;process.chdir=function(e){s=null,a.call(process,e)},Object.setPrototypeOf&&Object.setPrototypeOf(process.chdir,a)}e.exports=function(e){function t(t){return t?function(n,r,i){return t.call(e,n,r,(function(e){l(e)&&(e=null),i&&i.apply(this,arguments)}))}:t}function n(t){return t?function(n,r){try{return t.call(e,n,r)}catch(e){if(!l(e))throw e}}:t}function i(t){return t?function(n,r,i,s){return t.call(e,n,r,i,(function(e){l(e)&&(e=null),s&&s.apply(this,arguments)}))}:t}function s(t){return t?function(n,r,i){try{return t.call(e,n,r,i)}catch(e){if(!l(e))throw e}}:t}function a(t){return t?function(n,r,i){function s(e,t){t&&(t.uid<0&&(t.uid+=4294967296),t.gid<0&&(t.gid+=4294967296)),i&&i.apply(this,arguments)}return"function"==typeof r&&(i=r,r=null),r?t.call(e,n,r,s):t.call(e,n,s)}:t}function c(t){return t?function(n,r){var i=r?t.call(e,n,r):t.call(e,n);return i&&(i.uid<0&&(i.uid+=4294967296),i.gid<0&&(i.gid+=4294967296)),i}:t}function l(e){return!e||"ENOSYS"===e.code||!(process.getuid&&0===process.getuid()||"EINVAL"!==e.code&&"EPERM"!==e.code)}var u;r.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./)&&function(e){e.lchmod=function(t,n,i){e.open(t,r.O_WRONLY|r.O_SYMLINK,n,(function(t,r){t?i&&i(t):e.fchmod(r,n,(function(t){e.close(r,(function(e){i&&i(t||e)}))}))}))},e.lchmodSync=function(t,n){var i,s=e.openSync(t,r.O_WRONLY|r.O_SYMLINK,n),o=!0;try{i=e.fchmodSync(s,n),o=!1}finally{if(o)try{e.closeSync(s)}catch(e){}else e.closeSync(s)}return i}}(e),e.lutimes||function(e){r.hasOwnProperty("O_SYMLINK")&&e.futimes?(e.lutimes=function(t,n,i,s){e.open(t,r.O_SYMLINK,(function(t,r){t?s&&s(t):e.futimes(r,n,i,(function(t){e.close(r,(function(e){s&&s(t||e)}))}))}))},e.lutimesSync=function(t,n,i){var s,o=e.openSync(t,r.O_SYMLINK),a=!0;try{s=e.futimesSync(o,n,i),a=!1}finally{if(a)try{e.closeSync(o)}catch(e){}else e.closeSync(o)}return s}):e.futimes&&(e.lutimes=function(e,t,n,r){r&&process.nextTick(r)},e.lutimesSync=function(){})}(e),e.chown=i(e.chown),e.fchown=i(e.fchown),e.lchown=i(e.lchown),e.chmod=t(e.chmod),e.fchmod=t(e.fchmod),e.lchmod=t(e.lchmod),e.chownSync=s(e.chownSync),e.fchownSync=s(e.fchownSync),e.lchownSync=s(e.lchownSync),e.chmodSync=n(e.chmodSync),e.fchmodSync=n(e.fchmodSync),e.lchmodSync=n(e.lchmodSync),e.stat=a(e.stat),e.fstat=a(e.fstat),e.lstat=a(e.lstat),e.statSync=c(e.statSync),e.fstatSync=c(e.fstatSync),e.lstatSync=c(e.lstatSync),e.chmod&&!e.lchmod&&(e.lchmod=function(e,t,n){n&&process.nextTick(n)},e.lchmodSync=function(){}),e.chown&&!e.lchown&&(e.lchown=function(e,t,n,r){r&&process.nextTick(r)},e.lchownSync=function(){}),"win32"===o&&(e.rename="function"!=typeof e.rename?e.rename:function(t){function n(n,r,i){var s=Date.now(),o=0;t(n,r,(function a(c){if(c&&("EACCES"===c.code||"EPERM"===c.code||"EBUSY"===c.code)&&Date.now()-s<6e4)return setTimeout((function(){e.stat(r,(function(e,s){e&&"ENOENT"===e.code?t(n,r,a):i(c)}))}),o),void(o<100&&(o+=10));i&&i(c)}))}return Object.setPrototypeOf&&Object.setPrototypeOf(n,t),n}(e.rename)),e.read="function"!=typeof e.read?e.read:function(t){function n(n,r,i,s,o,a){var c;if(a&&"function"==typeof a){var l=0;c=function(u,f,d){if(u&&"EAGAIN"===u.code&&l<10)return l++,t.call(e,n,r,i,s,o,c);a.apply(this,arguments)}}return t.call(e,n,r,i,s,o,c)}return Object.setPrototypeOf&&Object.setPrototypeOf(n,t),n}(e.read),e.readSync="function"!=typeof e.readSync?e.readSync:(u=e.readSync,function(t,n,r,i,s){for(var o=0;;)try{return u.call(e,t,n,r,i,s)}catch(e){if("EAGAIN"===e.code&&o<10){o++;continue}throw e}})}},9140:e=>{"use strict";e.exports=require("constants")},9274:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertValidPattern=void 0,t.assertValidPattern=e=>{if("string"!=typeof e)throw new TypeError("invalid pattern");if(e.length>65536)throw new TypeError("pattern is too long")}},9288:(e,t,n)=>{"use strict";const r=n(1236).fromPromise,i=n(8737);e.exports={pathExists:r((function(e){return i.access(e).then((()=>!0)).catch((()=>!1))})),pathExistsSync:i.existsSync}},9616:(e,t,n)=>{"use strict";const r=n(1236).fromPromise,i=n(6928),s=n(8737),o=n(3798);e.exports={createFile:r((async function(e){let t;try{t=await s.stat(e)}catch{}if(t&&t.isFile())return;const n=i.dirname(e);let r=null;try{r=await s.stat(n)}catch(t){if("ENOENT"===t.code)return await o.mkdirs(n),void await s.writeFile(e,"");throw t}r.isDirectory()?await s.writeFile(e,""):await s.readdir(n)})),createFileSync:function(e){let t;try{t=s.statSync(e)}catch{}if(t&&t.isFile())return;const n=i.dirname(e);try{s.statSync(n).isDirectory()||s.readdirSync(n)}catch(e){if(!e||"ENOENT"!==e.code)throw e;o.mkdirsSync(n)}s.writeFileSync(e,"")}}},9896:e=>{"use strict";e.exports=require("fs")}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={exports:{}};return e[r].call(s.exports,s,s.exports,n),s.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r=n(4265);module.exports=r})();